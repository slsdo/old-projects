<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<!--
Syntax highlighting generated by Web C Plus Plus software v0.8.4
Webcpp Copyright (C)2001-2004 Jeffrey Bakker under the GNU GPL
Get webcpp at http://webcpp.sf.net
-->

<style type="text/css">

/*
Webcpp v0.8.1 compatible StyleSheet
http://webcpp.sf.net
Theme: typical
*/

div.webcpp
{
background-color: #f9f9f9
}

.webcpp a:link    {color:#00b800}
.webcpp a:visited {color:#666666}
.webcpp a:active  {color:#224fff}
.webcpp a:hover   {color:#a900a9}

.webcpp pre
{
color: #000000
}

.webcpp font
{
font-size:100%
}

.webcpp .symbols
{
color: #0077dd
}

.webcpp .preproc
{
color: #a900a9
}

.webcpp .integer
{
color: #ff0032
}

.webcpp .floatpt
{
color: #ff23a6
}

.webcpp .dblquot
{
color: #00b800
}

.webcpp .sinquot
{
color: #00b86b
}

.webcpp .keyword
{
color: #224fff;
font-weight: bold
}

.webcpp .keytype
{
color: #ff9933;
font-weight: bold
}

.webcpp .comment
{
color: #666666;
font-style: italic
}

</style>
<div class="webcpp">
<pre>

<a name="line1"/>     <font CLASS=comment>1:</font> <font CLASS=comment>/****************************************************************
<a name="line2"/>     <font CLASS=comment>2:</font> *																*
<a name="line3"/>     <font CLASS=comment>3:</font> * C++ Vector and Matrix Algebra routines						*
<a name="line4"/>     <font CLASS=comment>4:</font> * Author: Jean-Francois DOUE									*
<a name="line5"/>     <font CLASS=comment>5:</font> * Version 3.1 --- October 1993									*
<a name="line6"/>     <font CLASS=comment>6:</font> *																*
<a name="line7"/>     <font CLASS=comment>7:</font> ****************************************************************/</font>
<a name="line8"/>     <font CLASS=comment>8:</font> <font CLASS=comment>//</font>
<a name="line9"/>     <font CLASS=comment>9:</font> <font CLASS=comment>//	From "Graphics Gems IV / Edited by Paul S. Heckbert</font>
<a name="line10"/>    <font CLASS=comment>10:</font> <font CLASS=comment>//	Academic Press, 1994, ISBN 0-12-336156-9</font>
<a name="line11"/>    <font CLASS=comment>11:</font> <font CLASS=comment>//	"You are free to use and modify this code in any way</font>
<a name="line12"/>    <font CLASS=comment>12:</font> <font CLASS=comment>//	you like." (p. xv)</font>
<a name="line13"/>    <font CLASS=comment>13:</font> <font CLASS=comment>//</font>
<a name="line14"/>    <font CLASS=comment>14:</font> <font CLASS=comment>//	Modified by J. Nagle, March 1997</font>
<a name="line15"/>    <font CLASS=comment>15:</font> <font CLASS=comment>//	-	All functions are inline.</font>
<a name="line16"/>    <font CLASS=comment>16:</font> <font CLASS=comment>//	-	All functions are const-correct.</font>
<a name="line17"/>    <font CLASS=comment>17:</font> <font CLASS=comment>//	-	All checking is via the standard "assert" macro.</font>
<a name="line18"/>    <font CLASS=comment>18:</font> <font CLASS=comment>//	-	Stream I/O is disabled for portability, but can be</font>
<a name="line19"/>    <font CLASS=comment>19:</font> <font CLASS=comment>//		re-enabled by defining ALGEBRA3IOSTREAMS.</font>
<a name="line20"/>    <font CLASS=comment>20:</font> <font CLASS=comment>//</font>
<a name="line21"/>    <font CLASS=comment>21:</font> <font CLASS=comment>//	Modified by Paul Rademacher, 1998</font>
<a name="line22"/>    <font CLASS=comment>22:</font> <font CLASS=comment>//	- Added set, swap_row/swap_col functions</font>
<a name="line23"/>    <font CLASS=comment>23:</font> <font CLASS=comment>//</font>
<a name="line24"/>    <font CLASS=comment>24:</font> <font CLASS=comment>//	Modified by Aline N, 2009</font>
<a name="line25"/>    <font CLASS=comment>25:</font> <font CLASS=comment>//	- Add divide by zero length check to Length()</font>
<a name="line26"/>    <font CLASS=comment>26:</font> <font CLASS=comment>//</font>
<a name="line27"/>    <font CLASS=comment>27:</font> <font CLASS=comment>//	Modified by slsdo, 2010</font>
<a name="line28"/>    <font CLASS=comment>28:</font> <font CLASS=comment>//	- Added Cross Product operator</font>
<a name="line29"/>    <font CLASS=comment>29:</font> <font CLASS=comment>//	- Added rotation3Drad by Liming Zhao</font>
<a name="line30"/>    <font CLASS=comment>30:</font> <font CLASS=comment>//	- Added normalized to return a copy of a normalized vec3</font>
<a name="line31"/>    <font CLASS=comment>31:</font> <font CLASS=comment>//	- Added mat4*vec3</font>
<a name="line32"/>    <font CLASS=comment>32:</font> <font CLASS=comment>//	- Added mat3 and mat4 determinant</font>
<a name="line33"/>    <font CLASS=comment>33:</font> <font CLASS=comment>//	- Added vector floor and ceil</font>
<a name="line34"/>    <font CLASS=comment>34:</font> 
<a name="line35"/>    <font CLASS=comment>35:</font> <font CLASS=preproc>#ifndef</font> ALGEBRA3H 
<a name="line36"/>    <font CLASS=comment>36:</font> <font CLASS=preproc>#define</font> ALGEBRA3H 
<a name="line37"/>    <font CLASS=comment>37:</font> 
<a name="line38"/>    <font CLASS=comment>38:</font> <font CLASS=preproc>#include</font> &lt;stdlib.h&gt; 
<a name="line39"/>    <font CLASS=comment>39:</font> <font CLASS=preproc>#include</font> &lt;assert.h&gt; 
<a name="line40"/>    <font CLASS=comment>40:</font> <font CLASS=preproc>#include</font> &lt;math.h&gt; 
<a name="line41"/>    <font CLASS=comment>41:</font> 
<a name="line42"/>    <font CLASS=comment>42:</font> <font CLASS=comment>// this line defines a new type: pointer to a function which returns a</font>
<a name="line43"/>    <font CLASS=comment>43:</font> <font CLASS=comment>// double and takes as argument a double</font>
<a name="line44"/>    <font CLASS=comment>44:</font> <font CLASS=keyword>typedef</font> <font CLASS=keytype>double</font> (*V_FCT_PTR)(<font CLASS=keytype>double</font>);
<a name="line45"/>    <font CLASS=comment>45:</font> 
<a name="line46"/>    <font CLASS=comment>46:</font> <font CLASS=comment>// min-max macros</font>
<a name="line47"/>    <font CLASS=comment>47:</font> <font CLASS=preproc>#define</font> MIN(A,B) ((A) &lt; (B) ? (A) : (B)) 
<a name="line48"/>    <font CLASS=comment>48:</font> <font CLASS=preproc>#define</font> MAX(A,B) ((A) &gt; (B) ? (A) : (B)) 
<a name="line49"/>    <font CLASS=comment>49:</font> 
<a name="line50"/>    <font CLASS=comment>50:</font> <font CLASS=preproc>#undef</font> min					<font CLASS=comment>// allow as function names </font>
<a name="line51"/>    <font CLASS=comment>51:</font> <font CLASS=preproc>#undef</font> max 
<a name="line52"/>    <font CLASS=comment>52:</font> 
<a name="line53"/>    <font CLASS=comment>53:</font> <font CLASS=preproc>#define</font> ALGEBRA3IOSTREAMS 
<a name="line54"/>    <font CLASS=comment>54:</font> <font CLASS=preproc>#include</font> &lt;iostream&gt; 
<a name="line55"/>    <font CLASS=comment>55:</font> <font CLASS=keyword>using</font> <font CLASS=keyword>namespace</font> std;
<a name="line56"/>    <font CLASS=comment>56:</font> 
<a name="line57"/>    <font CLASS=comment>57:</font> <font CLASS=comment>// error handling macro</font>
<a name="line58"/>    <font CLASS=comment>58:</font> <font CLASS=preproc>#define</font> ALGEBRA_ERROR(E) { assert(<font CLASS=keyword>false</font>); } 
<a name="line59"/>    <font CLASS=comment>59:</font> 
<a name="line60"/>    <font CLASS=comment>60:</font> <font CLASS=keyword>class</font> vec2;
<a name="line61"/>    <font CLASS=comment>61:</font> <font CLASS=keyword>class</font> vec3;
<a name="line62"/>    <font CLASS=comment>62:</font> <font CLASS=keyword>class</font> vec4;
<a name="line63"/>    <font CLASS=comment>63:</font> <font CLASS=keyword>class</font> mat3;
<a name="line64"/>    <font CLASS=comment>64:</font> <font CLASS=keyword>class</font> mat4;
<a name="line65"/>    <font CLASS=comment>65:</font> 
<a name="line66"/>    <font CLASS=comment>66:</font> <font CLASS=keyword>enum</font> {VX, VY, VZ, VW};		    <font CLASS=comment>// axes</font>
<a name="line67"/>    <font CLASS=comment>67:</font> <font CLASS=keyword>enum</font> {PA, PB, PC, PD};		    <font CLASS=comment>// planes</font>
<a name="line68"/>    <font CLASS=comment>68:</font> <font CLASS=keyword>enum</font> {RED, GREEN, BLUE};	    <font CLASS=comment>// colors</font>
<a name="line69"/>    <font CLASS=comment>69:</font> <font CLASS=keyword>enum</font> {KA, KD, KS, ES};		    <font CLASS=comment>// phong coefficients</font>
<a name="line70"/>    <font CLASS=comment>70:</font> <font CLASS=comment>//</font>
<a name="line71"/>    <font CLASS=comment>71:</font> <font CLASS=comment>//	PI</font>
<a name="line72"/>    <font CLASS=comment>72:</font> <font CLASS=comment>//</font>
<a name="line73"/>    <font CLASS=comment>73:</font> <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> M_PI <font CLASS=symbols>=</font> (<font CLASS=keytype>double</font>) <font CLASS=floatpt>3.14159265358979323846</font>;		<font CLASS=comment>// per CRC handbook, 14th. ed.</font>
<a name="line74"/>    <font CLASS=comment>74:</font> <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> M_PI_2 <font CLASS=symbols>=</font> (M_PI/<font CLASS=floatpt>2.0</font>);				<font CLASS=comment>// PI/2</font>
<a name="line75"/>    <font CLASS=comment>75:</font> <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> M2_PI <font CLASS=symbols>=</font> (M_PI*<font CLASS=floatpt>2.0</font>);				<font CLASS=comment>// PI*2</font>
<a name="line76"/>    <font CLASS=comment>76:</font> <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> Rad2Deg <font CLASS=symbols>=</font> <font CLASS=keytype>double</font>(<font CLASS=floatpt>180.0</font>f / M_PI);			<font CLASS=comment>// Rad to Degree</font>
<a name="line77"/>    <font CLASS=comment>77:</font> <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> Deg2Rad <font CLASS=symbols>=</font> <font CLASS=keytype>double</font>(M_PI / <font CLASS=floatpt>180.0</font>f);			<font CLASS=comment>// Degree to Rad</font>
<a name="line78"/>    <font CLASS=comment>78:</font> 
<a name="line79"/>    <font CLASS=comment>79:</font> <font CLASS=preproc>#define</font> EPSILON <font CLASS=floatpt>0.00001</font> 
<a name="line80"/>    <font CLASS=comment>80:</font> <font CLASS=preproc>#define</font> INF <font CLASS=floatpt>1000000.0</font> 
<a name="line81"/>    <font CLASS=comment>81:</font> 
<a name="line82"/>    <font CLASS=comment>82:</font> 
<a name="line83"/>    <font CLASS=comment>83:</font> <font CLASS=comment>/****************************************************************
<a name="line84"/>    <font CLASS=comment>84:</font> *																*
<a name="line85"/>    <font CLASS=comment>85:</font> *			    2D Vector										*
<a name="line86"/>    <font CLASS=comment>86:</font> *																*
<a name="line87"/>    <font CLASS=comment>87:</font> ****************************************************************/</font>
<a name="line88"/>    <font CLASS=comment>88:</font> 
<a name="line89"/>    <font CLASS=comment>89:</font> <font CLASS=keyword>class</font> vec2
<a name="line90"/>    <font CLASS=comment>90:</font> {
<a name="line91"/>    <font CLASS=comment>91:</font> <font CLASS=preproc><font CLASS=keyword>protected</font>:</font>
<a name="line92"/>    <font CLASS=comment>92:</font> 
<a name="line93"/>    <font CLASS=comment>93:</font> 	<font CLASS=keytype>double</font> n[<font CLASS=integer>2</font>];
<a name="line94"/>    <font CLASS=comment>94:</font> 
<a name="line95"/>    <font CLASS=comment>95:</font> <font CLASS=preproc><font CLASS=keyword>public</font>:</font>
<a name="line96"/>    <font CLASS=comment>96:</font> 
<a name="line97"/>    <font CLASS=comment>97:</font> 	<font CLASS=comment>// Constructors</font>
<a name="line98"/>    <font CLASS=comment>98:</font> 
<a name="line99"/>    <font CLASS=comment>99:</font> 	vec2();
<a name="line100"/>   <font CLASS=comment>100:</font> 	vec2(<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> x, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> y);
<a name="line101"/>   <font CLASS=comment>101:</font> 	vec2(<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d);
<a name="line102"/>   <font CLASS=comment>102:</font> 	vec2(<font CLASS=keyword>const</font> vec2&amp; v);				<font CLASS=comment>// copy constructor</font>
<a name="line103"/>   <font CLASS=comment>103:</font> 	vec2(<font CLASS=keyword>const</font> vec3&amp; v);				<font CLASS=comment>// cast v3 to v2</font>
<a name="line104"/>   <font CLASS=comment>104:</font> 	vec2(<font CLASS=keyword>const</font> vec3&amp; v, <font CLASS=keytype>int</font> dropAxis);	<font CLASS=comment>// cast v3 to v2</font>
<a name="line105"/>   <font CLASS=comment>105:</font> 
<a name="line106"/>   <font CLASS=comment>106:</font> 	<font CLASS=comment>// Assignment operators</font>
<a name="line107"/>   <font CLASS=comment>107:</font> 
<a name="line108"/>   <font CLASS=comment>108:</font> 	vec2&amp; <font CLASS=keyword>operator</font>	<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> vec2&amp; v );	<font CLASS=comment>// assignment of a vec2</font>
<a name="line109"/>   <font CLASS=comment>109:</font> 	vec2&amp; <font CLASS=keyword>operator</font> <font CLASS=symbols>+=</font> ( <font CLASS=keyword>const</font> vec2&amp; v );	<font CLASS=comment>// incrementation by a vec2</font>
<a name="line110"/>   <font CLASS=comment>110:</font> 	vec2&amp; <font CLASS=keyword>operator</font> <font CLASS=symbols>-=</font> ( <font CLASS=keyword>const</font> vec2&amp; v );	<font CLASS=comment>// decrementation by a vec2</font>
<a name="line111"/>   <font CLASS=comment>111:</font> 	vec2&amp; <font CLASS=keyword>operator</font> *<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d );	<font CLASS=comment>// multiplication by a constant</font>
<a name="line112"/>   <font CLASS=comment>112:</font> 	vec2&amp; <font CLASS=keyword>operator</font> /<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d );	<font CLASS=comment>// division by a constant</font>
<a name="line113"/>   <font CLASS=comment>113:</font> 	<font CLASS=keytype>double</font>&amp; <font CLASS=keyword>operator</font> [] ( <font CLASS=keytype>int</font> i);			<font CLASS=comment>// indexing</font>
<a name="line114"/>   <font CLASS=comment>114:</font> 	<font CLASS=keytype>double</font> vec2::<font CLASS=keyword>operator</font> [] ( <font CLASS=keytype>int</font> i) <font CLASS=keyword>const</font>;<font CLASS=comment>// read-only indexing</font>
<a name="line115"/>   <font CLASS=comment>115:</font> 
<a name="line116"/>   <font CLASS=comment>116:</font> 	<font CLASS=comment>// special functions</font>
<a name="line117"/>   <font CLASS=comment>117:</font> 
<a name="line118"/>   <font CLASS=comment>118:</font> 	<font CLASS=keytype>double</font> length() <font CLASS=keyword>const</font>;			<font CLASS=comment>// length of a vec2</font>
<a name="line119"/>   <font CLASS=comment>119:</font> 	<font CLASS=keytype>double</font> length2() <font CLASS=keyword>const</font>;			<font CLASS=comment>// squared length of a vec2</font>
<a name="line120"/>   <font CLASS=comment>120:</font> 	vec2&amp; normalize() ;				<font CLASS=comment>// normalize a vec2 in place</font>
<a name="line121"/>   <font CLASS=comment>121:</font> 	vec2&amp; apply(V_FCT_PTR fct);		<font CLASS=comment>// apply a func. to each component</font>
<a name="line122"/>   <font CLASS=comment>122:</font> 	<font CLASS=keytype>void</font> set( <font CLASS=keytype>float</font> x, <font CLASS=keytype>float</font> y );	<font CLASS=comment>// set vector</font>
<a name="line123"/>   <font CLASS=comment>123:</font> 
<a name="line124"/>   <font CLASS=comment>124:</font> 	<font CLASS=comment>// friends</font>
<a name="line125"/>   <font CLASS=comment>125:</font> 
<a name="line126"/>   <font CLASS=comment>126:</font> 	<font CLASS=keyword>friend</font> vec2 <font CLASS=keyword>operator</font> <font CLASS=symbols>-</font> (<font CLASS=keyword>const</font> vec2&amp; v);						<font CLASS=comment>// -v1</font>
<a name="line127"/>   <font CLASS=comment>127:</font> 	<font CLASS=keyword>friend</font> vec2 <font CLASS=keyword>operator</font> <font CLASS=symbols>+</font> (<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> vec2&amp; b);	    <font CLASS=comment>// v1 + v2</font>
<a name="line128"/>   <font CLASS=comment>128:</font> 	<font CLASS=keyword>friend</font> vec2 <font CLASS=keyword>operator</font> <font CLASS=symbols>-</font> (<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> vec2&amp; b);	    <font CLASS=comment>// v1 - v2</font>
<a name="line129"/>   <font CLASS=comment>129:</font> 	<font CLASS=keyword>friend</font> vec2 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d);	    <font CLASS=comment>// v1 * 3.0</font>
<a name="line130"/>   <font CLASS=comment>130:</font> 	<font CLASS=keyword>friend</font> vec2 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d, <font CLASS=keyword>const</font> vec2&amp; a);	    <font CLASS=comment>// 3.0 * v1</font>
<a name="line131"/>   <font CLASS=comment>131:</font> 	<font CLASS=keyword>friend</font> vec2 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> vec2&amp; v);	    <font CLASS=comment>// M . v</font>
<a name="line132"/>   <font CLASS=comment>132:</font> 	<font CLASS=keyword>friend</font> vec2 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> vec2&amp; v, <font CLASS=keyword>const</font> mat3&amp; a);		<font CLASS=comment>// v . M</font>
<a name="line133"/>   <font CLASS=comment>133:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keytype>double</font> <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> vec2&amp; b);    <font CLASS=comment>// dot product</font>
<a name="line134"/>   <font CLASS=comment>134:</font> 	<font CLASS=keyword>friend</font> vec2 <font CLASS=keyword>operator</font> / (<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d);	    <font CLASS=comment>// v1 / 3.0</font>
<a name="line135"/>   <font CLASS=comment>135:</font> 	<font CLASS=keyword>friend</font> vec3 <font CLASS=keyword>operator</font> ^ (<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> vec2&amp; b);	    <font CLASS=comment>// cross product</font>
<a name="line136"/>   <font CLASS=comment>136:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keytype>int</font> <font CLASS=keyword>operator</font> <font CLASS=symbols>==</font> (<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> vec2&amp; b);	    <font CLASS=comment>// v1 == v2 ?</font>
<a name="line137"/>   <font CLASS=comment>137:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keytype>int</font> <font CLASS=keyword>operator</font> <font CLASS=symbols>!=</font> (<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> vec2&amp; b);	    <font CLASS=comment>// v1 != v2 ?</font>
<a name="line138"/>   <font CLASS=comment>138:</font> 
<a name="line139"/>   <font CLASS=comment>139:</font> <font CLASS=preproc>#ifdef</font> ALGEBRA3IOSTREAMS 
<a name="line140"/>   <font CLASS=comment>140:</font> 	<font CLASS=keyword>friend</font> ostream&amp; <font CLASS=keyword>operator</font> &lt;&lt; (ostream&amp; s, <font CLASS=keyword>const</font> vec2&amp; v);	<font CLASS=comment>// output to stream</font>
<a name="line141"/>   <font CLASS=comment>141:</font> 	<font CLASS=keyword>friend</font> istream&amp; <font CLASS=keyword>operator</font> &gt;&gt; (istream&amp; s, vec2&amp; v);	    <font CLASS=comment>// input from strm.</font>
<a name="line142"/>   <font CLASS=comment>142:</font> <font CLASS=preproc>#endif</font> ALGEBRA3IOSTREAMS 
<a name="line143"/>   <font CLASS=comment>143:</font> 
<a name="line144"/>   <font CLASS=comment>144:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keytype>void</font> swap(vec2&amp; a, vec2&amp; b);						<font CLASS=comment>// swap v1 &amp; v2</font>
<a name="line145"/>   <font CLASS=comment>145:</font> 	<font CLASS=keyword>friend</font> vec2 min(<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> vec2&amp; b);		    <font CLASS=comment>// min(v1, v2)</font>
<a name="line146"/>   <font CLASS=comment>146:</font> 	<font CLASS=keyword>friend</font> vec2 max(<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> vec2&amp; b);		    <font CLASS=comment>// max(v1, v2)</font>
<a name="line147"/>   <font CLASS=comment>147:</font> 	<font CLASS=keyword>friend</font> vec2 prod(<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> vec2&amp; b);		    <font CLASS=comment>// term by term *</font>
<a name="line148"/>   <font CLASS=comment>148:</font> 	<font CLASS=keyword>friend</font> vec2 floor(<font CLASS=keyword>const</font> vec2&amp; v);						<font CLASS=comment>// term by term floor</font>
<a name="line149"/>   <font CLASS=comment>149:</font> 	<font CLASS=keyword>friend</font> vec2 ceil(<font CLASS=keyword>const</font> vec2&amp; v);						<font CLASS=comment>// term by term ceil</font>
<a name="line150"/>   <font CLASS=comment>150:</font> 
<a name="line151"/>   <font CLASS=comment>151:</font> 	<font CLASS=comment>// necessary friend declarations</font>
<a name="line152"/>   <font CLASS=comment>152:</font> 
<a name="line153"/>   <font CLASS=comment>153:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keyword>class</font> vec3;
<a name="line154"/>   <font CLASS=comment>154:</font> };
<a name="line155"/>   <font CLASS=comment>155:</font> 
<a name="line156"/>   <font CLASS=comment>156:</font> <font CLASS=comment>/****************************************************************
<a name="line157"/>   <font CLASS=comment>157:</font> *																*
<a name="line158"/>   <font CLASS=comment>158:</font> *			    3D Vector										*
<a name="line159"/>   <font CLASS=comment>159:</font> *																*
<a name="line160"/>   <font CLASS=comment>160:</font> ****************************************************************/</font>
<a name="line161"/>   <font CLASS=comment>161:</font> 
<a name="line162"/>   <font CLASS=comment>162:</font> <font CLASS=keyword>class</font> vec3
<a name="line163"/>   <font CLASS=comment>163:</font> {
<a name="line164"/>   <font CLASS=comment>164:</font> <font CLASS=preproc><font CLASS=keyword>protected</font>:</font>
<a name="line165"/>   <font CLASS=comment>165:</font> 
<a name="line166"/>   <font CLASS=comment>166:</font> 	<font CLASS=keytype>double</font> n[<font CLASS=integer>3</font>];
<a name="line167"/>   <font CLASS=comment>167:</font> 
<a name="line168"/>   <font CLASS=comment>168:</font> <font CLASS=preproc><font CLASS=keyword>public</font>:</font>
<a name="line169"/>   <font CLASS=comment>169:</font> 
<a name="line170"/>   <font CLASS=comment>170:</font> 	<font CLASS=comment>// Constructors</font>
<a name="line171"/>   <font CLASS=comment>171:</font> 
<a name="line172"/>   <font CLASS=comment>172:</font> 	vec3();
<a name="line173"/>   <font CLASS=comment>173:</font> 	vec3(<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> x, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> y, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> z);
<a name="line174"/>   <font CLASS=comment>174:</font> 	vec3(<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d);
<a name="line175"/>   <font CLASS=comment>175:</font> 	vec3(<font CLASS=keyword>const</font> vec3&amp; v);					<font CLASS=comment>// copy constructor</font>
<a name="line176"/>   <font CLASS=comment>176:</font> 	vec3(<font CLASS=keyword>const</font> vec2&amp; v);					<font CLASS=comment>// cast v2 to v3</font>
<a name="line177"/>   <font CLASS=comment>177:</font> 	vec3(<font CLASS=keyword>const</font> vec2&amp; v, <font CLASS=keytype>double</font> d);		    <font CLASS=comment>// cast v2 to v3</font>
<a name="line178"/>   <font CLASS=comment>178:</font> 	vec3(<font CLASS=keyword>const</font> vec4&amp; v);					<font CLASS=comment>// cast v4 to v3</font>
<a name="line179"/>   <font CLASS=comment>179:</font> 	vec3(<font CLASS=keyword>const</font> vec4&amp; v, <font CLASS=keytype>int</font> dropAxis);	    <font CLASS=comment>// cast v4 to v3</font>
<a name="line180"/>   <font CLASS=comment>180:</font> 
<a name="line181"/>   <font CLASS=comment>181:</font> 	<font CLASS=comment>// Assignment operators</font>
<a name="line182"/>   <font CLASS=comment>182:</font> 
<a name="line183"/>   <font CLASS=comment>183:</font> 	vec3&amp; <font CLASS=keyword>operator</font>	<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> vec3&amp; v );	    <font CLASS=comment>// assignment of a vec3</font>
<a name="line184"/>   <font CLASS=comment>184:</font> 	vec3&amp; <font CLASS=keyword>operator</font> <font CLASS=symbols>+=</font> ( <font CLASS=keyword>const</font> vec3&amp; v );	    <font CLASS=comment>// incrementation by a vec3</font>
<a name="line185"/>   <font CLASS=comment>185:</font> 	vec3&amp; <font CLASS=keyword>operator</font> <font CLASS=symbols>-=</font> ( <font CLASS=keyword>const</font> vec3&amp; v );	    <font CLASS=comment>// decrementation by a vec3</font>
<a name="line186"/>   <font CLASS=comment>186:</font> 	vec3&amp; <font CLASS=keyword>operator</font> *<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d );	    <font CLASS=comment>// multiplication by a constant</font>
<a name="line187"/>   <font CLASS=comment>187:</font> 	vec3&amp; <font CLASS=keyword>operator</font> /<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d );	    <font CLASS=comment>// division by a constant</font>
<a name="line188"/>   <font CLASS=comment>188:</font> 	<font CLASS=keytype>double</font>&amp; <font CLASS=keyword>operator</font> [] ( <font CLASS=keytype>int</font> i);				<font CLASS=comment>// indexing</font>
<a name="line189"/>   <font CLASS=comment>189:</font> 	<font CLASS=keytype>double</font> <font CLASS=keyword>operator</font>[] (<font CLASS=keytype>int</font> i) <font CLASS=keyword>const</font>;			<font CLASS=comment>// read-only indexing</font>
<a name="line190"/>   <font CLASS=comment>190:</font> 
<a name="line191"/>   <font CLASS=comment>191:</font> 	<font CLASS=comment>// special functions</font>
<a name="line192"/>   <font CLASS=comment>192:</font> 
<a name="line193"/>   <font CLASS=comment>193:</font> 	<font CLASS=keytype>double</font> length() <font CLASS=keyword>const</font>;				<font CLASS=comment>// length of a vec3</font>
<a name="line194"/>   <font CLASS=comment>194:</font> 	<font CLASS=keytype>double</font> length2() <font CLASS=keyword>const</font>;				<font CLASS=comment>// squared length of a vec3</font>
<a name="line195"/>   <font CLASS=comment>195:</font> 	vec3&amp; normalize();					<font CLASS=comment>// normalize a vec3 in place</font>
<a name="line196"/>   <font CLASS=comment>196:</font> 	vec3 normalized();					<font CLASS=comment>// return a normalized vec3</font>
<a name="line197"/>   <font CLASS=comment>197:</font> 	vec3 cross(vec3 &amp;v) <font CLASS=keyword>const</font>;			<font CLASS=comment>// cross product</font>
<a name="line198"/>   <font CLASS=comment>198:</font> 	vec3&amp; apply(V_FCT_PTR fct);		    <font CLASS=comment>// apply a func. to each component</font>
<a name="line199"/>   <font CLASS=comment>199:</font> 	<font CLASS=keytype>void</font> set( <font CLASS=keytype>float</font> x, <font CLASS=keytype>float</font> y, <font CLASS=keytype>float</font> z );		<font CLASS=comment>// set vector</font>
<a name="line200"/>   <font CLASS=comment>200:</font> 
<a name="line201"/>   <font CLASS=comment>201:</font> 	<font CLASS=comment>// friends</font>
<a name="line202"/>   <font CLASS=comment>202:</font> 
<a name="line203"/>   <font CLASS=comment>203:</font> 	<font CLASS=keyword>friend</font> vec3 <font CLASS=keyword>operator</font> <font CLASS=symbols>-</font> (<font CLASS=keyword>const</font> vec3&amp; v);						<font CLASS=comment>// -v1</font>
<a name="line204"/>   <font CLASS=comment>204:</font> 	<font CLASS=keyword>friend</font> vec3 <font CLASS=keyword>operator</font> <font CLASS=symbols>+</font> (<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> vec3&amp; b);	    <font CLASS=comment>// v1 + v2</font>
<a name="line205"/>   <font CLASS=comment>205:</font> 	<font CLASS=keyword>friend</font> vec3 <font CLASS=keyword>operator</font> <font CLASS=symbols>-</font> (<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> vec3&amp; b);	    <font CLASS=comment>// v1 - v2</font>
<a name="line206"/>   <font CLASS=comment>206:</font> 	<font CLASS=keyword>friend</font> vec3 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d);	    <font CLASS=comment>// v1 * 3.0</font>
<a name="line207"/>   <font CLASS=comment>207:</font> 	<font CLASS=keyword>friend</font> vec3 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d, <font CLASS=keyword>const</font> vec3&amp; a);	    <font CLASS=comment>// 3.0 * v1</font>
<a name="line208"/>   <font CLASS=comment>208:</font> 	<font CLASS=keyword>friend</font> vec3 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> vec3&amp; v);	    <font CLASS=comment>// M . v</font>
<a name="line209"/>   <font CLASS=comment>209:</font> 	<font CLASS=keyword>friend</font> vec3 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> vec3&amp; v, <font CLASS=keyword>const</font> mat4&amp; a);		<font CLASS=comment>// v . M</font>
<a name="line210"/>   <font CLASS=comment>210:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keytype>double</font> <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> vec3&amp; b);    <font CLASS=comment>// dot product</font>
<a name="line211"/>   <font CLASS=comment>211:</font> 	<font CLASS=keyword>friend</font> vec3 <font CLASS=keyword>operator</font> / (<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d);	    <font CLASS=comment>// v1 / 3.0</font>
<a name="line212"/>   <font CLASS=comment>212:</font> 	<font CLASS=keyword>friend</font> vec3 <font CLASS=keyword>operator</font> ^ (<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> vec3&amp; b);	    <font CLASS=comment>// cross product</font>
<a name="line213"/>   <font CLASS=comment>213:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keytype>int</font> <font CLASS=keyword>operator</font> <font CLASS=symbols>==</font> (<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> vec3&amp; b);	    <font CLASS=comment>// v1 == v2 ?</font>
<a name="line214"/>   <font CLASS=comment>214:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keytype>int</font> <font CLASS=keyword>operator</font> <font CLASS=symbols>!=</font> (<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> vec3&amp; b);	    <font CLASS=comment>// v1 != v2 ?</font>
<a name="line215"/>   <font CLASS=comment>215:</font> 
<a name="line216"/>   <font CLASS=comment>216:</font> <font CLASS=preproc>#ifdef</font> ALGEBRA3IOSTREAMS 
<a name="line217"/>   <font CLASS=comment>217:</font> 	<font CLASS=keyword>friend</font> ostream&amp; <font CLASS=keyword>operator</font> &lt;&lt; (ostream&amp; s, <font CLASS=keyword>const</font> vec3&amp; v);	   <font CLASS=comment>// output to stream</font>
<a name="line218"/>   <font CLASS=comment>218:</font> 	<font CLASS=keyword>friend</font> istream&amp; <font CLASS=keyword>operator</font> &gt;&gt; (istream&amp; s, vec3&amp; v);	    <font CLASS=comment>// input from strm.</font>
<a name="line219"/>   <font CLASS=comment>219:</font> <font CLASS=preproc>#endif</font> <font CLASS=comment>// ALGEBRA3IOSTREAMS </font>
<a name="line220"/>   <font CLASS=comment>220:</font> 
<a name="line221"/>   <font CLASS=comment>221:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keytype>void</font> swap(vec3&amp; a, vec3&amp; b);						<font CLASS=comment>// swap v1 &amp; v2</font>
<a name="line222"/>   <font CLASS=comment>222:</font> 	<font CLASS=keyword>friend</font> vec3 min(<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> vec3&amp; b);		    <font CLASS=comment>// min(v1, v2)</font>
<a name="line223"/>   <font CLASS=comment>223:</font> 	<font CLASS=keyword>friend</font> vec3 max(<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> vec3&amp; b);		    <font CLASS=comment>// max(v1, v2)</font>
<a name="line224"/>   <font CLASS=comment>224:</font> 	<font CLASS=keyword>friend</font> vec3 prod(<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> vec3&amp; b);		    <font CLASS=comment>// term by term *</font>
<a name="line225"/>   <font CLASS=comment>225:</font> 	<font CLASS=keyword>friend</font> vec3 floor(<font CLASS=keyword>const</font> vec3&amp; v);						<font CLASS=comment>// term by term floor</font>
<a name="line226"/>   <font CLASS=comment>226:</font> 	<font CLASS=keyword>friend</font> vec3 ceil(<font CLASS=keyword>const</font> vec3&amp; v);						<font CLASS=comment>// term by term ceil</font>
<a name="line227"/>   <font CLASS=comment>227:</font> 
<a name="line228"/>   <font CLASS=comment>228:</font> 	<font CLASS=comment>// necessary friend declarations</font>
<a name="line229"/>   <font CLASS=comment>229:</font> 
<a name="line230"/>   <font CLASS=comment>230:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keyword>class</font> vec2;
<a name="line231"/>   <font CLASS=comment>231:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keyword>class</font> vec4;
<a name="line232"/>   <font CLASS=comment>232:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keyword>class</font> mat3;
<a name="line233"/>   <font CLASS=comment>233:</font> 	<font CLASS=keyword>friend</font> vec2 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> vec2&amp; v);	<font CLASS=comment>// linear transform</font>
<a name="line234"/>   <font CLASS=comment>234:</font> 	<font CLASS=keyword>friend</font> vec3 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> vec3&amp; v);
<a name="line235"/>   <font CLASS=comment>235:</font> 	<font CLASS=keyword>friend</font> mat3 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> mat3&amp; b);	<font CLASS=comment>// matrix 3 product</font>
<a name="line236"/>   <font CLASS=comment>236:</font> };
<a name="line237"/>   <font CLASS=comment>237:</font> 
<a name="line238"/>   <font CLASS=comment>238:</font> <font CLASS=comment>/****************************************************************
<a name="line239"/>   <font CLASS=comment>239:</font> *																*
<a name="line240"/>   <font CLASS=comment>240:</font> *			    4D Vector										*
<a name="line241"/>   <font CLASS=comment>241:</font> *																*
<a name="line242"/>   <font CLASS=comment>242:</font> ****************************************************************/</font>
<a name="line243"/>   <font CLASS=comment>243:</font> 
<a name="line244"/>   <font CLASS=comment>244:</font> <font CLASS=keyword>class</font> vec4
<a name="line245"/>   <font CLASS=comment>245:</font> {
<a name="line246"/>   <font CLASS=comment>246:</font> <font CLASS=preproc><font CLASS=keyword>protected</font>:</font>
<a name="line247"/>   <font CLASS=comment>247:</font> 
<a name="line248"/>   <font CLASS=comment>248:</font> 	<font CLASS=keytype>double</font> n[<font CLASS=integer>4</font>];
<a name="line249"/>   <font CLASS=comment>249:</font> 
<a name="line250"/>   <font CLASS=comment>250:</font> <font CLASS=preproc><font CLASS=keyword>public</font>:</font>
<a name="line251"/>   <font CLASS=comment>251:</font> 
<a name="line252"/>   <font CLASS=comment>252:</font> 	<font CLASS=comment>// Constructors</font>
<a name="line253"/>   <font CLASS=comment>253:</font> 
<a name="line254"/>   <font CLASS=comment>254:</font> 	vec4();
<a name="line255"/>   <font CLASS=comment>255:</font> 	vec4(<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> x, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> y, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> z, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> w);
<a name="line256"/>   <font CLASS=comment>256:</font> 	vec4(<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d);
<a name="line257"/>   <font CLASS=comment>257:</font> 	vec4(<font CLASS=keyword>const</font> vec4&amp; v);			    <font CLASS=comment>// copy constructor</font>
<a name="line258"/>   <font CLASS=comment>258:</font> 	vec4(<font CLASS=keyword>const</font> vec3&amp; v);			    <font CLASS=comment>// cast vec3 to vec4</font>
<a name="line259"/>   <font CLASS=comment>259:</font> 	vec4(<font CLASS=keyword>const</font> vec3&amp; v, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d);	    <font CLASS=comment>// cast vec3 to vec4</font>
<a name="line260"/>   <font CLASS=comment>260:</font> 
<a name="line261"/>   <font CLASS=comment>261:</font> 	<font CLASS=comment>// Assignment operators</font>
<a name="line262"/>   <font CLASS=comment>262:</font> 
<a name="line263"/>   <font CLASS=comment>263:</font> 	vec4&amp; <font CLASS=keyword>operator</font>	<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> vec4&amp; v );	    <font CLASS=comment>// assignment of a vec4</font>
<a name="line264"/>   <font CLASS=comment>264:</font> 	vec4&amp; <font CLASS=keyword>operator</font> <font CLASS=symbols>+=</font> ( <font CLASS=keyword>const</font> vec4&amp; v );	    <font CLASS=comment>// incrementation by a vec4</font>
<a name="line265"/>   <font CLASS=comment>265:</font> 	vec4&amp; <font CLASS=keyword>operator</font> <font CLASS=symbols>-=</font> ( <font CLASS=keyword>const</font> vec4&amp; v );	    <font CLASS=comment>// decrementation by a vec4</font>
<a name="line266"/>   <font CLASS=comment>266:</font> 	vec4&amp; <font CLASS=keyword>operator</font> *<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d );	    <font CLASS=comment>// multiplication by a constant</font>
<a name="line267"/>   <font CLASS=comment>267:</font> 	vec4&amp; <font CLASS=keyword>operator</font> /<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d );	    <font CLASS=comment>// division by a constant</font>
<a name="line268"/>   <font CLASS=comment>268:</font> 	<font CLASS=keytype>double</font>&amp; <font CLASS=keyword>operator</font> [] ( <font CLASS=keytype>int</font> i);				<font CLASS=comment>// indexing</font>
<a name="line269"/>   <font CLASS=comment>269:</font> 	<font CLASS=keytype>double</font> <font CLASS=keyword>operator</font>[] (<font CLASS=keytype>int</font> i) <font CLASS=keyword>const</font>;			<font CLASS=comment>// read-only indexing</font>
<a name="line270"/>   <font CLASS=comment>270:</font> 
<a name="line271"/>   <font CLASS=comment>271:</font> 	<font CLASS=comment>// special functions</font>
<a name="line272"/>   <font CLASS=comment>272:</font> 
<a name="line273"/>   <font CLASS=comment>273:</font> 	<font CLASS=keytype>double</font> length() <font CLASS=keyword>const</font>;			<font CLASS=comment>// length of a vec4</font>
<a name="line274"/>   <font CLASS=comment>274:</font> 	<font CLASS=keytype>double</font> length2() <font CLASS=keyword>const</font>;			<font CLASS=comment>// squared length of a vec4</font>
<a name="line275"/>   <font CLASS=comment>275:</font> 	vec4&amp; normalize();			    <font CLASS=comment>// normalize a vec4 in place</font>
<a name="line276"/>   <font CLASS=comment>276:</font> 	vec4&amp; apply(V_FCT_PTR fct);		<font CLASS=comment>// apply a func. to each component</font>
<a name="line277"/>   <font CLASS=comment>277:</font> 	<font CLASS=keytype>void</font> set( <font CLASS=keytype>float</font> x, <font CLASS=keytype>float</font> y, <font CLASS=keytype>float</font> z, <font CLASS=keytype>float</font> a );	<font CLASS=comment>// set vector</font>
<a name="line278"/>   <font CLASS=comment>278:</font> 
<a name="line279"/>   <font CLASS=comment>279:</font> 	<font CLASS=comment>// friends</font>
<a name="line280"/>   <font CLASS=comment>280:</font> 
<a name="line281"/>   <font CLASS=comment>281:</font> 	<font CLASS=keyword>friend</font> vec4 <font CLASS=keyword>operator</font> <font CLASS=symbols>-</font> (<font CLASS=keyword>const</font> vec4&amp; v);						<font CLASS=comment>// -v1</font>
<a name="line282"/>   <font CLASS=comment>282:</font> 	<font CLASS=keyword>friend</font> vec4 <font CLASS=keyword>operator</font> <font CLASS=symbols>+</font> (<font CLASS=keyword>const</font> vec4&amp; a, <font CLASS=keyword>const</font> vec4&amp; b);	    <font CLASS=comment>// v1 + v2</font>
<a name="line283"/>   <font CLASS=comment>283:</font> 	<font CLASS=keyword>friend</font> vec4 <font CLASS=keyword>operator</font> <font CLASS=symbols>-</font> (<font CLASS=keyword>const</font> vec4&amp; a, <font CLASS=keyword>const</font> vec4&amp; b);	    <font CLASS=comment>// v1 - v2</font>
<a name="line284"/>   <font CLASS=comment>284:</font> 	<font CLASS=keyword>friend</font> vec4 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> vec4&amp; a, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d);	    <font CLASS=comment>// v1 * 3.0</font>
<a name="line285"/>   <font CLASS=comment>285:</font> 	<font CLASS=keyword>friend</font> vec4 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d, <font CLASS=keyword>const</font> vec4&amp; a);	    <font CLASS=comment>// 3.0 * v1</font>
<a name="line286"/>   <font CLASS=comment>286:</font> 	<font CLASS=keyword>friend</font> vec4 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> vec4&amp; v);	    <font CLASS=comment>// M . v</font>
<a name="line287"/>   <font CLASS=comment>287:</font> 	<font CLASS=keyword>friend</font> vec4 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> vec4&amp; v, <font CLASS=keyword>const</font> mat4&amp; a);	    <font CLASS=comment>// v . M</font>
<a name="line288"/>   <font CLASS=comment>288:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keytype>double</font> <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> vec4&amp; a, <font CLASS=keyword>const</font> vec4&amp; b);    <font CLASS=comment>// dot product</font>
<a name="line289"/>   <font CLASS=comment>289:</font> 	<font CLASS=keyword>friend</font> vec4 <font CLASS=keyword>operator</font> / (<font CLASS=keyword>const</font> vec4&amp; a, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d);	    <font CLASS=comment>// v1 / 3.0</font>
<a name="line290"/>   <font CLASS=comment>290:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keytype>int</font> <font CLASS=keyword>operator</font> <font CLASS=symbols>==</font> (<font CLASS=keyword>const</font> vec4&amp; a, <font CLASS=keyword>const</font> vec4&amp; b);	    <font CLASS=comment>// v1 == v2 ?</font>
<a name="line291"/>   <font CLASS=comment>291:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keytype>int</font> <font CLASS=keyword>operator</font> <font CLASS=symbols>!=</font> (<font CLASS=keyword>const</font> vec4&amp; a, <font CLASS=keyword>const</font> vec4&amp; b);	    <font CLASS=comment>// v1 != v2 ?</font>
<a name="line292"/>   <font CLASS=comment>292:</font> 
<a name="line293"/>   <font CLASS=comment>293:</font> <font CLASS=preproc>#ifdef</font> ALGEBRA3IOSTREAMS 
<a name="line294"/>   <font CLASS=comment>294:</font> 	<font CLASS=keyword>friend</font> ostream&amp; <font CLASS=keyword>operator</font> &lt;&lt; (ostream&amp; s, <font CLASS=keyword>const</font> vec4&amp; v);	<font CLASS=comment>// output to stream</font>
<a name="line295"/>   <font CLASS=comment>295:</font> 	<font CLASS=keyword>friend</font> istream&amp; <font CLASS=keyword>operator</font> &gt;&gt; (istream&amp; s, vec4&amp; v);	    <font CLASS=comment>// input from strm.</font>
<a name="line296"/>   <font CLASS=comment>296:</font> <font CLASS=preproc>#endif</font> <font CLASS=comment>//  ALGEBRA3IOSTREAMS </font>
<a name="line297"/>   <font CLASS=comment>297:</font> 
<a name="line298"/>   <font CLASS=comment>298:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keytype>void</font> swap(vec4&amp; a, vec4&amp; b);						<font CLASS=comment>// swap v1 &amp; v2</font>
<a name="line299"/>   <font CLASS=comment>299:</font> 	<font CLASS=keyword>friend</font> vec4 min(<font CLASS=keyword>const</font> vec4&amp; a, <font CLASS=keyword>const</font> vec4&amp; b);		    <font CLASS=comment>// min(v1, v2)</font>
<a name="line300"/>   <font CLASS=comment>300:</font> 	<font CLASS=keyword>friend</font> vec4 max(<font CLASS=keyword>const</font> vec4&amp; a, <font CLASS=keyword>const</font> vec4&amp; b);		    <font CLASS=comment>// max(v1, v2)</font>
<a name="line301"/>   <font CLASS=comment>301:</font> 	<font CLASS=keyword>friend</font> vec4 prod(<font CLASS=keyword>const</font> vec4&amp; a, <font CLASS=keyword>const</font> vec4&amp; b);		    <font CLASS=comment>// term by term *</font>
<a name="line302"/>   <font CLASS=comment>302:</font> 	<font CLASS=keyword>friend</font> vec4 floor(<font CLASS=keyword>const</font> vec4&amp; v);						<font CLASS=comment>// term by term floor</font>
<a name="line303"/>   <font CLASS=comment>303:</font> 	<font CLASS=keyword>friend</font> vec4 ceil(<font CLASS=keyword>const</font> vec4&amp; v);						<font CLASS=comment>// term by term ceil</font>
<a name="line304"/>   <font CLASS=comment>304:</font> 
<a name="line305"/>   <font CLASS=comment>305:</font> 	<font CLASS=comment>// necessary friend declarations</font>
<a name="line306"/>   <font CLASS=comment>306:</font> 
<a name="line307"/>   <font CLASS=comment>307:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keyword>class</font> vec3;
<a name="line308"/>   <font CLASS=comment>308:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keyword>class</font> mat4;
<a name="line309"/>   <font CLASS=comment>309:</font> 	<font CLASS=keyword>friend</font> vec3 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> vec3&amp; v);	<font CLASS=comment>// linear transform</font>
<a name="line310"/>   <font CLASS=comment>310:</font> 	<font CLASS=keyword>friend</font> mat4 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> mat4&amp; b);	<font CLASS=comment>// matrix 4 product</font>
<a name="line311"/>   <font CLASS=comment>311:</font> };
<a name="line312"/>   <font CLASS=comment>312:</font> 
<a name="line313"/>   <font CLASS=comment>313:</font> <font CLASS=comment>/****************************************************************
<a name="line314"/>   <font CLASS=comment>314:</font> *																*
<a name="line315"/>   <font CLASS=comment>315:</font> *			   3x3 Matrix										*
<a name="line316"/>   <font CLASS=comment>316:</font> *																*
<a name="line317"/>   <font CLASS=comment>317:</font> ****************************************************************/</font>
<a name="line318"/>   <font CLASS=comment>318:</font> 
<a name="line319"/>   <font CLASS=comment>319:</font> <font CLASS=keyword>class</font> mat3
<a name="line320"/>   <font CLASS=comment>320:</font> {
<a name="line321"/>   <font CLASS=comment>321:</font> <font CLASS=preproc><font CLASS=keyword>protected</font>:</font>
<a name="line322"/>   <font CLASS=comment>322:</font> 
<a name="line323"/>   <font CLASS=comment>323:</font> 	vec3 v[<font CLASS=integer>3</font>];
<a name="line324"/>   <font CLASS=comment>324:</font> 
<a name="line325"/>   <font CLASS=comment>325:</font> <font CLASS=preproc><font CLASS=keyword>public</font>:</font>
<a name="line326"/>   <font CLASS=comment>326:</font> 
<a name="line327"/>   <font CLASS=comment>327:</font> 	<font CLASS=comment>// Constructors</font>
<a name="line328"/>   <font CLASS=comment>328:</font> 
<a name="line329"/>   <font CLASS=comment>329:</font> 	mat3();
<a name="line330"/>   <font CLASS=comment>330:</font> 	mat3(<font CLASS=keyword>const</font> vec3&amp; v0, <font CLASS=keyword>const</font> vec3&amp; v1, <font CLASS=keyword>const</font> vec3&amp; v2);
<a name="line331"/>   <font CLASS=comment>331:</font> 	mat3(<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d);
<a name="line332"/>   <font CLASS=comment>332:</font> 	mat3(<font CLASS=keyword>const</font> mat3&amp; m);
<a name="line333"/>   <font CLASS=comment>333:</font> 
<a name="line334"/>   <font CLASS=comment>334:</font> 	<font CLASS=comment>// Assignment operators</font>
<a name="line335"/>   <font CLASS=comment>335:</font> 
<a name="line336"/>   <font CLASS=comment>336:</font> 	mat3&amp; <font CLASS=keyword>operator</font>	<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> mat3&amp; m );	    <font CLASS=comment>// assignment of a mat3</font>
<a name="line337"/>   <font CLASS=comment>337:</font> 	mat3&amp; <font CLASS=keyword>operator</font> <font CLASS=symbols>+=</font> ( <font CLASS=keyword>const</font> mat3&amp; m );	    <font CLASS=comment>// incrementation by a mat3</font>
<a name="line338"/>   <font CLASS=comment>338:</font> 	mat3&amp; <font CLASS=keyword>operator</font> <font CLASS=symbols>-=</font> ( <font CLASS=keyword>const</font> mat3&amp; m );	    <font CLASS=comment>// decrementation by a mat3</font>
<a name="line339"/>   <font CLASS=comment>339:</font> 	mat3&amp; <font CLASS=keyword>operator</font> *<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d );	    <font CLASS=comment>// multiplication by a constant</font>
<a name="line340"/>   <font CLASS=comment>340:</font> 	mat3&amp; <font CLASS=keyword>operator</font> /<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d );	    <font CLASS=comment>// division by a constant</font>
<a name="line341"/>   <font CLASS=comment>341:</font> 	vec3&amp; <font CLASS=keyword>operator</font> [] ( <font CLASS=keytype>int</font> i);					<font CLASS=comment>// indexing</font>
<a name="line342"/>   <font CLASS=comment>342:</font> 	<font CLASS=keyword>const</font> vec3&amp; <font CLASS=keyword>operator</font> [] ( <font CLASS=keytype>int</font> i) <font CLASS=keyword>const</font>;		<font CLASS=comment>// read-only indexing</font>
<a name="line343"/>   <font CLASS=comment>343:</font> 
<a name="line344"/>   <font CLASS=comment>344:</font> 	<font CLASS=comment>// special functions</font>
<a name="line345"/>   <font CLASS=comment>345:</font> 
<a name="line346"/>   <font CLASS=comment>346:</font> 	mat3 transpose() <font CLASS=keyword>const</font>;			    <font CLASS=comment>// transpose</font>
<a name="line347"/>   <font CLASS=comment>347:</font> 	mat3 inverse() <font CLASS=keyword>const</font>;				<font CLASS=comment>// inverse</font>
<a name="line348"/>   <font CLASS=comment>348:</font> 	mat3&amp; apply(V_FCT_PTR fct);		    <font CLASS=comment>// apply a func. to each element</font>
<a name="line349"/>   <font CLASS=comment>349:</font> 	<font CLASS=keytype>void</font> set(<font CLASS=keyword>const</font> vec3&amp; v0, <font CLASS=keyword>const</font> vec3&amp; v1, <font CLASS=keyword>const</font> vec3&amp; v2);	<font CLASS=comment>// set matrix</font>
<a name="line350"/>   <font CLASS=comment>350:</font> 	<font CLASS=keytype>double</font> det() <font CLASS=keyword>const</font>;					<font CLASS=comment>// determinant</font>
<a name="line351"/>   <font CLASS=comment>351:</font> 
<a name="line352"/>   <font CLASS=comment>352:</font> 	<font CLASS=comment>// friends</font>
<a name="line353"/>   <font CLASS=comment>353:</font> 
<a name="line354"/>   <font CLASS=comment>354:</font> 	<font CLASS=keyword>friend</font> mat3 <font CLASS=keyword>operator</font> <font CLASS=symbols>-</font> (<font CLASS=keyword>const</font> mat3&amp; a);						<font CLASS=comment>// -m1</font>
<a name="line355"/>   <font CLASS=comment>355:</font> 	<font CLASS=keyword>friend</font> mat3 <font CLASS=keyword>operator</font> <font CLASS=symbols>+</font> (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> mat3&amp; b);	    <font CLASS=comment>// m1 + m2</font>
<a name="line356"/>   <font CLASS=comment>356:</font> 	<font CLASS=keyword>friend</font> mat3 <font CLASS=keyword>operator</font> <font CLASS=symbols>-</font> (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> mat3&amp; b);	    <font CLASS=comment>// m1 - m2</font>
<a name="line357"/>   <font CLASS=comment>357:</font> 	<font CLASS=keyword>friend</font> mat3 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> mat3&amp; b);		<font CLASS=comment>// m1 * m2</font>
<a name="line358"/>   <font CLASS=comment>358:</font> 	<font CLASS=keyword>friend</font> mat3 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d);	    <font CLASS=comment>// m1 * 3.0</font>
<a name="line359"/>   <font CLASS=comment>359:</font> 	<font CLASS=keyword>friend</font> mat3 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d, <font CLASS=keyword>const</font> mat3&amp; a);	    <font CLASS=comment>// 3.0 * m1</font>
<a name="line360"/>   <font CLASS=comment>360:</font> 	<font CLASS=keyword>friend</font> mat3 <font CLASS=keyword>operator</font> / (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d);	    <font CLASS=comment>// m1 / 3.0</font>
<a name="line361"/>   <font CLASS=comment>361:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keytype>int</font> <font CLASS=keyword>operator</font> <font CLASS=symbols>==</font> (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> mat3&amp; b);	    <font CLASS=comment>// m1 == m2 ?</font>
<a name="line362"/>   <font CLASS=comment>362:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keytype>int</font> <font CLASS=keyword>operator</font> <font CLASS=symbols>!=</font> (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> mat3&amp; b);	    <font CLASS=comment>// m1 != m2 ?</font>
<a name="line363"/>   <font CLASS=comment>363:</font> 
<a name="line364"/>   <font CLASS=comment>364:</font> <font CLASS=preproc>#ifdef</font> ALGEBRA3IOSTREAMS 
<a name="line365"/>   <font CLASS=comment>365:</font> 	<font CLASS=keyword>friend</font> ostream&amp; <font CLASS=keyword>operator</font> &lt;&lt; (ostream&amp; s, <font CLASS=keyword>const</font> mat3&amp; m);	<font CLASS=comment>// output to stream</font>
<a name="line366"/>   <font CLASS=comment>366:</font> 	<font CLASS=keyword>friend</font> istream&amp; <font CLASS=keyword>operator</font> &gt;&gt; (istream&amp; s, mat3&amp; m);	    <font CLASS=comment>// input from strm.</font>
<a name="line367"/>   <font CLASS=comment>367:</font> <font CLASS=preproc>#endif</font> <font CLASS=comment>//  ALGEBRA3IOSTREAMS </font>
<a name="line368"/>   <font CLASS=comment>368:</font> 
<a name="line369"/>   <font CLASS=comment>369:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keytype>void</font> swap(mat3&amp; a, mat3&amp; b);			    <font CLASS=comment>// swap m1 &amp; m2</font>
<a name="line370"/>   <font CLASS=comment>370:</font> 
<a name="line371"/>   <font CLASS=comment>371:</font> 	<font CLASS=comment>// necessary friend declarations</font>
<a name="line372"/>   <font CLASS=comment>372:</font> 
<a name="line373"/>   <font CLASS=comment>373:</font> 	<font CLASS=keyword>friend</font> vec3 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> vec3&amp; v);	    <font CLASS=comment>// linear transform</font>
<a name="line374"/>   <font CLASS=comment>374:</font> 	<font CLASS=keyword>friend</font> vec2 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> vec2&amp; v);	    <font CLASS=comment>// linear transform</font>
<a name="line375"/>   <font CLASS=comment>375:</font> };
<a name="line376"/>   <font CLASS=comment>376:</font> 
<a name="line377"/>   <font CLASS=comment>377:</font> <font CLASS=comment>/****************************************************************
<a name="line378"/>   <font CLASS=comment>378:</font> *																*
<a name="line379"/>   <font CLASS=comment>379:</font> *			   4x4 Matrix										*
<a name="line380"/>   <font CLASS=comment>380:</font> *																*
<a name="line381"/>   <font CLASS=comment>381:</font> ****************************************************************/</font>
<a name="line382"/>   <font CLASS=comment>382:</font> 
<a name="line383"/>   <font CLASS=comment>383:</font> <font CLASS=keyword>class</font> mat4
<a name="line384"/>   <font CLASS=comment>384:</font> {
<a name="line385"/>   <font CLASS=comment>385:</font> <font CLASS=preproc><font CLASS=keyword>protected</font>:</font>
<a name="line386"/>   <font CLASS=comment>386:</font> 
<a name="line387"/>   <font CLASS=comment>387:</font> 	vec4 v[<font CLASS=integer>4</font>];
<a name="line388"/>   <font CLASS=comment>388:</font> 
<a name="line389"/>   <font CLASS=comment>389:</font> <font CLASS=preproc><font CLASS=keyword>public</font>:</font>
<a name="line390"/>   <font CLASS=comment>390:</font> 
<a name="line391"/>   <font CLASS=comment>391:</font> 	<font CLASS=comment>// Constructors</font>
<a name="line392"/>   <font CLASS=comment>392:</font> 
<a name="line393"/>   <font CLASS=comment>393:</font> 	mat4();
<a name="line394"/>   <font CLASS=comment>394:</font> 	mat4(<font CLASS=keyword>const</font> vec4&amp; v0, <font CLASS=keyword>const</font> vec4&amp; v1, <font CLASS=keyword>const</font> vec4&amp; v2, <font CLASS=keyword>const</font> vec4&amp; v3);
<a name="line395"/>   <font CLASS=comment>395:</font> 	mat4(<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d);
<a name="line396"/>   <font CLASS=comment>396:</font> 	mat4(<font CLASS=keyword>const</font> mat4&amp; m);
<a name="line397"/>   <font CLASS=comment>397:</font> 
<a name="line398"/>   <font CLASS=comment>398:</font> 	<font CLASS=comment>// Assignment operators</font>
<a name="line399"/>   <font CLASS=comment>399:</font> 
<a name="line400"/>   <font CLASS=comment>400:</font> 	mat4&amp; <font CLASS=keyword>operator</font>	<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> mat4&amp; m );	    <font CLASS=comment>// assignment of a mat4</font>
<a name="line401"/>   <font CLASS=comment>401:</font> 	mat4&amp; <font CLASS=keyword>operator</font> <font CLASS=symbols>+=</font> ( <font CLASS=keyword>const</font> mat4&amp; m );	    <font CLASS=comment>// incrementation by a mat4</font>
<a name="line402"/>   <font CLASS=comment>402:</font> 	mat4&amp; <font CLASS=keyword>operator</font> <font CLASS=symbols>-=</font> ( <font CLASS=keyword>const</font> mat4&amp; m );	    <font CLASS=comment>// decrementation by a mat4</font>
<a name="line403"/>   <font CLASS=comment>403:</font> 	mat4&amp; <font CLASS=keyword>operator</font> *<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d );	    <font CLASS=comment>// multiplication by a constant</font>
<a name="line404"/>   <font CLASS=comment>404:</font> 	mat4&amp; <font CLASS=keyword>operator</font> /<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d );	    <font CLASS=comment>// division by a constant</font>
<a name="line405"/>   <font CLASS=comment>405:</font> 	vec4&amp; <font CLASS=keyword>operator</font> [] ( <font CLASS=keytype>int</font> i);					<font CLASS=comment>// indexing</font>
<a name="line406"/>   <font CLASS=comment>406:</font> 	<font CLASS=keyword>const</font> vec4&amp; <font CLASS=keyword>operator</font> [] ( <font CLASS=keytype>int</font> i) <font CLASS=keyword>const</font>;		<font CLASS=comment>// read-only indexing</font>
<a name="line407"/>   <font CLASS=comment>407:</font> 
<a name="line408"/>   <font CLASS=comment>408:</font> 	<font CLASS=comment>// special functions</font>
<a name="line409"/>   <font CLASS=comment>409:</font> 
<a name="line410"/>   <font CLASS=comment>410:</font> 	mat4 transpose() <font CLASS=keyword>const</font>;						<font CLASS=comment>// transpose</font>
<a name="line411"/>   <font CLASS=comment>411:</font> 	mat4 inverse() <font CLASS=keyword>const</font>;						<font CLASS=comment>// inverse</font>
<a name="line412"/>   <font CLASS=comment>412:</font> 	mat4&amp; apply(V_FCT_PTR fct);					<font CLASS=comment>// apply a func. to each element</font>
<a name="line413"/>   <font CLASS=comment>413:</font> 	<font CLASS=keytype>void</font> swap_rows( <font CLASS=keytype>int</font> i, <font CLASS=keytype>int</font> j );             <font CLASS=comment>// swap rows i and j</font>
<a name="line414"/>   <font CLASS=comment>414:</font> 	<font CLASS=keytype>void</font> swap_cols( <font CLASS=keytype>int</font> i, <font CLASS=keytype>int</font> j );             <font CLASS=comment>// swap cols i and j</font>
<a name="line415"/>   <font CLASS=comment>415:</font> 	<font CLASS=keytype>double</font> det() <font CLASS=keyword>const</font>;							<font CLASS=comment>// determinant</font>
<a name="line416"/>   <font CLASS=comment>416:</font> 
<a name="line417"/>   <font CLASS=comment>417:</font> 	<font CLASS=comment>// friends</font>
<a name="line418"/>   <font CLASS=comment>418:</font> 
<a name="line419"/>   <font CLASS=comment>419:</font> 	<font CLASS=keyword>friend</font> mat4 <font CLASS=keyword>operator</font> <font CLASS=symbols>-</font> (<font CLASS=keyword>const</font> mat4&amp; a);						<font CLASS=comment>// -m1</font>
<a name="line420"/>   <font CLASS=comment>420:</font> 	<font CLASS=keyword>friend</font> mat4 <font CLASS=keyword>operator</font> <font CLASS=symbols>+</font> (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> mat4&amp; b);	    <font CLASS=comment>// m1 + m2</font>
<a name="line421"/>   <font CLASS=comment>421:</font> 	<font CLASS=keyword>friend</font> mat4 <font CLASS=keyword>operator</font> <font CLASS=symbols>-</font> (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> mat4&amp; b);	    <font CLASS=comment>// m1 - m2</font>
<a name="line422"/>   <font CLASS=comment>422:</font> 	<font CLASS=keyword>friend</font> mat4 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> mat4&amp; b);		<font CLASS=comment>// m1 * m2</font>
<a name="line423"/>   <font CLASS=comment>423:</font> 	<font CLASS=keyword>friend</font> mat4 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d);	    <font CLASS=comment>// m1 * 4.0</font>
<a name="line424"/>   <font CLASS=comment>424:</font> 	<font CLASS=keyword>friend</font> mat4 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d, <font CLASS=keyword>const</font> mat4&amp; a);	    <font CLASS=comment>// 4.0 * m1</font>
<a name="line425"/>   <font CLASS=comment>425:</font> 	<font CLASS=keyword>friend</font> mat4 <font CLASS=keyword>operator</font> / (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d);	    <font CLASS=comment>// m1 / 3.0</font>
<a name="line426"/>   <font CLASS=comment>426:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keytype>int</font> <font CLASS=keyword>operator</font> <font CLASS=symbols>==</font> (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> mat4&amp; b);	    <font CLASS=comment>// m1 == m2 ?</font>
<a name="line427"/>   <font CLASS=comment>427:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keytype>int</font> <font CLASS=keyword>operator</font> <font CLASS=symbols>!=</font> (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> mat4&amp; b);	    <font CLASS=comment>// m1 != m2 ?</font>
<a name="line428"/>   <font CLASS=comment>428:</font> 
<a name="line429"/>   <font CLASS=comment>429:</font> <font CLASS=preproc>#ifdef</font> ALGEBRA3IOSTREAMS 
<a name="line430"/>   <font CLASS=comment>430:</font> 	<font CLASS=keyword>friend</font> ostream&amp; <font CLASS=keyword>operator</font> &lt;&lt; (ostream&amp; s, <font CLASS=keyword>const</font> mat4&amp; m);	<font CLASS=comment>// output to stream</font>
<a name="line431"/>   <font CLASS=comment>431:</font> 	<font CLASS=keyword>friend</font> istream&amp; <font CLASS=keyword>operator</font> &gt;&gt; (istream&amp; s, mat4&amp; m);			<font CLASS=comment>// input from strm.</font>
<a name="line432"/>   <font CLASS=comment>432:</font> <font CLASS=preproc>#endif</font> <font CLASS=comment>//  ALGEBRA3IOSTREAMS </font>
<a name="line433"/>   <font CLASS=comment>433:</font> 
<a name="line434"/>   <font CLASS=comment>434:</font> 	<font CLASS=keyword>friend</font> <font CLASS=keytype>void</font> swap(mat4&amp; a, mat4&amp; b);							<font CLASS=comment>// swap m1 &amp; m2</font>
<a name="line435"/>   <font CLASS=comment>435:</font> 
<a name="line436"/>   <font CLASS=comment>436:</font> 	<font CLASS=comment>// necessary friend declarations</font>
<a name="line437"/>   <font CLASS=comment>437:</font> 
<a name="line438"/>   <font CLASS=comment>438:</font> 	<font CLASS=keyword>friend</font> vec4 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> vec4&amp; v);	    <font CLASS=comment>// linear transform</font>
<a name="line439"/>   <font CLASS=comment>439:</font> 	<font CLASS=keyword>friend</font> vec3 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> vec3&amp; v);	    <font CLASS=comment>// linear transform</font>
<a name="line440"/>   <font CLASS=comment>440:</font> };
<a name="line441"/>   <font CLASS=comment>441:</font> 
<a name="line442"/>   <font CLASS=comment>442:</font> <font CLASS=comment>/****************************************************************
<a name="line443"/>   <font CLASS=comment>443:</font> *																*
<a name="line444"/>   <font CLASS=comment>444:</font> *	       2D functions and 3D functions						*
<a name="line445"/>   <font CLASS=comment>445:</font> *																*
<a name="line446"/>   <font CLASS=comment>446:</font> ****************************************************************/</font>
<a name="line447"/>   <font CLASS=comment>447:</font> 
<a name="line448"/>   <font CLASS=comment>448:</font> mat3 identity2D();								<font CLASS=comment>// identity 2D</font>
<a name="line449"/>   <font CLASS=comment>449:</font> mat3 translation2D(<font CLASS=keyword>const</font> vec2&amp; v);				<font CLASS=comment>// translation 2D</font>
<a name="line450"/>   <font CLASS=comment>450:</font> mat3 rotation2Ddeg(<font CLASS=keyword>const</font> vec2&amp; Center, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> angleDeg);	<font CLASS=comment>// rotation 2D</font>
<a name="line451"/>   <font CLASS=comment>451:</font> mat3 rotation3Drad(<font CLASS=keyword>const</font> vec3&amp; axis, <font CLASS=keyword>const</font> <font CLASS=keytype>float</font> angleRad);	<font CLASS=comment>// rotation 3D</font>
<a name="line452"/>   <font CLASS=comment>452:</font> mat3 scaling2D(<font CLASS=keyword>const</font> vec2&amp; scaleVector);		<font CLASS=comment>// scaling 2D</font>
<a name="line453"/>   <font CLASS=comment>453:</font> mat4 identity3D();								<font CLASS=comment>// identity 3D</font>
<a name="line454"/>   <font CLASS=comment>454:</font> mat4 translation3D(<font CLASS=keyword>const</font> vec3&amp; v);				<font CLASS=comment>// translation 3D</font>
<a name="line455"/>   <font CLASS=comment>455:</font> mat4 rotation3Ddeg(vec3 Axis, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> angleDeg);	<font CLASS=comment>// rotation 3D</font>
<a name="line456"/>   <font CLASS=comment>456:</font> mat4 scaling3D(<font CLASS=keyword>const</font> vec3&amp; scaleVector);		<font CLASS=comment>// scaling 3D</font>
<a name="line457"/>   <font CLASS=comment>457:</font> mat4 perspective3D(<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d);			    <font CLASS=comment>// perspective 3D</font>
<a name="line458"/>   <font CLASS=comment>458:</font> 
<a name="line459"/>   <font CLASS=comment>459:</font> <font CLASS=comment>//</font>
<a name="line460"/>   <font CLASS=comment>460:</font> <font CLASS=comment>//	Implementation</font>
<a name="line461"/>   <font CLASS=comment>461:</font> <font CLASS=comment>//</font>
<a name="line462"/>   <font CLASS=comment>462:</font> 
<a name="line463"/>   <font CLASS=comment>463:</font> <font CLASS=comment>/****************************************************************
<a name="line464"/>   <font CLASS=comment>464:</font> *																*
<a name="line465"/>   <font CLASS=comment>465:</font> *		    vec2 Member functions								*
<a name="line466"/>   <font CLASS=comment>466:</font> *																*
<a name="line467"/>   <font CLASS=comment>467:</font> ****************************************************************/</font>
<a name="line468"/>   <font CLASS=comment>468:</font> 
<a name="line469"/>   <font CLASS=comment>469:</font> <font CLASS=comment>// CONSTRUCTORS</font>
<a name="line470"/>   <font CLASS=comment>470:</font> 
<a name="line471"/>   <font CLASS=comment>471:</font> <font CLASS=keyword>inline</font> vec2::vec2() {}
<a name="line472"/>   <font CLASS=comment>472:</font> 
<a name="line473"/>   <font CLASS=comment>473:</font> <font CLASS=keyword>inline</font> vec2::vec2(<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> x, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> y)
<a name="line474"/>   <font CLASS=comment>474:</font> {
<a name="line475"/>   <font CLASS=comment>475:</font> 	n[VX] <font CLASS=symbols>=</font> x; n[VY] <font CLASS=symbols>=</font> y; 
<a name="line476"/>   <font CLASS=comment>476:</font> }
<a name="line477"/>   <font CLASS=comment>477:</font> 
<a name="line478"/>   <font CLASS=comment>478:</font> <font CLASS=keyword>inline</font> vec2::vec2(<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d)
<a name="line479"/>   <font CLASS=comment>479:</font> { 
<a name="line480"/>   <font CLASS=comment>480:</font> 	n[VX] <font CLASS=symbols>=</font> n[VY] <font CLASS=symbols>=</font> d;
<a name="line481"/>   <font CLASS=comment>481:</font> }
<a name="line482"/>   <font CLASS=comment>482:</font> 
<a name="line483"/>   <font CLASS=comment>483:</font> <font CLASS=keyword>inline</font> vec2::vec2(<font CLASS=keyword>const</font> vec2&amp; v)
<a name="line484"/>   <font CLASS=comment>484:</font> { 
<a name="line485"/>   <font CLASS=comment>485:</font> 	n[VX] <font CLASS=symbols>=</font> v.n[VX]; n[VY] <font CLASS=symbols>=</font> v.n[VY]; 
<a name="line486"/>   <font CLASS=comment>486:</font> }
<a name="line487"/>   <font CLASS=comment>487:</font> 
<a name="line488"/>   <font CLASS=comment>488:</font> <font CLASS=keyword>inline</font> vec2::vec2(<font CLASS=keyword>const</font> vec3&amp; v) <font CLASS=comment>// it is up to caller to avoid divide-by-zero</font>
<a name="line489"/>   <font CLASS=comment>489:</font> { 
<a name="line490"/>   <font CLASS=comment>490:</font> 	n[VX] <font CLASS=symbols>=</font> v.n[VX]/v.n[VZ]; n[VY] <font CLASS=symbols>=</font> v.n[VY]/v.n[VZ]; 
<a name="line491"/>   <font CLASS=comment>491:</font> };
<a name="line492"/>   <font CLASS=comment>492:</font> 
<a name="line493"/>   <font CLASS=comment>493:</font> <font CLASS=keyword>inline</font> vec2::vec2(<font CLASS=keyword>const</font> vec3&amp; v, <font CLASS=keytype>int</font> dropAxis) 
<a name="line494"/>   <font CLASS=comment>494:</font> {
<a name="line495"/>   <font CLASS=comment>495:</font> 	<font CLASS=keyword>switch</font> (dropAxis) {
<a name="line496"/>   <font CLASS=comment>496:</font> 	<font CLASS=keyword>case</font> VX: n[VX] <font CLASS=symbols>=</font> v.n[VY]; n[VY] <font CLASS=symbols>=</font> v.n[VZ]; <font CLASS=keyword>break</font>;
<a name="line497"/>   <font CLASS=comment>497:</font> 	<font CLASS=keyword>case</font> VY: n[VX] <font CLASS=symbols>=</font> v.n[VX]; n[VY] <font CLASS=symbols>=</font> v.n[VZ]; <font CLASS=keyword>break</font>;
<a name="line498"/>   <font CLASS=comment>498:</font> 	<font CLASS=keyword>default</font>: n[VX] <font CLASS=symbols>=</font> v.n[VX]; n[VY] <font CLASS=symbols>=</font> v.n[VY]; <font CLASS=keyword>break</font>;
<a name="line499"/>   <font CLASS=comment>499:</font> 	}
<a name="line500"/>   <font CLASS=comment>500:</font> }
<a name="line501"/>   <font CLASS=comment>501:</font> 
<a name="line502"/>   <font CLASS=comment>502:</font> 
<a name="line503"/>   <font CLASS=comment>503:</font> <font CLASS=comment>// ASSIGNMENT OPERATORS</font>
<a name="line504"/>   <font CLASS=comment>504:</font> 
<a name="line505"/>   <font CLASS=comment>505:</font> <font CLASS=keyword>inline</font> vec2&amp; vec2::<font CLASS=keyword>operator</font> <font CLASS=symbols>=</font> (<font CLASS=keyword>const</font> vec2&amp; v)
<a name="line506"/>   <font CLASS=comment>506:</font> { 
<a name="line507"/>   <font CLASS=comment>507:</font> 	n[VX] <font CLASS=symbols>=</font> v.n[VX]; n[VY] <font CLASS=symbols>=</font> v.n[VY]; <font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>;
<a name="line508"/>   <font CLASS=comment>508:</font> }
<a name="line509"/>   <font CLASS=comment>509:</font> 
<a name="line510"/>   <font CLASS=comment>510:</font> <font CLASS=keyword>inline</font> vec2&amp; vec2::<font CLASS=keyword>operator</font> <font CLASS=symbols>+=</font> ( <font CLASS=keyword>const</font> vec2&amp; v )
<a name="line511"/>   <font CLASS=comment>511:</font> { 
<a name="line512"/>   <font CLASS=comment>512:</font> 	n[VX] <font CLASS=symbols>+=</font> v.n[VX]; n[VY] <font CLASS=symbols>+=</font> v.n[VY]; <font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>;
<a name="line513"/>   <font CLASS=comment>513:</font> }
<a name="line514"/>   <font CLASS=comment>514:</font> 
<a name="line515"/>   <font CLASS=comment>515:</font> <font CLASS=keyword>inline</font> vec2&amp; vec2::<font CLASS=keyword>operator</font> <font CLASS=symbols>-=</font> ( <font CLASS=keyword>const</font> vec2&amp; v )
<a name="line516"/>   <font CLASS=comment>516:</font> {
<a name="line517"/>   <font CLASS=comment>517:</font> 	n[VX] <font CLASS=symbols>-=</font> v.n[VX]; n[VY] <font CLASS=symbols>-=</font> v.n[VY]; <font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>; 
<a name="line518"/>   <font CLASS=comment>518:</font> }
<a name="line519"/>   <font CLASS=comment>519:</font> 
<a name="line520"/>   <font CLASS=comment>520:</font> <font CLASS=keyword>inline</font> vec2&amp; vec2::<font CLASS=keyword>operator</font> *<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d )
<a name="line521"/>   <font CLASS=comment>521:</font> { 
<a name="line522"/>   <font CLASS=comment>522:</font> 	n[VX] *<font CLASS=symbols>=</font> d; n[VY] *<font CLASS=symbols>=</font> d; <font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>; 
<a name="line523"/>   <font CLASS=comment>523:</font> }
<a name="line524"/>   <font CLASS=comment>524:</font> 
<a name="line525"/>   <font CLASS=comment>525:</font> <font CLASS=keyword>inline</font> vec2&amp; vec2::<font CLASS=keyword>operator</font> /<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d )
<a name="line526"/>   <font CLASS=comment>526:</font> {
<a name="line527"/>   <font CLASS=comment>527:</font> 	<font CLASS=keytype>double</font> d_inv <font CLASS=symbols>=</font> <font CLASS=integer>1</font>./d; n[VX] *<font CLASS=symbols>=</font> d_inv; n[VY] *= d_inv; <font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>; 
<a name="line528"/>   <font CLASS=comment>528:</font> }
<a name="line529"/>   <font CLASS=comment>529:</font> 
<a name="line530"/>   <font CLASS=comment>530:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>double</font>&amp; vec2::<font CLASS=keyword>operator</font> [] ( <font CLASS=keytype>int</font> i) 
<a name="line531"/>   <font CLASS=comment>531:</font> {
<a name="line532"/>   <font CLASS=comment>532:</font> 	assert(<font CLASS=symbols>!</font>(i &lt; VX <font CLASS=symbols>||</font> i &gt; VY));		<font CLASS=comment>// subscript check</font>
<a name="line533"/>   <font CLASS=comment>533:</font> 	<font CLASS=keyword>return</font> n[i];
<a name="line534"/>   <font CLASS=comment>534:</font> }
<a name="line535"/>   <font CLASS=comment>535:</font> 
<a name="line536"/>   <font CLASS=comment>536:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>double</font> vec2::<font CLASS=keyword>operator</font> [] ( <font CLASS=keytype>int</font> i) <font CLASS=keyword>const</font> 
<a name="line537"/>   <font CLASS=comment>537:</font> {
<a name="line538"/>   <font CLASS=comment>538:</font> 	assert(<font CLASS=symbols>!</font>(i &lt; VX <font CLASS=symbols>||</font> i &gt; VY));
<a name="line539"/>   <font CLASS=comment>539:</font> 	<font CLASS=keyword>return</font> n[i];
<a name="line540"/>   <font CLASS=comment>540:</font> }
<a name="line541"/>   <font CLASS=comment>541:</font> 
<a name="line542"/>   <font CLASS=comment>542:</font> 
<a name="line543"/>   <font CLASS=comment>543:</font> <font CLASS=comment>// SPECIAL FUNCTIONS</font>
<a name="line544"/>   <font CLASS=comment>544:</font> 
<a name="line545"/>   <font CLASS=comment>545:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>double</font> vec2::length() <font CLASS=keyword>const</font>
<a name="line546"/>   <font CLASS=comment>546:</font> { 
<a name="line547"/>   <font CLASS=comment>547:</font> 	<font CLASS=keyword>return</font> sqrt(length2());
<a name="line548"/>   <font CLASS=comment>548:</font> }
<a name="line549"/>   <font CLASS=comment>549:</font> 
<a name="line550"/>   <font CLASS=comment>550:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>double</font> vec2::length2() <font CLASS=keyword>const</font>
<a name="line551"/>   <font CLASS=comment>551:</font> { 
<a name="line552"/>   <font CLASS=comment>552:</font> 	<font CLASS=keyword>return</font> n[VX]*n[VX] <font CLASS=symbols>+</font> n[VY]*n[VY]; 
<a name="line553"/>   <font CLASS=comment>553:</font> }
<a name="line554"/>   <font CLASS=comment>554:</font> 
<a name="line555"/>   <font CLASS=comment>555:</font> <font CLASS=keyword>inline</font> vec2&amp; vec2::normalize() <font CLASS=comment>// it is up to caller to avoid divide-by-zero</font>
<a name="line556"/>   <font CLASS=comment>556:</font> { 
<a name="line557"/>   <font CLASS=comment>557:</font> 	<font CLASS=keytype>double</font> len <font CLASS=symbols>=</font> length();
<a name="line558"/>   <font CLASS=comment>558:</font> 	<font CLASS=keyword>if</font> (len &gt; <font CLASS=floatpt>0.000001</font>) *<font CLASS=keyword>this</font> /<font CLASS=symbols>=</font> len; 
<a name="line559"/>   <font CLASS=comment>559:</font> 	<font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>; 
<a name="line560"/>   <font CLASS=comment>560:</font> }
<a name="line561"/>   <font CLASS=comment>561:</font> 
<a name="line562"/>   <font CLASS=comment>562:</font> <font CLASS=keyword>inline</font> vec2&amp; vec2::apply(V_FCT_PTR fct)
<a name="line563"/>   <font CLASS=comment>563:</font> { 
<a name="line564"/>   <font CLASS=comment>564:</font> 	n[VX] <font CLASS=symbols>=</font> (*fct)(n[VX]); n[VY] <font CLASS=symbols>=</font> (*fct)(n[VY]); <font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>; 
<a name="line565"/>   <font CLASS=comment>565:</font> }
<a name="line566"/>   <font CLASS=comment>566:</font> 
<a name="line567"/>   <font CLASS=comment>567:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>void</font> vec2::set( <font CLASS=keytype>float</font> x, <font CLASS=keytype>float</font> y )
<a name="line568"/>   <font CLASS=comment>568:</font> { 
<a name="line569"/>   <font CLASS=comment>569:</font> 	n[VX] <font CLASS=symbols>=</font> x;   n[VY] <font CLASS=symbols>=</font> y;
<a name="line570"/>   <font CLASS=comment>570:</font> }
<a name="line571"/>   <font CLASS=comment>571:</font> 
<a name="line572"/>   <font CLASS=comment>572:</font> 
<a name="line573"/>   <font CLASS=comment>573:</font> <font CLASS=comment>// FRIENDS</font>
<a name="line574"/>   <font CLASS=comment>574:</font> 
<a name="line575"/>   <font CLASS=comment>575:</font> <font CLASS=keyword>inline</font> vec2 <font CLASS=keyword>operator</font> <font CLASS=symbols>-</font> (<font CLASS=keyword>const</font> vec2&amp; a)
<a name="line576"/>   <font CLASS=comment>576:</font> { 
<a name="line577"/>   <font CLASS=comment>577:</font> 	<font CLASS=keyword>return</font> vec2(-a.n[VX],-a.n[VY]); 
<a name="line578"/>   <font CLASS=comment>578:</font> }
<a name="line579"/>   <font CLASS=comment>579:</font> 
<a name="line580"/>   <font CLASS=comment>580:</font> <font CLASS=keyword>inline</font> vec2 <font CLASS=keyword>operator</font> <font CLASS=symbols>+</font> (<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> vec2&amp; b)
<a name="line581"/>   <font CLASS=comment>581:</font> { 
<a name="line582"/>   <font CLASS=comment>582:</font> 	<font CLASS=keyword>return</font> vec2(a.n[VX]<font CLASS=symbols>+</font> b.n[VX], a.n[VY] <font CLASS=symbols>+</font> b.n[VY]); 
<a name="line583"/>   <font CLASS=comment>583:</font> }
<a name="line584"/>   <font CLASS=comment>584:</font> 
<a name="line585"/>   <font CLASS=comment>585:</font> <font CLASS=keyword>inline</font> vec2 <font CLASS=keyword>operator</font> <font CLASS=symbols>-</font> (<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> vec2&amp; b)
<a name="line586"/>   <font CLASS=comment>586:</font> { 
<a name="line587"/>   <font CLASS=comment>587:</font> 	<font CLASS=keyword>return</font> vec2(a.n[VX]-b.n[VX], a.n[VY]-b.n[VY]); 
<a name="line588"/>   <font CLASS=comment>588:</font> }
<a name="line589"/>   <font CLASS=comment>589:</font> 
<a name="line590"/>   <font CLASS=comment>590:</font> <font CLASS=keyword>inline</font> vec2 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d)
<a name="line591"/>   <font CLASS=comment>591:</font> { 
<a name="line592"/>   <font CLASS=comment>592:</font> 	<font CLASS=keyword>return</font> vec2(d*a.n[VX], d*a.n[VY]);
<a name="line593"/>   <font CLASS=comment>593:</font> }
<a name="line594"/>   <font CLASS=comment>594:</font> 
<a name="line595"/>   <font CLASS=comment>595:</font> <font CLASS=keyword>inline</font> vec2 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d, <font CLASS=keyword>const</font> vec2&amp; a)
<a name="line596"/>   <font CLASS=comment>596:</font> { 
<a name="line597"/>   <font CLASS=comment>597:</font> 	<font CLASS=keyword>return</font> a*d; 
<a name="line598"/>   <font CLASS=comment>598:</font> }
<a name="line599"/>   <font CLASS=comment>599:</font> 
<a name="line600"/>   <font CLASS=comment>600:</font> <font CLASS=keyword>inline</font> vec2 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> vec2&amp; v) 
<a name="line601"/>   <font CLASS=comment>601:</font> {
<a name="line602"/>   <font CLASS=comment>602:</font> 	vec3 av;
<a name="line603"/>   <font CLASS=comment>603:</font> 
<a name="line604"/>   <font CLASS=comment>604:</font> 	av.n[VX] <font CLASS=symbols>=</font> a.v[<font CLASS=integer>0</font>].n[VX]*v.n[VX] <font CLASS=symbols>+</font> a.v[<font CLASS=integer>0</font>].n[VY]*v.n[VY] + a.v[<font CLASS=integer>0</font>].n[VZ];
<a name="line605"/>   <font CLASS=comment>605:</font> 	av.n[VY] <font CLASS=symbols>=</font> a.v[<font CLASS=integer>1</font>].n[VX]*v.n[VX] <font CLASS=symbols>+</font> a.v[<font CLASS=integer>1</font>].n[VY]*v.n[VY] + a.v[<font CLASS=integer>1</font>].n[VZ];
<a name="line606"/>   <font CLASS=comment>606:</font> 	av.n[VZ] <font CLASS=symbols>=</font> a.v[<font CLASS=integer>2</font>].n[VX]*v.n[VX] <font CLASS=symbols>+</font> a.v[<font CLASS=integer>2</font>].n[VY]*v.n[VY] + a.v[<font CLASS=integer>2</font>].n[VZ];
<a name="line607"/>   <font CLASS=comment>607:</font> 	<font CLASS=keyword>return</font> av;
<a name="line608"/>   <font CLASS=comment>608:</font> }
<a name="line609"/>   <font CLASS=comment>609:</font> 
<a name="line610"/>   <font CLASS=comment>610:</font> <font CLASS=keyword>inline</font> vec2 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> vec2&amp; v, <font CLASS=keyword>const</font> mat3&amp; a)
<a name="line611"/>   <font CLASS=comment>611:</font> { 
<a name="line612"/>   <font CLASS=comment>612:</font> 	<font CLASS=keyword>return</font> a.transpose() * v; 
<a name="line613"/>   <font CLASS=comment>613:</font> }
<a name="line614"/>   <font CLASS=comment>614:</font> 
<a name="line615"/>   <font CLASS=comment>615:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>double</font> <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> vec2&amp; b)
<a name="line616"/>   <font CLASS=comment>616:</font> { 
<a name="line617"/>   <font CLASS=comment>617:</font> 	<font CLASS=keyword>return</font> (a.n[VX]*b.n[VX] <font CLASS=symbols>+</font> a.n[VY]*b.n[VY]); 
<a name="line618"/>   <font CLASS=comment>618:</font> }
<a name="line619"/>   <font CLASS=comment>619:</font> 
<a name="line620"/>   <font CLASS=comment>620:</font> <font CLASS=keyword>inline</font> vec2 <font CLASS=keyword>operator</font> / (<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d)
<a name="line621"/>   <font CLASS=comment>621:</font> { 
<a name="line622"/>   <font CLASS=comment>622:</font> 	<font CLASS=keytype>double</font> d_inv <font CLASS=symbols>=</font> <font CLASS=integer>1</font>./d; <font CLASS=keyword>return</font> vec2(a.n[VX]*d_inv, a.n[VY]*d_inv); 
<a name="line623"/>   <font CLASS=comment>623:</font> }
<a name="line624"/>   <font CLASS=comment>624:</font> 
<a name="line625"/>   <font CLASS=comment>625:</font> <font CLASS=keyword>inline</font> vec3 <font CLASS=keyword>operator</font> ^ (<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> vec2&amp; b)
<a name="line626"/>   <font CLASS=comment>626:</font> { 
<a name="line627"/>   <font CLASS=comment>627:</font> 	<font CLASS=keyword>return</font> vec3(<font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, a.n[VX] * b.n[VY] <font CLASS=symbols>-</font> b.n[VX] * a.n[VY]); 
<a name="line628"/>   <font CLASS=comment>628:</font> }
<a name="line629"/>   <font CLASS=comment>629:</font> 
<a name="line630"/>   <font CLASS=comment>630:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>int</font> <font CLASS=keyword>operator</font> <font CLASS=symbols>==</font> (<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> vec2&amp; b)
<a name="line631"/>   <font CLASS=comment>631:</font> { 
<a name="line632"/>   <font CLASS=comment>632:</font> 	<font CLASS=keyword>return</font> (a.n[VX] <font CLASS=symbols>==</font> b.n[VX]) &amp;&amp; (a.n[VY] <font CLASS=symbols>==</font> b.n[VY]); 
<a name="line633"/>   <font CLASS=comment>633:</font> }
<a name="line634"/>   <font CLASS=comment>634:</font> 
<a name="line635"/>   <font CLASS=comment>635:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>int</font> <font CLASS=keyword>operator</font> <font CLASS=symbols>!=</font> (<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> vec2&amp; b)
<a name="line636"/>   <font CLASS=comment>636:</font> { 
<a name="line637"/>   <font CLASS=comment>637:</font> 	<font CLASS=keyword>return</font> <font CLASS=symbols>!</font>(a <font CLASS=symbols>==</font> b);
<a name="line638"/>   <font CLASS=comment>638:</font> }
<a name="line639"/>   <font CLASS=comment>639:</font> 
<a name="line640"/>   <font CLASS=comment>640:</font> <font CLASS=preproc>#ifdef</font> ALGEBRA3IOSTREAMS 
<a name="line641"/>   <font CLASS=comment>641:</font> <font CLASS=keyword>inline</font> ostream&amp; <font CLASS=keyword>operator</font> &lt;&lt; (ostream&amp; s, <font CLASS=keyword>const</font> vec2&amp; v)
<a name="line642"/>   <font CLASS=comment>642:</font> { 
<a name="line643"/>   <font CLASS=comment>643:</font> 	<font CLASS=keyword>return</font> s &lt;&lt; <font CLASS=dblquot>"| "</font> &lt;&lt; v.n[VX] &lt;&lt; <font CLASS=sinquot>' '</font> &lt;&lt; v.n[VY] &lt;&lt; <font CLASS=dblquot>" |"</font>; 
<a name="line644"/>   <font CLASS=comment>644:</font> }
<a name="line645"/>   <font CLASS=comment>645:</font> <font CLASS=keyword>inline</font> istream&amp; <font CLASS=keyword>operator</font> &gt;&gt; (istream&amp; s, vec2&amp; v) 
<a name="line646"/>   <font CLASS=comment>646:</font> {
<a name="line647"/>   <font CLASS=comment>647:</font> 	vec2	v_tmp;
<a name="line648"/>   <font CLASS=comment>648:</font> 	<font CLASS=keytype>char</font>	c <font CLASS=symbols>=</font> <font CLASS=sinquot>' '</font>;
<a name="line649"/>   <font CLASS=comment>649:</font> 
<a name="line650"/>   <font CLASS=comment>650:</font> 	<font CLASS=keyword>while</font> (isspace(c))
<a name="line651"/>   <font CLASS=comment>651:</font> 		s &gt;&gt; c;
<a name="line652"/>   <font CLASS=comment>652:</font> 	<font CLASS=comment>// The vectors can be formatted either as x y or | x y |</font>
<a name="line653"/>   <font CLASS=comment>653:</font> 	<font CLASS=keyword>if</font> (c <font CLASS=symbols>==</font> <font CLASS=sinquot>'|'</font>) {
<a name="line654"/>   <font CLASS=comment>654:</font> 		s &gt;&gt; v_tmp[VX] &gt;&gt; v_tmp[VY];
<a name="line655"/>   <font CLASS=comment>655:</font> 		<font CLASS=keyword>while</font> (s &gt;&gt; c &amp;&amp; isspace(c)) ;
<a name="line656"/>   <font CLASS=comment>656:</font> 		<font CLASS=keyword>if</font> (c <font CLASS=symbols>!=</font> <font CLASS=sinquot>'|'</font>)
<a name="line657"/>   <font CLASS=comment>657:</font> 			s.setstate(ios::badbit);
<a name="line658"/>   <font CLASS=comment>658:</font> 	}
<a name="line659"/>   <font CLASS=comment>659:</font> 	<font CLASS=keyword>else</font> {
<a name="line660"/>   <font CLASS=comment>660:</font> 		s.putback(c);
<a name="line661"/>   <font CLASS=comment>661:</font> 		s &gt;&gt; v_tmp[VX] &gt;&gt; v_tmp[VY];
<a name="line662"/>   <font CLASS=comment>662:</font> 	}
<a name="line663"/>   <font CLASS=comment>663:</font> 	<font CLASS=keyword>if</font> (s)
<a name="line664"/>   <font CLASS=comment>664:</font> 		v <font CLASS=symbols>=</font> v_tmp;
<a name="line665"/>   <font CLASS=comment>665:</font> 	<font CLASS=keyword>return</font> s;
<a name="line666"/>   <font CLASS=comment>666:</font> }
<a name="line667"/>   <font CLASS=comment>667:</font> <font CLASS=preproc>#endif</font> <font CLASS=comment>// ALGEBRA3IOSTREAMS </font>
<a name="line668"/>   <font CLASS=comment>668:</font> 
<a name="line669"/>   <font CLASS=comment>669:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>void</font> swap(vec2&amp; a, vec2&amp; b)
<a name="line670"/>   <font CLASS=comment>670:</font> { 
<a name="line671"/>   <font CLASS=comment>671:</font> 	vec2 tmp(a); a <font CLASS=symbols>=</font> b; b <font CLASS=symbols>=</font> tmp; 
<a name="line672"/>   <font CLASS=comment>672:</font> }
<a name="line673"/>   <font CLASS=comment>673:</font> 
<a name="line674"/>   <font CLASS=comment>674:</font> <font CLASS=keyword>inline</font> vec2 min(<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> vec2&amp; b)
<a name="line675"/>   <font CLASS=comment>675:</font> { 
<a name="line676"/>   <font CLASS=comment>676:</font> 	<font CLASS=keyword>return</font> vec2(MIN(a.n[VX], b.n[VX]), MIN(a.n[VY], b.n[VY])); 
<a name="line677"/>   <font CLASS=comment>677:</font> }
<a name="line678"/>   <font CLASS=comment>678:</font> 
<a name="line679"/>   <font CLASS=comment>679:</font> <font CLASS=keyword>inline</font> vec2 max(<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> vec2&amp; b)
<a name="line680"/>   <font CLASS=comment>680:</font> { 
<a name="line681"/>   <font CLASS=comment>681:</font> 	<font CLASS=keyword>return</font> vec2(MAX(a.n[VX], b.n[VX]), MAX(a.n[VY], b.n[VY]));
<a name="line682"/>   <font CLASS=comment>682:</font> }
<a name="line683"/>   <font CLASS=comment>683:</font> 
<a name="line684"/>   <font CLASS=comment>684:</font> <font CLASS=keyword>inline</font> vec2 prod(<font CLASS=keyword>const</font> vec2&amp; a, <font CLASS=keyword>const</font> vec2&amp; b)
<a name="line685"/>   <font CLASS=comment>685:</font> {
<a name="line686"/>   <font CLASS=comment>686:</font> 	<font CLASS=keyword>return</font> vec2(a.n[VX] * b.n[VX], a.n[VY] * b.n[VY]); 
<a name="line687"/>   <font CLASS=comment>687:</font> }
<a name="line688"/>   <font CLASS=comment>688:</font> 
<a name="line689"/>   <font CLASS=comment>689:</font> <font CLASS=keyword>inline</font> vec2 floor(<font CLASS=keyword>const</font> vec2&amp; v)
<a name="line690"/>   <font CLASS=comment>690:</font> { 
<a name="line691"/>   <font CLASS=comment>691:</font> 	<font CLASS=keyword>return</font> vec2(floor(v.n[VX]), floor(v.n[VY]));
<a name="line692"/>   <font CLASS=comment>692:</font> }
<a name="line693"/>   <font CLASS=comment>693:</font> 
<a name="line694"/>   <font CLASS=comment>694:</font> <font CLASS=keyword>inline</font> vec2 ceil(<font CLASS=keyword>const</font> vec2&amp; v)
<a name="line695"/>   <font CLASS=comment>695:</font> { 
<a name="line696"/>   <font CLASS=comment>696:</font> 	<font CLASS=keyword>return</font> vec2(ceil(v.n[VX]), ceil(v.n[VY]));
<a name="line697"/>   <font CLASS=comment>697:</font> }
<a name="line698"/>   <font CLASS=comment>698:</font> 
<a name="line699"/>   <font CLASS=comment>699:</font> <font CLASS=comment>/****************************************************************
<a name="line700"/>   <font CLASS=comment>700:</font> *																*
<a name="line701"/>   <font CLASS=comment>701:</font> *		    vec3 Member functions								*
<a name="line702"/>   <font CLASS=comment>702:</font> *																*
<a name="line703"/>   <font CLASS=comment>703:</font> ****************************************************************/</font>
<a name="line704"/>   <font CLASS=comment>704:</font> 
<a name="line705"/>   <font CLASS=comment>705:</font> <font CLASS=comment>// CONSTRUCTORS</font>
<a name="line706"/>   <font CLASS=comment>706:</font> 
<a name="line707"/>   <font CLASS=comment>707:</font> <font CLASS=keyword>inline</font> vec3::vec3() {}
<a name="line708"/>   <font CLASS=comment>708:</font> 
<a name="line709"/>   <font CLASS=comment>709:</font> <font CLASS=keyword>inline</font> vec3::vec3(<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> x, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> y, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> z)
<a name="line710"/>   <font CLASS=comment>710:</font> {
<a name="line711"/>   <font CLASS=comment>711:</font> 	n[VX] <font CLASS=symbols>=</font> x; n[VY] <font CLASS=symbols>=</font> y; n[VZ] = z;
<a name="line712"/>   <font CLASS=comment>712:</font> }
<a name="line713"/>   <font CLASS=comment>713:</font> 
<a name="line714"/>   <font CLASS=comment>714:</font> <font CLASS=keyword>inline</font> vec3::vec3(<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d)
<a name="line715"/>   <font CLASS=comment>715:</font> { 
<a name="line716"/>   <font CLASS=comment>716:</font> 	n[VX] <font CLASS=symbols>=</font> n[VY] <font CLASS=symbols>=</font> n[VZ] = d;
<a name="line717"/>   <font CLASS=comment>717:</font> }
<a name="line718"/>   <font CLASS=comment>718:</font> 
<a name="line719"/>   <font CLASS=comment>719:</font> <font CLASS=keyword>inline</font> vec3::vec3(<font CLASS=keyword>const</font> vec3&amp; v)
<a name="line720"/>   <font CLASS=comment>720:</font> { 
<a name="line721"/>   <font CLASS=comment>721:</font> 	n[VX] <font CLASS=symbols>=</font> v.n[VX]; n[VY] <font CLASS=symbols>=</font> v.n[VY]; n[VZ] = v.n[VZ]; 
<a name="line722"/>   <font CLASS=comment>722:</font> }
<a name="line723"/>   <font CLASS=comment>723:</font> 
<a name="line724"/>   <font CLASS=comment>724:</font> <font CLASS=keyword>inline</font> vec3::vec3(<font CLASS=keyword>const</font> vec2&amp; v)
<a name="line725"/>   <font CLASS=comment>725:</font> {
<a name="line726"/>   <font CLASS=comment>726:</font> 	n[VX] <font CLASS=symbols>=</font> v.n[VX]; n[VY] <font CLASS=symbols>=</font> v.n[VY]; n[VZ] = <font CLASS=floatpt>1.0</font>; 
<a name="line727"/>   <font CLASS=comment>727:</font> }
<a name="line728"/>   <font CLASS=comment>728:</font> 
<a name="line729"/>   <font CLASS=comment>729:</font> <font CLASS=keyword>inline</font> vec3::vec3(<font CLASS=keyword>const</font> vec2&amp; v, <font CLASS=keytype>double</font> d)
<a name="line730"/>   <font CLASS=comment>730:</font> { 
<a name="line731"/>   <font CLASS=comment>731:</font> 	n[VX] <font CLASS=symbols>=</font> v.n[VX]; n[VY] <font CLASS=symbols>=</font> v.n[VY]; n[VZ] = d; 
<a name="line732"/>   <font CLASS=comment>732:</font> }
<a name="line733"/>   <font CLASS=comment>733:</font> 
<a name="line734"/>   <font CLASS=comment>734:</font> <font CLASS=keyword>inline</font> vec3::vec3(<font CLASS=keyword>const</font> vec4&amp; v) <font CLASS=comment>// it is up to caller to avoid divide-by-zero</font>
<a name="line735"/>   <font CLASS=comment>735:</font> { 
<a name="line736"/>   <font CLASS=comment>736:</font> 	n[VX] <font CLASS=symbols>=</font> v.n[VX] / v.n[VW]; n[VY] <font CLASS=symbols>=</font> v.n[VY] / v.n[VW];
<a name="line737"/>   <font CLASS=comment>737:</font> 	n[VZ] <font CLASS=symbols>=</font> v.n[VZ] / v.n[VW]; 
<a name="line738"/>   <font CLASS=comment>738:</font> }
<a name="line739"/>   <font CLASS=comment>739:</font> 
<a name="line740"/>   <font CLASS=comment>740:</font> <font CLASS=keyword>inline</font> vec3::vec3(<font CLASS=keyword>const</font> vec4&amp; v, <font CLASS=keytype>int</font> dropAxis) 
<a name="line741"/>   <font CLASS=comment>741:</font> {
<a name="line742"/>   <font CLASS=comment>742:</font> 	<font CLASS=keyword>switch</font> (dropAxis) {
<a name="line743"/>   <font CLASS=comment>743:</font> 	<font CLASS=keyword>case</font> VX: n[VX] <font CLASS=symbols>=</font> v.n[VY]; n[VY] <font CLASS=symbols>=</font> v.n[VZ]; n[VZ] = v.n[VW]; <font CLASS=keyword>break</font>;
<a name="line744"/>   <font CLASS=comment>744:</font> 	<font CLASS=keyword>case</font> VY: n[VX] <font CLASS=symbols>=</font> v.n[VX]; n[VY] <font CLASS=symbols>=</font> v.n[VZ]; n[VZ] = v.n[VW]; <font CLASS=keyword>break</font>;
<a name="line745"/>   <font CLASS=comment>745:</font> 	<font CLASS=keyword>case</font> VZ: n[VX] <font CLASS=symbols>=</font> v.n[VX]; n[VY] <font CLASS=symbols>=</font> v.n[VY]; n[VZ] = v.n[VW]; <font CLASS=keyword>break</font>;
<a name="line746"/>   <font CLASS=comment>746:</font> 	<font CLASS=keyword>default</font>: n[VX] <font CLASS=symbols>=</font> v.n[VX]; n[VY] <font CLASS=symbols>=</font> v.n[VY]; n[VZ] = v.n[VZ]; <font CLASS=keyword>break</font>;
<a name="line747"/>   <font CLASS=comment>747:</font> 	}
<a name="line748"/>   <font CLASS=comment>748:</font> }
<a name="line749"/>   <font CLASS=comment>749:</font> 
<a name="line750"/>   <font CLASS=comment>750:</font> 
<a name="line751"/>   <font CLASS=comment>751:</font> <font CLASS=comment>// ASSIGNMENT OPERATORS</font>
<a name="line752"/>   <font CLASS=comment>752:</font> 
<a name="line753"/>   <font CLASS=comment>753:</font> <font CLASS=keyword>inline</font> vec3&amp; vec3::<font CLASS=keyword>operator</font> <font CLASS=symbols>=</font> (<font CLASS=keyword>const</font> vec3&amp; v)
<a name="line754"/>   <font CLASS=comment>754:</font> { 
<a name="line755"/>   <font CLASS=comment>755:</font> 	n[VX] <font CLASS=symbols>=</font> v.n[VX]; n[VY] <font CLASS=symbols>=</font> v.n[VY]; n[VZ] = v.n[VZ]; <font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>; 
<a name="line756"/>   <font CLASS=comment>756:</font> }
<a name="line757"/>   <font CLASS=comment>757:</font> 
<a name="line758"/>   <font CLASS=comment>758:</font> <font CLASS=keyword>inline</font> vec3&amp; vec3::<font CLASS=keyword>operator</font> <font CLASS=symbols>+=</font> ( <font CLASS=keyword>const</font> vec3&amp; v )
<a name="line759"/>   <font CLASS=comment>759:</font> {
<a name="line760"/>   <font CLASS=comment>760:</font> 	n[VX] <font CLASS=symbols>+=</font> v.n[VX]; n[VY] <font CLASS=symbols>+=</font> v.n[VY]; n[VZ] += v.n[VZ]; <font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>; 
<a name="line761"/>   <font CLASS=comment>761:</font> }
<a name="line762"/>   <font CLASS=comment>762:</font> 
<a name="line763"/>   <font CLASS=comment>763:</font> <font CLASS=keyword>inline</font> vec3&amp; vec3::<font CLASS=keyword>operator</font> <font CLASS=symbols>-=</font> ( <font CLASS=keyword>const</font> vec3&amp; v )
<a name="line764"/>   <font CLASS=comment>764:</font> { 
<a name="line765"/>   <font CLASS=comment>765:</font> 	n[VX] <font CLASS=symbols>-=</font> v.n[VX]; n[VY] <font CLASS=symbols>-=</font> v.n[VY]; n[VZ] -= v.n[VZ]; <font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>; 
<a name="line766"/>   <font CLASS=comment>766:</font> }
<a name="line767"/>   <font CLASS=comment>767:</font> 
<a name="line768"/>   <font CLASS=comment>768:</font> <font CLASS=keyword>inline</font> vec3&amp; vec3::<font CLASS=keyword>operator</font> *<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d )
<a name="line769"/>   <font CLASS=comment>769:</font> { 
<a name="line770"/>   <font CLASS=comment>770:</font> 	n[VX] *<font CLASS=symbols>=</font> d; n[VY] *<font CLASS=symbols>=</font> d; n[VZ] *= d; <font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>; 
<a name="line771"/>   <font CLASS=comment>771:</font> }
<a name="line772"/>   <font CLASS=comment>772:</font> 
<a name="line773"/>   <font CLASS=comment>773:</font> <font CLASS=keyword>inline</font> vec3&amp; vec3::<font CLASS=keyword>operator</font> /<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d )
<a name="line774"/>   <font CLASS=comment>774:</font> { 
<a name="line775"/>   <font CLASS=comment>775:</font> 	<font CLASS=keytype>double</font> d_inv <font CLASS=symbols>=</font> <font CLASS=integer>1</font>./d; n[VX] *<font CLASS=symbols>=</font> d_inv; n[VY] *= d_inv; n[VZ] *<font CLASS=symbols>=</font> d_inv; <font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>; 
<a name="line776"/>   <font CLASS=comment>776:</font> }
<a name="line777"/>   <font CLASS=comment>777:</font> 
<a name="line778"/>   <font CLASS=comment>778:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>double</font>&amp; vec3::<font CLASS=keyword>operator</font> [] ( <font CLASS=keytype>int</font> i) 
<a name="line779"/>   <font CLASS=comment>779:</font> {
<a name="line780"/>   <font CLASS=comment>780:</font> 	assert(<font CLASS=symbols>!</font> (i &lt; VX <font CLASS=symbols>||</font> i &gt; VZ));
<a name="line781"/>   <font CLASS=comment>781:</font> 	<font CLASS=keyword>return</font> n[i];
<a name="line782"/>   <font CLASS=comment>782:</font> }
<a name="line783"/>   <font CLASS=comment>783:</font> 
<a name="line784"/>   <font CLASS=comment>784:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>double</font> vec3::<font CLASS=keyword>operator</font> [] ( <font CLASS=keytype>int</font> i) <font CLASS=keyword>const</font> 
<a name="line785"/>   <font CLASS=comment>785:</font> {
<a name="line786"/>   <font CLASS=comment>786:</font> 	assert(<font CLASS=symbols>!</font> (i &lt; VX <font CLASS=symbols>||</font> i &gt; VZ));
<a name="line787"/>   <font CLASS=comment>787:</font> 	<font CLASS=keyword>return</font> n[i];
<a name="line788"/>   <font CLASS=comment>788:</font> }
<a name="line789"/>   <font CLASS=comment>789:</font> 
<a name="line790"/>   <font CLASS=comment>790:</font> 
<a name="line791"/>   <font CLASS=comment>791:</font> <font CLASS=comment>// SPECIAL FUNCTIONS</font>
<a name="line792"/>   <font CLASS=comment>792:</font> 
<a name="line793"/>   <font CLASS=comment>793:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>double</font> vec3::length() <font CLASS=keyword>const</font>
<a name="line794"/>   <font CLASS=comment>794:</font> {  
<a name="line795"/>   <font CLASS=comment>795:</font> 	<font CLASS=keyword>return</font> sqrt(length2());
<a name="line796"/>   <font CLASS=comment>796:</font> }
<a name="line797"/>   <font CLASS=comment>797:</font> 
<a name="line798"/>   <font CLASS=comment>798:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>double</font> vec3::length2() <font CLASS=keyword>const</font>
<a name="line799"/>   <font CLASS=comment>799:</font> {  
<a name="line800"/>   <font CLASS=comment>800:</font> 	<font CLASS=keyword>return</font> n[VX]*n[VX] <font CLASS=symbols>+</font> n[VY]*n[VY] <font CLASS=symbols>+</font> n[VZ]*n[VZ]; 
<a name="line801"/>   <font CLASS=comment>801:</font> }
<a name="line802"/>   <font CLASS=comment>802:</font> 
<a name="line803"/>   <font CLASS=comment>803:</font> <font CLASS=keyword>inline</font> vec3&amp; vec3::normalize() <font CLASS=comment>// it is up to caller to avoid divide-by-zero</font>
<a name="line804"/>   <font CLASS=comment>804:</font> {
<a name="line805"/>   <font CLASS=comment>805:</font> 	<font CLASS=keytype>double</font> len <font CLASS=symbols>=</font> length();
<a name="line806"/>   <font CLASS=comment>806:</font> 	<font CLASS=keyword>if</font> (len &gt; <font CLASS=floatpt>0.000001</font>) *<font CLASS=keyword>this</font> /<font CLASS=symbols>=</font> len; 
<a name="line807"/>   <font CLASS=comment>807:</font> 	<font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>; 
<a name="line808"/>   <font CLASS=comment>808:</font> }
<a name="line809"/>   <font CLASS=comment>809:</font> 
<a name="line810"/>   <font CLASS=comment>810:</font> <font CLASS=keyword>inline</font> vec3 vec3::normalized()
<a name="line811"/>   <font CLASS=comment>811:</font> {
<a name="line812"/>   <font CLASS=comment>812:</font> 	vec3 tmp <font CLASS=symbols>=</font> *<font CLASS=keyword>this</font>;
<a name="line813"/>   <font CLASS=comment>813:</font> 	tmp.normalize();
<a name="line814"/>   <font CLASS=comment>814:</font> 	<font CLASS=keyword>return</font> tmp;
<a name="line815"/>   <font CLASS=comment>815:</font> }
<a name="line816"/>   <font CLASS=comment>816:</font> 
<a name="line817"/>   <font CLASS=comment>817:</font> <font CLASS=keyword>inline</font> vec3 vec3::cross(vec3 &amp;v) <font CLASS=keyword>const</font>
<a name="line818"/>   <font CLASS=comment>818:</font> {
<a name="line819"/>   <font CLASS=comment>819:</font> 	vec3 tmp;
<a name="line820"/>   <font CLASS=comment>820:</font> 	tmp[<font CLASS=integer>0</font>] <font CLASS=symbols>=</font> n[<font CLASS=integer>1</font>] * v.n[<font CLASS=integer>2</font>] <font CLASS=symbols>-</font> n[<font CLASS=integer>2</font>] * v.n[<font CLASS=integer>1</font>];
<a name="line821"/>   <font CLASS=comment>821:</font> 	tmp[<font CLASS=integer>1</font>] <font CLASS=symbols>=</font> n[<font CLASS=integer>2</font>] * v.n[<font CLASS=integer>0</font>] <font CLASS=symbols>-</font> n[<font CLASS=integer>0</font>] * v.n[<font CLASS=integer>2</font>];
<a name="line822"/>   <font CLASS=comment>822:</font> 	tmp[<font CLASS=integer>2</font>] <font CLASS=symbols>=</font> n[<font CLASS=integer>0</font>] * v.n[<font CLASS=integer>1</font>] <font CLASS=symbols>-</font> n[<font CLASS=integer>1</font>] * v.n[<font CLASS=integer>0</font>];
<a name="line823"/>   <font CLASS=comment>823:</font> 	<font CLASS=keyword>return</font> tmp;
<a name="line824"/>   <font CLASS=comment>824:</font> }
<a name="line825"/>   <font CLASS=comment>825:</font> 
<a name="line826"/>   <font CLASS=comment>826:</font> <font CLASS=keyword>inline</font> vec3&amp; vec3::apply(V_FCT_PTR fct)
<a name="line827"/>   <font CLASS=comment>827:</font> {
<a name="line828"/>   <font CLASS=comment>828:</font> 	n[VX] <font CLASS=symbols>=</font> (*fct)(n[VX]); n[VY] <font CLASS=symbols>=</font> (*fct)(n[VY]); n[VZ] = (*fct)(n[VZ]);
<a name="line829"/>   <font CLASS=comment>829:</font> 	<font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>; 
<a name="line830"/>   <font CLASS=comment>830:</font> }
<a name="line831"/>   <font CLASS=comment>831:</font> 
<a name="line832"/>   <font CLASS=comment>832:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>void</font>  vec3::set( <font CLASS=keytype>float</font> x, <font CLASS=keytype>float</font> y, <font CLASS=keytype>float</font> z )
<a name="line833"/>   <font CLASS=comment>833:</font> {
<a name="line834"/>   <font CLASS=comment>834:</font> 	n[VX] <font CLASS=symbols>=</font> x; n[VY] <font CLASS=symbols>=</font> y; n[VZ] = z;  
<a name="line835"/>   <font CLASS=comment>835:</font> }
<a name="line836"/>   <font CLASS=comment>836:</font> 
<a name="line837"/>   <font CLASS=comment>837:</font> 
<a name="line838"/>   <font CLASS=comment>838:</font> <font CLASS=comment>// FRIENDS</font>
<a name="line839"/>   <font CLASS=comment>839:</font> 
<a name="line840"/>   <font CLASS=comment>840:</font> <font CLASS=keyword>inline</font> vec3 <font CLASS=keyword>operator</font> <font CLASS=symbols>-</font> (<font CLASS=keyword>const</font> vec3&amp; a)
<a name="line841"/>   <font CLASS=comment>841:</font> { 
<a name="line842"/>   <font CLASS=comment>842:</font> 	<font CLASS=keyword>return</font> vec3(-a.n[VX],-a.n[VY],-a.n[VZ]); 
<a name="line843"/>   <font CLASS=comment>843:</font> }
<a name="line844"/>   <font CLASS=comment>844:</font> 
<a name="line845"/>   <font CLASS=comment>845:</font> <font CLASS=keyword>inline</font> vec3 <font CLASS=keyword>operator</font> <font CLASS=symbols>+</font> (<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> vec3&amp; b)
<a name="line846"/>   <font CLASS=comment>846:</font> {
<a name="line847"/>   <font CLASS=comment>847:</font> 	<font CLASS=keyword>return</font> vec3(a.n[VX]<font CLASS=symbols>+</font> b.n[VX], a.n[VY] <font CLASS=symbols>+</font> b.n[VY], a.n[VZ] + b.n[VZ]); 
<a name="line848"/>   <font CLASS=comment>848:</font> }
<a name="line849"/>   <font CLASS=comment>849:</font> 
<a name="line850"/>   <font CLASS=comment>850:</font> <font CLASS=keyword>inline</font> vec3 <font CLASS=keyword>operator</font> <font CLASS=symbols>-</font> (<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> vec3&amp; b)
<a name="line851"/>   <font CLASS=comment>851:</font> { 
<a name="line852"/>   <font CLASS=comment>852:</font> 	<font CLASS=keyword>return</font> vec3(a.n[VX]-b.n[VX], a.n[VY]-b.n[VY], a.n[VZ]-b.n[VZ]); 
<a name="line853"/>   <font CLASS=comment>853:</font> }
<a name="line854"/>   <font CLASS=comment>854:</font> 
<a name="line855"/>   <font CLASS=comment>855:</font> <font CLASS=keyword>inline</font> vec3 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d)
<a name="line856"/>   <font CLASS=comment>856:</font> { 
<a name="line857"/>   <font CLASS=comment>857:</font> 	<font CLASS=keyword>return</font> vec3(d*a.n[VX], d*a.n[VY], d*a.n[VZ]); 
<a name="line858"/>   <font CLASS=comment>858:</font> }
<a name="line859"/>   <font CLASS=comment>859:</font> 
<a name="line860"/>   <font CLASS=comment>860:</font> <font CLASS=keyword>inline</font> vec3 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d, <font CLASS=keyword>const</font> vec3&amp; a)
<a name="line861"/>   <font CLASS=comment>861:</font> { 
<a name="line862"/>   <font CLASS=comment>862:</font> 	<font CLASS=keyword>return</font> a*d; 
<a name="line863"/>   <font CLASS=comment>863:</font> }
<a name="line864"/>   <font CLASS=comment>864:</font> 
<a name="line865"/>   <font CLASS=comment>865:</font> <font CLASS=keyword>inline</font> vec3 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> vec3&amp; v) 
<a name="line866"/>   <font CLASS=comment>866:</font> {
<a name="line867"/>   <font CLASS=comment>867:</font> <font CLASS=preproc>#define</font> ROWCOL(i) a.v[i].n[<font CLASS=integer>0</font>]*v.n[VX] <font CLASS=symbols>+</font> a.v[i].n[<font CLASS=integer>1</font>]*v.n[VY] \ 
<a name="line868"/>   <font CLASS=comment>868:</font> 				<font CLASS=symbols>+</font> a.v[i].n[<font CLASS=integer>2</font>]*v.n[VZ]
<a name="line869"/>   <font CLASS=comment>869:</font> 				<font CLASS=keyword>return</font> vec3(ROWCOL(<font CLASS=integer>0</font>), ROWCOL(<font CLASS=integer>1</font>), ROWCOL(<font CLASS=integer>2</font>));
<a name="line870"/>   <font CLASS=comment>870:</font> <font CLASS=preproc>#undef</font> ROWCOL <font CLASS=comment>// (i) </font>
<a name="line871"/>   <font CLASS=comment>871:</font> }
<a name="line872"/>   <font CLASS=comment>872:</font> 
<a name="line873"/>   <font CLASS=comment>873:</font> <font CLASS=keyword>inline</font> vec3 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> vec3&amp; v)
<a name="line874"/>   <font CLASS=comment>874:</font> { 
<a name="line875"/>   <font CLASS=comment>875:</font> 	<font CLASS=keyword>return</font> a * vec4(v); 
<a name="line876"/>   <font CLASS=comment>876:</font> }
<a name="line877"/>   <font CLASS=comment>877:</font> 
<a name="line878"/>   <font CLASS=comment>878:</font> <font CLASS=keyword>inline</font> vec3 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> vec3&amp; v, <font CLASS=keyword>const</font> mat4&amp; a)
<a name="line879"/>   <font CLASS=comment>879:</font> { 
<a name="line880"/>   <font CLASS=comment>880:</font> 	<font CLASS=keyword>return</font> a.transpose() * v;
<a name="line881"/>   <font CLASS=comment>881:</font> }
<a name="line882"/>   <font CLASS=comment>882:</font> 
<a name="line883"/>   <font CLASS=comment>883:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>double</font> <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> vec3&amp; b)
<a name="line884"/>   <font CLASS=comment>884:</font> { 
<a name="line885"/>   <font CLASS=comment>885:</font> 	<font CLASS=keyword>return</font> (a.n[VX]*b.n[VX] <font CLASS=symbols>+</font> a.n[VY]*b.n[VY] <font CLASS=symbols>+</font> a.n[VZ]*b.n[VZ]); 
<a name="line886"/>   <font CLASS=comment>886:</font> }
<a name="line887"/>   <font CLASS=comment>887:</font> 
<a name="line888"/>   <font CLASS=comment>888:</font> <font CLASS=keyword>inline</font> vec3 <font CLASS=keyword>operator</font> / (<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d)
<a name="line889"/>   <font CLASS=comment>889:</font> { 
<a name="line890"/>   <font CLASS=comment>890:</font> 	<font CLASS=keytype>double</font> d_inv <font CLASS=symbols>=</font> <font CLASS=integer>1</font>./d; <font CLASS=keyword>return</font> vec3(a.n[VX]*d_inv, a.n[VY]*d_inv, a.n[VZ]*d_inv); 
<a name="line891"/>   <font CLASS=comment>891:</font> }
<a name="line892"/>   <font CLASS=comment>892:</font> 
<a name="line893"/>   <font CLASS=comment>893:</font> <font CLASS=keyword>inline</font> vec3 <font CLASS=keyword>operator</font> ^ (<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> vec3&amp; b) 
<a name="line894"/>   <font CLASS=comment>894:</font> {
<a name="line895"/>   <font CLASS=comment>895:</font> 	<font CLASS=keyword>return</font> vec3(a.n[VY]*b.n[VZ] <font CLASS=symbols>-</font> a.n[VZ]*b.n[VY],
<a name="line896"/>   <font CLASS=comment>896:</font> 				a.n[VZ]*b.n[VX] <font CLASS=symbols>-</font> a.n[VX]*b.n[VZ],
<a name="line897"/>   <font CLASS=comment>897:</font> 				a.n[VX]*b.n[VY] <font CLASS=symbols>-</font> a.n[VY]*b.n[VX]);
<a name="line898"/>   <font CLASS=comment>898:</font> }
<a name="line899"/>   <font CLASS=comment>899:</font> 
<a name="line900"/>   <font CLASS=comment>900:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>int</font> <font CLASS=keyword>operator</font> <font CLASS=symbols>==</font> (<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> vec3&amp; b)
<a name="line901"/>   <font CLASS=comment>901:</font> { 
<a name="line902"/>   <font CLASS=comment>902:</font> 	<font CLASS=keyword>return</font> (a.n[VX] <font CLASS=symbols>==</font> b.n[VX]) &amp;&amp; (a.n[VY] <font CLASS=symbols>==</font> b.n[VY]) &amp;&amp; (a.n[VZ] <font CLASS=symbols>==</font> b.n[VZ]);
<a name="line903"/>   <font CLASS=comment>903:</font> }
<a name="line904"/>   <font CLASS=comment>904:</font> 
<a name="line905"/>   <font CLASS=comment>905:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>int</font> <font CLASS=keyword>operator</font> <font CLASS=symbols>!=</font> (<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> vec3&amp; b)
<a name="line906"/>   <font CLASS=comment>906:</font> { 
<a name="line907"/>   <font CLASS=comment>907:</font> 	<font CLASS=keyword>return</font> <font CLASS=symbols>!</font>(a <font CLASS=symbols>==</font> b); 
<a name="line908"/>   <font CLASS=comment>908:</font> }
<a name="line909"/>   <font CLASS=comment>909:</font> 
<a name="line910"/>   <font CLASS=comment>910:</font> <font CLASS=preproc>#ifdef</font> ALGEBRA3IOSTREAMS 
<a name="line911"/>   <font CLASS=comment>911:</font> <font CLASS=keyword>inline</font> ostream&amp; <font CLASS=keyword>operator</font> &lt;&lt; (ostream&amp; s, <font CLASS=keyword>const</font> vec3&amp; v)
<a name="line912"/>   <font CLASS=comment>912:</font> { 
<a name="line913"/>   <font CLASS=comment>913:</font> 	<font CLASS=keyword>return</font> s &lt;&lt; <font CLASS=dblquot>"| "</font> &lt;&lt; v.n[VX] &lt;&lt; <font CLASS=sinquot>' '</font> &lt;&lt; v.n[VY] &lt;&lt; <font CLASS=sinquot>' '</font> &lt;&lt; v.n[VZ] &lt;&lt; <font CLASS=dblquot>" |"</font>; 
<a name="line914"/>   <font CLASS=comment>914:</font> }
<a name="line915"/>   <font CLASS=comment>915:</font> 
<a name="line916"/>   <font CLASS=comment>916:</font> <font CLASS=keyword>inline</font> istream&amp; <font CLASS=keyword>operator</font> &gt;&gt; (istream&amp; s, vec3&amp; v) 
<a name="line917"/>   <font CLASS=comment>917:</font> {
<a name="line918"/>   <font CLASS=comment>918:</font> 	vec3	v_tmp;
<a name="line919"/>   <font CLASS=comment>919:</font> 	<font CLASS=keytype>char</font>	c <font CLASS=symbols>=</font> <font CLASS=sinquot>' '</font>;
<a name="line920"/>   <font CLASS=comment>920:</font> 
<a name="line921"/>   <font CLASS=comment>921:</font> 	<font CLASS=keyword>while</font> (isspace(c))
<a name="line922"/>   <font CLASS=comment>922:</font> 		s &gt;&gt; c;
<a name="line923"/>   <font CLASS=comment>923:</font> 	<font CLASS=comment>// The vectors can be formatted either as x y z or | x y z |</font>
<a name="line924"/>   <font CLASS=comment>924:</font> 	<font CLASS=keyword>if</font> (c <font CLASS=symbols>==</font> <font CLASS=sinquot>'|'</font>) {
<a name="line925"/>   <font CLASS=comment>925:</font> 		s &gt;&gt; v_tmp[VX] &gt;&gt; v_tmp[VY] &gt;&gt; v_tmp[VZ];
<a name="line926"/>   <font CLASS=comment>926:</font> 		<font CLASS=keyword>while</font> (s &gt;&gt; c &amp;&amp; isspace(c)) ;
<a name="line927"/>   <font CLASS=comment>927:</font> 		<font CLASS=keyword>if</font> (c <font CLASS=symbols>!=</font> <font CLASS=sinquot>'|'</font>)
<a name="line928"/>   <font CLASS=comment>928:</font> 			s.setstate(ios::badbit);
<a name="line929"/>   <font CLASS=comment>929:</font> 	}
<a name="line930"/>   <font CLASS=comment>930:</font> 	<font CLASS=keyword>else</font> {
<a name="line931"/>   <font CLASS=comment>931:</font> 		s.putback(c);
<a name="line932"/>   <font CLASS=comment>932:</font> 		s &gt;&gt; v_tmp[VX] &gt;&gt; v_tmp[VY] &gt;&gt; v_tmp[VZ];
<a name="line933"/>   <font CLASS=comment>933:</font> 	}
<a name="line934"/>   <font CLASS=comment>934:</font> 	<font CLASS=keyword>if</font> (s)
<a name="line935"/>   <font CLASS=comment>935:</font> 		v <font CLASS=symbols>=</font> v_tmp;
<a name="line936"/>   <font CLASS=comment>936:</font> 	<font CLASS=keyword>return</font> s;
<a name="line937"/>   <font CLASS=comment>937:</font> }
<a name="line938"/>   <font CLASS=comment>938:</font> <font CLASS=preproc>#endif</font> <font CLASS=comment>// ALGEBRA3IOSTREAMS </font>
<a name="line939"/>   <font CLASS=comment>939:</font> 
<a name="line940"/>   <font CLASS=comment>940:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>void</font> swap(vec3&amp; a, vec3&amp; b)
<a name="line941"/>   <font CLASS=comment>941:</font> { 
<a name="line942"/>   <font CLASS=comment>942:</font> 	vec3 tmp(a); a <font CLASS=symbols>=</font> b; b <font CLASS=symbols>=</font> tmp; 
<a name="line943"/>   <font CLASS=comment>943:</font> }
<a name="line944"/>   <font CLASS=comment>944:</font> 
<a name="line945"/>   <font CLASS=comment>945:</font> <font CLASS=keyword>inline</font> vec3 min(<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> vec3&amp; b)
<a name="line946"/>   <font CLASS=comment>946:</font> { 
<a name="line947"/>   <font CLASS=comment>947:</font> 	<font CLASS=keyword>return</font> vec3(MIN(a.n[VX], b.n[VX]), MIN(a.n[VY], b.n[VY]), MIN(a.n[VZ], b.n[VZ])); 
<a name="line948"/>   <font CLASS=comment>948:</font> }
<a name="line949"/>   <font CLASS=comment>949:</font> 
<a name="line950"/>   <font CLASS=comment>950:</font> <font CLASS=keyword>inline</font> vec3 max(<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> vec3&amp; b)
<a name="line951"/>   <font CLASS=comment>951:</font> { 
<a name="line952"/>   <font CLASS=comment>952:</font> 	<font CLASS=keyword>return</font> vec3(MAX(a.n[VX], b.n[VX]), MAX(a.n[VY], b.n[VY]), MAX(a.n[VZ], b.n[VZ])); 
<a name="line953"/>   <font CLASS=comment>953:</font> }
<a name="line954"/>   <font CLASS=comment>954:</font> 
<a name="line955"/>   <font CLASS=comment>955:</font> <font CLASS=keyword>inline</font> vec3 prod(<font CLASS=keyword>const</font> vec3&amp; a, <font CLASS=keyword>const</font> vec3&amp; b)
<a name="line956"/>   <font CLASS=comment>956:</font> { 
<a name="line957"/>   <font CLASS=comment>957:</font> 	<font CLASS=keyword>return</font> vec3(a.n[VX] * b.n[VX], a.n[VY] * b.n[VY], a.n[VZ] * b.n[VZ]);
<a name="line958"/>   <font CLASS=comment>958:</font> }
<a name="line959"/>   <font CLASS=comment>959:</font> 
<a name="line960"/>   <font CLASS=comment>960:</font> <font CLASS=keyword>inline</font> vec3 floor(<font CLASS=keyword>const</font> vec3&amp; v)
<a name="line961"/>   <font CLASS=comment>961:</font> { 
<a name="line962"/>   <font CLASS=comment>962:</font> 	<font CLASS=keyword>return</font> vec3(floor(v.n[VX]), floor(v.n[VY]), floor(v.n[VZ]));
<a name="line963"/>   <font CLASS=comment>963:</font> }
<a name="line964"/>   <font CLASS=comment>964:</font> 
<a name="line965"/>   <font CLASS=comment>965:</font> <font CLASS=keyword>inline</font> vec3 ceil(<font CLASS=keyword>const</font> vec3&amp; v)
<a name="line966"/>   <font CLASS=comment>966:</font> { 
<a name="line967"/>   <font CLASS=comment>967:</font> 	<font CLASS=keyword>return</font> vec3(ceil(v.n[VX]), ceil(v.n[VY]), ceil(v.n[VZ]));
<a name="line968"/>   <font CLASS=comment>968:</font> }
<a name="line969"/>   <font CLASS=comment>969:</font> 
<a name="line970"/>   <font CLASS=comment>970:</font> 
<a name="line971"/>   <font CLASS=comment>971:</font> <font CLASS=comment>/****************************************************************
<a name="line972"/>   <font CLASS=comment>972:</font> *																*
<a name="line973"/>   <font CLASS=comment>973:</font> *		    vec4 Member functions								*
<a name="line974"/>   <font CLASS=comment>974:</font> *																*
<a name="line975"/>   <font CLASS=comment>975:</font> ****************************************************************/</font>
<a name="line976"/>   <font CLASS=comment>976:</font> 
<a name="line977"/>   <font CLASS=comment>977:</font> <font CLASS=comment>// CONSTRUCTORS</font>
<a name="line978"/>   <font CLASS=comment>978:</font> 
<a name="line979"/>   <font CLASS=comment>979:</font> <font CLASS=keyword>inline</font> vec4::vec4() {}
<a name="line980"/>   <font CLASS=comment>980:</font> 
<a name="line981"/>   <font CLASS=comment>981:</font> <font CLASS=keyword>inline</font> vec4::vec4(<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> x, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> y, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> z, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> w)
<a name="line982"/>   <font CLASS=comment>982:</font> { 
<a name="line983"/>   <font CLASS=comment>983:</font> 	n[VX] <font CLASS=symbols>=</font> x; n[VY] <font CLASS=symbols>=</font> y; n[VZ] = z; n[VW] = w;
<a name="line984"/>   <font CLASS=comment>984:</font> }
<a name="line985"/>   <font CLASS=comment>985:</font> 
<a name="line986"/>   <font CLASS=comment>986:</font> <font CLASS=keyword>inline</font> vec4::vec4(<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d)
<a name="line987"/>   <font CLASS=comment>987:</font> { 
<a name="line988"/>   <font CLASS=comment>988:</font> 	n[VX] <font CLASS=symbols>=</font> n[VY] <font CLASS=symbols>=</font> n[VZ] = n[VW] = d; 
<a name="line989"/>   <font CLASS=comment>989:</font> }
<a name="line990"/>   <font CLASS=comment>990:</font> 
<a name="line991"/>   <font CLASS=comment>991:</font> <font CLASS=keyword>inline</font> vec4::vec4(<font CLASS=keyword>const</font> vec4&amp; v)
<a name="line992"/>   <font CLASS=comment>992:</font> {
<a name="line993"/>   <font CLASS=comment>993:</font> 	n[VX] <font CLASS=symbols>=</font> v.n[VX]; n[VY] <font CLASS=symbols>=</font> v.n[VY]; n[VZ] = v.n[VZ]; n[VW] <font CLASS=symbols>=</font> v.n[VW]; 
<a name="line994"/>   <font CLASS=comment>994:</font> }
<a name="line995"/>   <font CLASS=comment>995:</font> 
<a name="line996"/>   <font CLASS=comment>996:</font> <font CLASS=keyword>inline</font> vec4::vec4(<font CLASS=keyword>const</font> vec3&amp; v)
<a name="line997"/>   <font CLASS=comment>997:</font> {
<a name="line998"/>   <font CLASS=comment>998:</font> 	n[VX] <font CLASS=symbols>=</font> v.n[VX]; n[VY] <font CLASS=symbols>=</font> v.n[VY]; n[VZ] = v.n[VZ]; n[VW] <font CLASS=symbols>=</font> <font CLASS=floatpt>1.0</font>;
<a name="line999"/>   <font CLASS=comment>999:</font> }
<a name="line1000"/>  <font CLASS=comment>1000:</font> 
<a name="line1001"/>  <font CLASS=comment>1001:</font> <font CLASS=keyword>inline</font> vec4::vec4(<font CLASS=keyword>const</font> vec3&amp; v, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d)
<a name="line1002"/>  <font CLASS=comment>1002:</font> {
<a name="line1003"/>  <font CLASS=comment>1003:</font> 	n[VX] <font CLASS=symbols>=</font> v.n[VX]; n[VY] <font CLASS=symbols>=</font> v.n[VY]; n[VZ] = v.n[VZ];  n[VW] <font CLASS=symbols>=</font> d;
<a name="line1004"/>  <font CLASS=comment>1004:</font> }
<a name="line1005"/>  <font CLASS=comment>1005:</font> 
<a name="line1006"/>  <font CLASS=comment>1006:</font> 
<a name="line1007"/>  <font CLASS=comment>1007:</font> <font CLASS=comment>// ASSIGNMENT OPERATORS</font>
<a name="line1008"/>  <font CLASS=comment>1008:</font> 
<a name="line1009"/>  <font CLASS=comment>1009:</font> <font CLASS=keyword>inline</font> vec4&amp; vec4::<font CLASS=keyword>operator</font> <font CLASS=symbols>=</font> (<font CLASS=keyword>const</font> vec4&amp; v)
<a name="line1010"/>  <font CLASS=comment>1010:</font> { 
<a name="line1011"/>  <font CLASS=comment>1011:</font> 	n[VX] <font CLASS=symbols>=</font> v.n[VX]; n[VY] <font CLASS=symbols>=</font> v.n[VY]; n[VZ] = v.n[VZ]; n[VW] <font CLASS=symbols>=</font> v.n[VW];	<font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>; 
<a name="line1012"/>  <font CLASS=comment>1012:</font> }
<a name="line1013"/>  <font CLASS=comment>1013:</font> 
<a name="line1014"/>  <font CLASS=comment>1014:</font> <font CLASS=keyword>inline</font> vec4&amp; vec4::<font CLASS=keyword>operator</font> <font CLASS=symbols>+=</font> ( <font CLASS=keyword>const</font> vec4&amp; v )
<a name="line1015"/>  <font CLASS=comment>1015:</font> { 
<a name="line1016"/>  <font CLASS=comment>1016:</font> 	n[VX] <font CLASS=symbols>+=</font> v.n[VX]; n[VY] <font CLASS=symbols>+=</font> v.n[VY]; n[VZ] += v.n[VZ]; n[VW] <font CLASS=symbols>+=</font> v.n[VW];	<font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>; 
<a name="line1017"/>  <font CLASS=comment>1017:</font> }
<a name="line1018"/>  <font CLASS=comment>1018:</font> 
<a name="line1019"/>  <font CLASS=comment>1019:</font> <font CLASS=keyword>inline</font> vec4&amp; vec4::<font CLASS=keyword>operator</font> <font CLASS=symbols>-=</font> ( <font CLASS=keyword>const</font> vec4&amp; v )
<a name="line1020"/>  <font CLASS=comment>1020:</font> { 
<a name="line1021"/>  <font CLASS=comment>1021:</font> 	n[VX] <font CLASS=symbols>-=</font> v.n[VX]; n[VY] <font CLASS=symbols>-=</font> v.n[VY]; n[VZ] -= v.n[VZ]; n[VW] <font CLASS=symbols>-=</font> v.n[VW];	<font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>; 
<a name="line1022"/>  <font CLASS=comment>1022:</font> }
<a name="line1023"/>  <font CLASS=comment>1023:</font> 
<a name="line1024"/>  <font CLASS=comment>1024:</font> <font CLASS=keyword>inline</font> vec4&amp; vec4::<font CLASS=keyword>operator</font> *<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d )
<a name="line1025"/>  <font CLASS=comment>1025:</font> { 
<a name="line1026"/>  <font CLASS=comment>1026:</font> 	n[VX] *<font CLASS=symbols>=</font> d; n[VY] *<font CLASS=symbols>=</font> d; n[VZ] *= d; n[VW] *= d; <font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>; 
<a name="line1027"/>  <font CLASS=comment>1027:</font> }
<a name="line1028"/>  <font CLASS=comment>1028:</font> 
<a name="line1029"/>  <font CLASS=comment>1029:</font> <font CLASS=keyword>inline</font> vec4&amp; vec4::<font CLASS=keyword>operator</font> /<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d )
<a name="line1030"/>  <font CLASS=comment>1030:</font> { 
<a name="line1031"/>  <font CLASS=comment>1031:</font> 	<font CLASS=keytype>double</font> d_inv <font CLASS=symbols>=</font> <font CLASS=integer>1</font>./d; n[VX] *<font CLASS=symbols>=</font> d_inv; n[VY] *= d_inv; n[VZ] *<font CLASS=symbols>=</font> d_inv; n[VW] *= d_inv; <font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>;
<a name="line1032"/>  <font CLASS=comment>1032:</font> }
<a name="line1033"/>  <font CLASS=comment>1033:</font> 
<a name="line1034"/>  <font CLASS=comment>1034:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>double</font>&amp; vec4::<font CLASS=keyword>operator</font> [] ( <font CLASS=keytype>int</font> i)
<a name="line1035"/>  <font CLASS=comment>1035:</font> {
<a name="line1036"/>  <font CLASS=comment>1036:</font> 	assert(<font CLASS=symbols>!</font> (i &lt; VX <font CLASS=symbols>||</font> i &gt; VW));
<a name="line1037"/>  <font CLASS=comment>1037:</font> 	<font CLASS=keyword>return</font> n[i];
<a name="line1038"/>  <font CLASS=comment>1038:</font> }
<a name="line1039"/>  <font CLASS=comment>1039:</font> 
<a name="line1040"/>  <font CLASS=comment>1040:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>double</font> vec4::<font CLASS=keyword>operator</font> [] ( <font CLASS=keytype>int</font> i) <font CLASS=keyword>const</font> 
<a name="line1041"/>  <font CLASS=comment>1041:</font> {
<a name="line1042"/>  <font CLASS=comment>1042:</font> 	assert(<font CLASS=symbols>!</font> (i &lt; VX <font CLASS=symbols>||</font> i &gt; VW));
<a name="line1043"/>  <font CLASS=comment>1043:</font> 	<font CLASS=keyword>return</font> n[i];
<a name="line1044"/>  <font CLASS=comment>1044:</font> }
<a name="line1045"/>  <font CLASS=comment>1045:</font> 
<a name="line1046"/>  <font CLASS=comment>1046:</font> <font CLASS=comment>// SPECIAL FUNCTIONS</font>
<a name="line1047"/>  <font CLASS=comment>1047:</font> 
<a name="line1048"/>  <font CLASS=comment>1048:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>double</font> vec4::length() <font CLASS=keyword>const</font>
<a name="line1049"/>  <font CLASS=comment>1049:</font> { 
<a name="line1050"/>  <font CLASS=comment>1050:</font> 	<font CLASS=keyword>return</font> sqrt(length2());
<a name="line1051"/>  <font CLASS=comment>1051:</font> }
<a name="line1052"/>  <font CLASS=comment>1052:</font> 
<a name="line1053"/>  <font CLASS=comment>1053:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>double</font> vec4::length2() <font CLASS=keyword>const</font>
<a name="line1054"/>  <font CLASS=comment>1054:</font> { 
<a name="line1055"/>  <font CLASS=comment>1055:</font> 	<font CLASS=keyword>return</font> n[VX]*n[VX] <font CLASS=symbols>+</font> n[VY]*n[VY] <font CLASS=symbols>+</font> n[VZ]*n[VZ] + n[VW]*n[VW];
<a name="line1056"/>  <font CLASS=comment>1056:</font> }
<a name="line1057"/>  <font CLASS=comment>1057:</font> 
<a name="line1058"/>  <font CLASS=comment>1058:</font> <font CLASS=keyword>inline</font> vec4&amp; vec4::normalize() <font CLASS=comment>// it is up to caller to avoid divide-by-zero</font>
<a name="line1059"/>  <font CLASS=comment>1059:</font> { 
<a name="line1060"/>  <font CLASS=comment>1060:</font> 	<font CLASS=keytype>double</font> len <font CLASS=symbols>=</font> length();
<a name="line1061"/>  <font CLASS=comment>1061:</font> 	<font CLASS=keyword>if</font> (len &gt; <font CLASS=floatpt>0.000001</font>) *<font CLASS=keyword>this</font> /<font CLASS=symbols>=</font> len; 
<a name="line1062"/>  <font CLASS=comment>1062:</font> 	<font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>; 
<a name="line1063"/>  <font CLASS=comment>1063:</font> }
<a name="line1064"/>  <font CLASS=comment>1064:</font> 
<a name="line1065"/>  <font CLASS=comment>1065:</font> <font CLASS=keyword>inline</font> vec4&amp; vec4::apply(V_FCT_PTR fct)
<a name="line1066"/>  <font CLASS=comment>1066:</font> { 
<a name="line1067"/>  <font CLASS=comment>1067:</font> 	n[VX] <font CLASS=symbols>=</font> (*fct)(n[VX]); n[VY] <font CLASS=symbols>=</font> (*fct)(n[VY]); n[VZ] = (*fct)(n[VZ]);
<a name="line1068"/>  <font CLASS=comment>1068:</font> 	n[VW] <font CLASS=symbols>=</font> (*fct)(n[VW]); <font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>;
<a name="line1069"/>  <font CLASS=comment>1069:</font> }
<a name="line1070"/>  <font CLASS=comment>1070:</font> 
<a name="line1071"/>  <font CLASS=comment>1071:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>void</font> vec4::set( <font CLASS=keytype>float</font> x, <font CLASS=keytype>float</font> y, <font CLASS=keytype>float</font> z, <font CLASS=keytype>float</font> a )
<a name="line1072"/>  <font CLASS=comment>1072:</font> {
<a name="line1073"/>  <font CLASS=comment>1073:</font> 	n[<font CLASS=integer>0</font>] <font CLASS=symbols>=</font> x; n[<font CLASS=integer>1</font>] <font CLASS=symbols>=</font> y; n[<font CLASS=integer>2</font>] = z; n[<font CLASS=integer>3</font>] = a;
<a name="line1074"/>  <font CLASS=comment>1074:</font> }
<a name="line1075"/>  <font CLASS=comment>1075:</font> 
<a name="line1076"/>  <font CLASS=comment>1076:</font> 
<a name="line1077"/>  <font CLASS=comment>1077:</font> <font CLASS=comment>// FRIENDS</font>
<a name="line1078"/>  <font CLASS=comment>1078:</font> 
<a name="line1079"/>  <font CLASS=comment>1079:</font> <font CLASS=keyword>inline</font> vec4 <font CLASS=keyword>operator</font> <font CLASS=symbols>-</font> (<font CLASS=keyword>const</font> vec4&amp; a)
<a name="line1080"/>  <font CLASS=comment>1080:</font> { 
<a name="line1081"/>  <font CLASS=comment>1081:</font> 	<font CLASS=keyword>return</font> vec4(-a.n[VX],-a.n[VY],-a.n[VZ],-a.n[VW]); 
<a name="line1082"/>  <font CLASS=comment>1082:</font> }
<a name="line1083"/>  <font CLASS=comment>1083:</font> 
<a name="line1084"/>  <font CLASS=comment>1084:</font> <font CLASS=keyword>inline</font> vec4 <font CLASS=keyword>operator</font> <font CLASS=symbols>+</font> (<font CLASS=keyword>const</font> vec4&amp; a, <font CLASS=keyword>const</font> vec4&amp; b)
<a name="line1085"/>  <font CLASS=comment>1085:</font> {
<a name="line1086"/>  <font CLASS=comment>1086:</font> 	<font CLASS=keyword>return</font> vec4(a.n[VX] <font CLASS=symbols>+</font> b.n[VX], a.n[VY] <font CLASS=symbols>+</font> b.n[VY], a.n[VZ] + b.n[VZ], a.n[VW] <font CLASS=symbols>+</font> b.n[VW]); 
<a name="line1087"/>  <font CLASS=comment>1087:</font> }
<a name="line1088"/>  <font CLASS=comment>1088:</font> 
<a name="line1089"/>  <font CLASS=comment>1089:</font> <font CLASS=keyword>inline</font> vec4 <font CLASS=keyword>operator</font> <font CLASS=symbols>-</font> (<font CLASS=keyword>const</font> vec4&amp; a, <font CLASS=keyword>const</font> vec4&amp; b)
<a name="line1090"/>  <font CLASS=comment>1090:</font> {  
<a name="line1091"/>  <font CLASS=comment>1091:</font> 	<font CLASS=keyword>return</font> vec4(a.n[VX] <font CLASS=symbols>-</font> b.n[VX], a.n[VY] <font CLASS=symbols>-</font> b.n[VY], a.n[VZ] - b.n[VZ], a.n[VW] <font CLASS=symbols>-</font> b.n[VW]); 
<a name="line1092"/>  <font CLASS=comment>1092:</font> }
<a name="line1093"/>  <font CLASS=comment>1093:</font> 
<a name="line1094"/>  <font CLASS=comment>1094:</font> <font CLASS=keyword>inline</font> vec4 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> vec4&amp; a, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d)
<a name="line1095"/>  <font CLASS=comment>1095:</font> { 
<a name="line1096"/>  <font CLASS=comment>1096:</font> 	<font CLASS=keyword>return</font> vec4(d*a.n[VX], d*a.n[VY], d*a.n[VZ], d*a.n[VW]); 
<a name="line1097"/>  <font CLASS=comment>1097:</font> }
<a name="line1098"/>  <font CLASS=comment>1098:</font> 
<a name="line1099"/>  <font CLASS=comment>1099:</font> <font CLASS=keyword>inline</font> vec4 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d, <font CLASS=keyword>const</font> vec4&amp; a)
<a name="line1100"/>  <font CLASS=comment>1100:</font> { 
<a name="line1101"/>  <font CLASS=comment>1101:</font> 	<font CLASS=keyword>return</font> a*d; 
<a name="line1102"/>  <font CLASS=comment>1102:</font> }
<a name="line1103"/>  <font CLASS=comment>1103:</font> 
<a name="line1104"/>  <font CLASS=comment>1104:</font> <font CLASS=keyword>inline</font> vec4 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> vec4&amp; v) 
<a name="line1105"/>  <font CLASS=comment>1105:</font> {
<a name="line1106"/>  <font CLASS=comment>1106:</font> <font CLASS=preproc>#define</font> ROWCOL(i) a.v[i].n[<font CLASS=integer>0</font>]*v.n[VX] <font CLASS=symbols>+</font> a.v[i].n[<font CLASS=integer>1</font>]*v.n[VY] \ 
<a name="line1107"/>  <font CLASS=comment>1107:</font> 				<font CLASS=symbols>+</font> a.v[i].n[<font CLASS=integer>2</font>]*v.n[VZ] <font CLASS=symbols>+</font> a.v[i].n[<font CLASS=integer>3</font>]*v.n[VW]
<a name="line1108"/>  <font CLASS=comment>1108:</font> 				<font CLASS=keyword>return</font> vec4(ROWCOL(<font CLASS=integer>0</font>), ROWCOL(<font CLASS=integer>1</font>), ROWCOL(<font CLASS=integer>2</font>), ROWCOL(<font CLASS=integer>3</font>));
<a name="line1109"/>  <font CLASS=comment>1109:</font> <font CLASS=preproc>#undef</font> ROWCOL <font CLASS=comment>// (i) </font>
<a name="line1110"/>  <font CLASS=comment>1110:</font> }
<a name="line1111"/>  <font CLASS=comment>1111:</font> 
<a name="line1112"/>  <font CLASS=comment>1112:</font> <font CLASS=keyword>inline</font> vec4 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> vec4&amp; v, <font CLASS=keyword>const</font> mat4&amp; a)
<a name="line1113"/>  <font CLASS=comment>1113:</font> {
<a name="line1114"/>  <font CLASS=comment>1114:</font> 	<font CLASS=keyword>return</font> a.transpose() * v;
<a name="line1115"/>  <font CLASS=comment>1115:</font> }
<a name="line1116"/>  <font CLASS=comment>1116:</font> 
<a name="line1117"/>  <font CLASS=comment>1117:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>double</font> <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> vec4&amp; a, <font CLASS=keyword>const</font> vec4&amp; b)
<a name="line1118"/>  <font CLASS=comment>1118:</font> { 
<a name="line1119"/>  <font CLASS=comment>1119:</font> 	<font CLASS=keyword>return</font> (a.n[VX]*b.n[VX] <font CLASS=symbols>+</font> a.n[VY]*b.n[VY] <font CLASS=symbols>+</font> a.n[VZ]*b.n[VZ] + a.n[VW]*b.n[VW]); 
<a name="line1120"/>  <font CLASS=comment>1120:</font> }
<a name="line1121"/>  <font CLASS=comment>1121:</font> 
<a name="line1122"/>  <font CLASS=comment>1122:</font> <font CLASS=keyword>inline</font> vec4 <font CLASS=keyword>operator</font> / (<font CLASS=keyword>const</font> vec4&amp; a, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d)
<a name="line1123"/>  <font CLASS=comment>1123:</font> { 
<a name="line1124"/>  <font CLASS=comment>1124:</font> 	<font CLASS=keytype>double</font> d_inv <font CLASS=symbols>=</font> <font CLASS=integer>1</font>./d; <font CLASS=keyword>return</font> vec4(a.n[VX]*d_inv, a.n[VY]*d_inv, a.n[VZ]*d_inv, a.n[VW]*d_inv); 
<a name="line1125"/>  <font CLASS=comment>1125:</font> }
<a name="line1126"/>  <font CLASS=comment>1126:</font> 
<a name="line1127"/>  <font CLASS=comment>1127:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>int</font> <font CLASS=keyword>operator</font> <font CLASS=symbols>==</font> (<font CLASS=keyword>const</font> vec4&amp; a, <font CLASS=keyword>const</font> vec4&amp; b)
<a name="line1128"/>  <font CLASS=comment>1128:</font> { 
<a name="line1129"/>  <font CLASS=comment>1129:</font> 	<font CLASS=keyword>return</font> (a.n[VX] <font CLASS=symbols>==</font> b.n[VX]) &amp;&amp; (a.n[VY] <font CLASS=symbols>==</font> b.n[VY]) &amp;&amp; (a.n[VZ] <font CLASS=symbols>==</font> b.n[VZ]) &amp;&amp; (a.n[VW] == b.n[VW]); 
<a name="line1130"/>  <font CLASS=comment>1130:</font> }
<a name="line1131"/>  <font CLASS=comment>1131:</font> 
<a name="line1132"/>  <font CLASS=comment>1132:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>int</font> <font CLASS=keyword>operator</font> <font CLASS=symbols>!=</font> (<font CLASS=keyword>const</font> vec4&amp; a, <font CLASS=keyword>const</font> vec4&amp; b)
<a name="line1133"/>  <font CLASS=comment>1133:</font> {
<a name="line1134"/>  <font CLASS=comment>1134:</font> 	<font CLASS=keyword>return</font> <font CLASS=symbols>!</font>(a <font CLASS=symbols>==</font> b); 
<a name="line1135"/>  <font CLASS=comment>1135:</font> }
<a name="line1136"/>  <font CLASS=comment>1136:</font> 
<a name="line1137"/>  <font CLASS=comment>1137:</font> <font CLASS=preproc>#ifdef</font> ALGEBRA3IOSTREAMS 
<a name="line1138"/>  <font CLASS=comment>1138:</font> <font CLASS=keyword>inline</font> ostream&amp; <font CLASS=keyword>operator</font> &lt;&lt; (ostream&amp; s, <font CLASS=keyword>const</font> vec4&amp; v)
<a name="line1139"/>  <font CLASS=comment>1139:</font> { 
<a name="line1140"/>  <font CLASS=comment>1140:</font> 	<font CLASS=keyword>return</font> s &lt;&lt; <font CLASS=dblquot>"| "</font> &lt;&lt; v.n[VX] &lt;&lt; <font CLASS=sinquot>' '</font> &lt;&lt; v.n[VY] &lt;&lt; <font CLASS=sinquot>' '</font> &lt;&lt; v.n[VZ] &lt;&lt; <font CLASS=sinquot>' '</font> &lt;&lt; v.n[VW] &lt;&lt; <font CLASS=dblquot>" |"</font>; 
<a name="line1141"/>  <font CLASS=comment>1141:</font> }
<a name="line1142"/>  <font CLASS=comment>1142:</font> 
<a name="line1143"/>  <font CLASS=comment>1143:</font> <font CLASS=keyword>inline</font> istream&amp; <font CLASS=keyword>operator</font> &gt;&gt; (istream&amp; s, vec4&amp; v) 
<a name="line1144"/>  <font CLASS=comment>1144:</font> {
<a name="line1145"/>  <font CLASS=comment>1145:</font> 	vec4	v_tmp;
<a name="line1146"/>  <font CLASS=comment>1146:</font> 	<font CLASS=keytype>char</font>	c <font CLASS=symbols>=</font> <font CLASS=sinquot>' '</font>;
<a name="line1147"/>  <font CLASS=comment>1147:</font> 
<a name="line1148"/>  <font CLASS=comment>1148:</font> 	<font CLASS=keyword>while</font> (isspace(c))
<a name="line1149"/>  <font CLASS=comment>1149:</font> 		s &gt;&gt; c;
<a name="line1150"/>  <font CLASS=comment>1150:</font> 	<font CLASS=comment>// The vectors can be formatted either as x y z w or | x y z w |</font>
<a name="line1151"/>  <font CLASS=comment>1151:</font> 	<font CLASS=keyword>if</font> (c <font CLASS=symbols>==</font> <font CLASS=sinquot>'|'</font>) {
<a name="line1152"/>  <font CLASS=comment>1152:</font> 		s &gt;&gt; v_tmp[VX] &gt;&gt; v_tmp[VY] &gt;&gt; v_tmp[VZ] &gt;&gt; v_tmp[VW];
<a name="line1153"/>  <font CLASS=comment>1153:</font> 		<font CLASS=keyword>while</font> (s &gt;&gt; c &amp;&amp; isspace(c)) ;
<a name="line1154"/>  <font CLASS=comment>1154:</font> 		<font CLASS=keyword>if</font> (c <font CLASS=symbols>!=</font> <font CLASS=sinquot>'|'</font>)
<a name="line1155"/>  <font CLASS=comment>1155:</font> 			s.setstate(ios::badbit);
<a name="line1156"/>  <font CLASS=comment>1156:</font> 	}
<a name="line1157"/>  <font CLASS=comment>1157:</font> 	<font CLASS=keyword>else</font> {
<a name="line1158"/>  <font CLASS=comment>1158:</font> 		s.putback(c);
<a name="line1159"/>  <font CLASS=comment>1159:</font> 		s &gt;&gt; v_tmp[VX] &gt;&gt; v_tmp[VY] &gt;&gt; v_tmp[VZ] &gt;&gt; v_tmp[VW];
<a name="line1160"/>  <font CLASS=comment>1160:</font> 	}
<a name="line1161"/>  <font CLASS=comment>1161:</font> 	<font CLASS=keyword>if</font> (s)
<a name="line1162"/>  <font CLASS=comment>1162:</font> 		v <font CLASS=symbols>=</font> v_tmp;
<a name="line1163"/>  <font CLASS=comment>1163:</font> 	<font CLASS=keyword>return</font> s;
<a name="line1164"/>  <font CLASS=comment>1164:</font> }
<a name="line1165"/>  <font CLASS=comment>1165:</font> <font CLASS=preproc>#endif</font> <font CLASS=comment>// ALGEBRA3IOSTREAMS </font>
<a name="line1166"/>  <font CLASS=comment>1166:</font> 
<a name="line1167"/>  <font CLASS=comment>1167:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>void</font> swap(vec4&amp; a, vec4&amp; b)
<a name="line1168"/>  <font CLASS=comment>1168:</font> { 
<a name="line1169"/>  <font CLASS=comment>1169:</font> 	vec4 tmp(a); a <font CLASS=symbols>=</font> b; b <font CLASS=symbols>=</font> tmp; 
<a name="line1170"/>  <font CLASS=comment>1170:</font> }
<a name="line1171"/>  <font CLASS=comment>1171:</font> 
<a name="line1172"/>  <font CLASS=comment>1172:</font> <font CLASS=keyword>inline</font> vec4 min(<font CLASS=keyword>const</font> vec4&amp; a, <font CLASS=keyword>const</font> vec4&amp; b)
<a name="line1173"/>  <font CLASS=comment>1173:</font> { 
<a name="line1174"/>  <font CLASS=comment>1174:</font> 	<font CLASS=keyword>return</font> vec4(MIN(a.n[VX], b.n[VX]), MIN(a.n[VY], b.n[VY]), MIN(a.n[VZ], b.n[VZ]), MIN(a.n[VW], b.n[VW])); 
<a name="line1175"/>  <font CLASS=comment>1175:</font> }
<a name="line1176"/>  <font CLASS=comment>1176:</font> 
<a name="line1177"/>  <font CLASS=comment>1177:</font> <font CLASS=keyword>inline</font> vec4 max(<font CLASS=keyword>const</font> vec4&amp; a, <font CLASS=keyword>const</font> vec4&amp; b)
<a name="line1178"/>  <font CLASS=comment>1178:</font> {
<a name="line1179"/>  <font CLASS=comment>1179:</font> 	<font CLASS=keyword>return</font> vec4(MAX(a.n[VX], b.n[VX]), MAX(a.n[VY], b.n[VY]), MAX(a.n[VZ], b.n[VZ]), MAX(a.n[VW], b.n[VW]));
<a name="line1180"/>  <font CLASS=comment>1180:</font> }
<a name="line1181"/>  <font CLASS=comment>1181:</font> 
<a name="line1182"/>  <font CLASS=comment>1182:</font> <font CLASS=keyword>inline</font> vec4 prod(<font CLASS=keyword>const</font> vec4&amp; a, <font CLASS=keyword>const</font> vec4&amp; b)
<a name="line1183"/>  <font CLASS=comment>1183:</font> { 
<a name="line1184"/>  <font CLASS=comment>1184:</font> 	<font CLASS=keyword>return</font> vec4(a.n[VX] * b.n[VX], a.n[VY] * b.n[VY], a.n[VZ] * b.n[VZ], a.n[VW] * b.n[VW]); 
<a name="line1185"/>  <font CLASS=comment>1185:</font> }
<a name="line1186"/>  <font CLASS=comment>1186:</font> 
<a name="line1187"/>  <font CLASS=comment>1187:</font> <font CLASS=keyword>inline</font> vec4 floor(<font CLASS=keyword>const</font> vec4&amp; v)
<a name="line1188"/>  <font CLASS=comment>1188:</font> { 
<a name="line1189"/>  <font CLASS=comment>1189:</font> 	<font CLASS=keyword>return</font> vec4(floor(v.n[VX]), floor(v.n[VY]), floor(v.n[VZ]), floor(v.n[VW]));
<a name="line1190"/>  <font CLASS=comment>1190:</font> }
<a name="line1191"/>  <font CLASS=comment>1191:</font> 
<a name="line1192"/>  <font CLASS=comment>1192:</font> <font CLASS=keyword>inline</font> vec4 ceil(<font CLASS=keyword>const</font> vec4&amp; v)
<a name="line1193"/>  <font CLASS=comment>1193:</font> { 
<a name="line1194"/>  <font CLASS=comment>1194:</font> 	<font CLASS=keyword>return</font> vec4(ceil(v.n[VX]), ceil(v.n[VY]), ceil(v.n[VZ]), ceil(v.n[VW]));
<a name="line1195"/>  <font CLASS=comment>1195:</font> }
<a name="line1196"/>  <font CLASS=comment>1196:</font> 
<a name="line1197"/>  <font CLASS=comment>1197:</font> 
<a name="line1198"/>  <font CLASS=comment>1198:</font> <font CLASS=comment>/****************************************************************
<a name="line1199"/>  <font CLASS=comment>1199:</font> *																*
<a name="line1200"/>  <font CLASS=comment>1200:</font> *		    mat3 member functions								*
<a name="line1201"/>  <font CLASS=comment>1201:</font> *																*
<a name="line1202"/>  <font CLASS=comment>1202:</font> ****************************************************************/</font>
<a name="line1203"/>  <font CLASS=comment>1203:</font> 
<a name="line1204"/>  <font CLASS=comment>1204:</font> <font CLASS=comment>// CONSTRUCTORS</font>
<a name="line1205"/>  <font CLASS=comment>1205:</font> 
<a name="line1206"/>  <font CLASS=comment>1206:</font> <font CLASS=keyword>inline</font> mat3::mat3() {}
<a name="line1207"/>  <font CLASS=comment>1207:</font> 
<a name="line1208"/>  <font CLASS=comment>1208:</font> <font CLASS=keyword>inline</font> mat3::mat3(<font CLASS=keyword>const</font> vec3&amp; v0, <font CLASS=keyword>const</font> vec3&amp; v1, <font CLASS=keyword>const</font> vec3&amp; v2)
<a name="line1209"/>  <font CLASS=comment>1209:</font> { 
<a name="line1210"/>  <font CLASS=comment>1210:</font> 	v[<font CLASS=integer>0</font>] <font CLASS=symbols>=</font> v0; v[<font CLASS=integer>1</font>] <font CLASS=symbols>=</font> v1; v[<font CLASS=integer>2</font>] = v2; 
<a name="line1211"/>  <font CLASS=comment>1211:</font> }
<a name="line1212"/>  <font CLASS=comment>1212:</font> 
<a name="line1213"/>  <font CLASS=comment>1213:</font> <font CLASS=keyword>inline</font> mat3::mat3(<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d)
<a name="line1214"/>  <font CLASS=comment>1214:</font> {
<a name="line1215"/>  <font CLASS=comment>1215:</font> 	v[<font CLASS=integer>0</font>] <font CLASS=symbols>=</font> v[<font CLASS=integer>1</font>] <font CLASS=symbols>=</font> v[<font CLASS=integer>2</font>] = vec3(d); 
<a name="line1216"/>  <font CLASS=comment>1216:</font> }
<a name="line1217"/>  <font CLASS=comment>1217:</font> 
<a name="line1218"/>  <font CLASS=comment>1218:</font> <font CLASS=keyword>inline</font> mat3::mat3(<font CLASS=keyword>const</font> mat3&amp; m)
<a name="line1219"/>  <font CLASS=comment>1219:</font> {
<a name="line1220"/>  <font CLASS=comment>1220:</font> 	v[<font CLASS=integer>0</font>] <font CLASS=symbols>=</font> m.v[<font CLASS=integer>0</font>]; v[<font CLASS=integer>1</font>] <font CLASS=symbols>=</font> m.v[<font CLASS=integer>1</font>]; v[<font CLASS=integer>2</font>] = m.v[<font CLASS=integer>2</font>]; 
<a name="line1221"/>  <font CLASS=comment>1221:</font> }
<a name="line1222"/>  <font CLASS=comment>1222:</font> 
<a name="line1223"/>  <font CLASS=comment>1223:</font> 
<a name="line1224"/>  <font CLASS=comment>1224:</font> <font CLASS=comment>// ASSIGNMENT OPERATORS</font>
<a name="line1225"/>  <font CLASS=comment>1225:</font> 
<a name="line1226"/>  <font CLASS=comment>1226:</font> <font CLASS=keyword>inline</font> mat3&amp; mat3::<font CLASS=keyword>operator</font> <font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> mat3&amp; m )
<a name="line1227"/>  <font CLASS=comment>1227:</font> {
<a name="line1228"/>  <font CLASS=comment>1228:</font> 	v[<font CLASS=integer>0</font>] <font CLASS=symbols>=</font> m.v[<font CLASS=integer>0</font>]; v[<font CLASS=integer>1</font>] <font CLASS=symbols>=</font> m.v[<font CLASS=integer>1</font>]; v[<font CLASS=integer>2</font>] = m.v[<font CLASS=integer>2</font>]; <font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>;
<a name="line1229"/>  <font CLASS=comment>1229:</font> }
<a name="line1230"/>  <font CLASS=comment>1230:</font> 
<a name="line1231"/>  <font CLASS=comment>1231:</font> <font CLASS=keyword>inline</font> mat3&amp; mat3::<font CLASS=keyword>operator</font> <font CLASS=symbols>+=</font> ( <font CLASS=keyword>const</font> mat3&amp; m )
<a name="line1232"/>  <font CLASS=comment>1232:</font> { 
<a name="line1233"/>  <font CLASS=comment>1233:</font> 	v[<font CLASS=integer>0</font>] <font CLASS=symbols>+=</font> m.v[<font CLASS=integer>0</font>]; v[<font CLASS=integer>1</font>] <font CLASS=symbols>+=</font> m.v[<font CLASS=integer>1</font>]; v[<font CLASS=integer>2</font>] += m.v[<font CLASS=integer>2</font>]; <font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>;
<a name="line1234"/>  <font CLASS=comment>1234:</font> }
<a name="line1235"/>  <font CLASS=comment>1235:</font> 
<a name="line1236"/>  <font CLASS=comment>1236:</font> <font CLASS=keyword>inline</font> mat3&amp; mat3::<font CLASS=keyword>operator</font> <font CLASS=symbols>-=</font> ( <font CLASS=keyword>const</font> mat3&amp; m )
<a name="line1237"/>  <font CLASS=comment>1237:</font> {
<a name="line1238"/>  <font CLASS=comment>1238:</font> 	v[<font CLASS=integer>0</font>] <font CLASS=symbols>-=</font> m.v[<font CLASS=integer>0</font>]; v[<font CLASS=integer>1</font>] <font CLASS=symbols>-=</font> m.v[<font CLASS=integer>1</font>]; v[<font CLASS=integer>2</font>] -= m.v[<font CLASS=integer>2</font>]; <font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>;
<a name="line1239"/>  <font CLASS=comment>1239:</font> }
<a name="line1240"/>  <font CLASS=comment>1240:</font> 
<a name="line1241"/>  <font CLASS=comment>1241:</font> <font CLASS=keyword>inline</font> mat3&amp; mat3::<font CLASS=keyword>operator</font> *<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d )
<a name="line1242"/>  <font CLASS=comment>1242:</font> {
<a name="line1243"/>  <font CLASS=comment>1243:</font> 	v[<font CLASS=integer>0</font>] *<font CLASS=symbols>=</font> d; v[<font CLASS=integer>1</font>] *<font CLASS=symbols>=</font> d; v[<font CLASS=integer>2</font>] *= d; <font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>; 
<a name="line1244"/>  <font CLASS=comment>1244:</font> }
<a name="line1245"/>  <font CLASS=comment>1245:</font> 
<a name="line1246"/>  <font CLASS=comment>1246:</font> <font CLASS=keyword>inline</font> mat3&amp; mat3::<font CLASS=keyword>operator</font> /<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d )
<a name="line1247"/>  <font CLASS=comment>1247:</font> { 
<a name="line1248"/>  <font CLASS=comment>1248:</font> 	v[<font CLASS=integer>0</font>] /<font CLASS=symbols>=</font> d; v[<font CLASS=integer>1</font>] /<font CLASS=symbols>=</font> d; v[<font CLASS=integer>2</font>] /= d; <font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>; 
<a name="line1249"/>  <font CLASS=comment>1249:</font> }
<a name="line1250"/>  <font CLASS=comment>1250:</font> 
<a name="line1251"/>  <font CLASS=comment>1251:</font> <font CLASS=keyword>inline</font> vec3&amp; mat3::<font CLASS=keyword>operator</font> [] ( <font CLASS=keytype>int</font> i) 
<a name="line1252"/>  <font CLASS=comment>1252:</font> {
<a name="line1253"/>  <font CLASS=comment>1253:</font> 	assert(<font CLASS=symbols>!</font> (i &lt; VX <font CLASS=symbols>||</font> i &gt; VZ));
<a name="line1254"/>  <font CLASS=comment>1254:</font> 	<font CLASS=keyword>return</font> v[i];
<a name="line1255"/>  <font CLASS=comment>1255:</font> }
<a name="line1256"/>  <font CLASS=comment>1256:</font> 
<a name="line1257"/>  <font CLASS=comment>1257:</font> <font CLASS=keyword>inline</font> <font CLASS=keyword>const</font> vec3&amp; mat3::<font CLASS=keyword>operator</font> [] ( <font CLASS=keytype>int</font> i) <font CLASS=keyword>const</font> 
<a name="line1258"/>  <font CLASS=comment>1258:</font> {
<a name="line1259"/>  <font CLASS=comment>1259:</font> 	assert(<font CLASS=symbols>!</font>(i &lt; VX <font CLASS=symbols>||</font> i &gt; VZ));
<a name="line1260"/>  <font CLASS=comment>1260:</font> 	<font CLASS=keyword>return</font> v[i];
<a name="line1261"/>  <font CLASS=comment>1261:</font> }
<a name="line1262"/>  <font CLASS=comment>1262:</font> 
<a name="line1263"/>  <font CLASS=comment>1263:</font> <font CLASS=comment>// SPECIAL FUNCTIONS</font>
<a name="line1264"/>  <font CLASS=comment>1264:</font> 
<a name="line1265"/>  <font CLASS=comment>1265:</font> <font CLASS=keyword>inline</font> mat3 mat3::transpose() <font CLASS=keyword>const</font> 
<a name="line1266"/>  <font CLASS=comment>1266:</font> {
<a name="line1267"/>  <font CLASS=comment>1267:</font> 	<font CLASS=keyword>return</font> mat3(vec3(v[<font CLASS=integer>0</font>][<font CLASS=integer>0</font>], v[<font CLASS=integer>1</font>][<font CLASS=integer>0</font>], v[<font CLASS=integer>2</font>][<font CLASS=integer>0</font>]),
<a name="line1268"/>  <font CLASS=comment>1268:</font> 				vec3(v[<font CLASS=integer>0</font>][<font CLASS=integer>1</font>], v[<font CLASS=integer>1</font>][<font CLASS=integer>1</font>], v[<font CLASS=integer>2</font>][<font CLASS=integer>1</font>]),
<a name="line1269"/>  <font CLASS=comment>1269:</font> 				vec3(v[<font CLASS=integer>0</font>][<font CLASS=integer>2</font>], v[<font CLASS=integer>1</font>][<font CLASS=integer>2</font>], v[<font CLASS=integer>2</font>][<font CLASS=integer>2</font>]));
<a name="line1270"/>  <font CLASS=comment>1270:</font> }
<a name="line1271"/>  <font CLASS=comment>1271:</font> 
<a name="line1272"/>  <font CLASS=comment>1272:</font> <font CLASS=keyword>inline</font> mat3 mat3::inverse()	<font CLASS=keyword>const</font>    <font CLASS=comment>// Gauss-Jordan elimination with partial pivoting</font>
<a name="line1273"/>  <font CLASS=comment>1273:</font> {
<a name="line1274"/>  <font CLASS=comment>1274:</font> 	mat3 a(*<font CLASS=keyword>this</font>),	    <font CLASS=comment>// As a evolves from original mat into identity</font>
<a name="line1275"/>  <font CLASS=comment>1275:</font> 		b(identity2D());   <font CLASS=comment>// b evolves from identity into inverse(a)</font>
<a name="line1276"/>  <font CLASS=comment>1276:</font> 	<font CLASS=keytype>int</font>	 i, j, i1;
<a name="line1277"/>  <font CLASS=comment>1277:</font> 
<a name="line1278"/>  <font CLASS=comment>1278:</font> 	<font CLASS=comment>// Loop over cols of a from left to right, eliminating above and below diag</font>
<a name="line1279"/>  <font CLASS=comment>1279:</font> 	<font CLASS=keyword>for</font> (j<font CLASS=symbols>=</font><font CLASS=integer>0</font>; j&lt;<font CLASS=integer>3</font>; j<font CLASS=symbols>++</font>) {   <font CLASS=comment>// Find largest pivot in column j among rows j..2</font>
<a name="line1280"/>  <font CLASS=comment>1280:</font> 		i1 <font CLASS=symbols>=</font> j;		    <font CLASS=comment>// Row with largest pivot candidate</font>
<a name="line1281"/>  <font CLASS=comment>1281:</font> 		<font CLASS=keyword>for</font> (i=j<font CLASS=symbols>+</font><font CLASS=integer>1</font>; i&lt;<font CLASS=integer>3</font>; i<font CLASS=symbols>++</font>)
<a name="line1282"/>  <font CLASS=comment>1282:</font> 			<font CLASS=keyword>if</font> (fabs(a.v[i].n[j]) &gt; fabs(a.v[i1].n[j]))
<a name="line1283"/>  <font CLASS=comment>1283:</font> 				i1 <font CLASS=symbols>=</font> i;
<a name="line1284"/>  <font CLASS=comment>1284:</font> 
<a name="line1285"/>  <font CLASS=comment>1285:</font> 		<font CLASS=comment>// Swap rows i1 and j in a and b to put pivot on diagonal</font>
<a name="line1286"/>  <font CLASS=comment>1286:</font> 		swap(a.v[i1], a.v[j]);
<a name="line1287"/>  <font CLASS=comment>1287:</font> 		swap(b.v[i1], b.v[j]);
<a name="line1288"/>  <font CLASS=comment>1288:</font> 
<a name="line1289"/>  <font CLASS=comment>1289:</font> 		<font CLASS=comment>// Scale row j to have a unit diagonal</font>
<a name="line1290"/>  <font CLASS=comment>1290:</font> 		<font CLASS=keyword>if</font> (a.v[j].n[j]<font CLASS=symbols>==</font><font CLASS=integer>0</font>.)
<a name="line1291"/>  <font CLASS=comment>1291:</font> 			ALGEBRA_ERROR(<font CLASS=dblquot>"mat3::inverse: singular matrix; can't invert\n"</font>)
<a name="line1292"/>  <font CLASS=comment>1292:</font> 			b.v[j] /<font CLASS=symbols>=</font> a.v[j].n[j];
<a name="line1293"/>  <font CLASS=comment>1293:</font> 			a.v[j] /<font CLASS=symbols>=</font> a.v[j].n[j];
<a name="line1294"/>  <font CLASS=comment>1294:</font> 
<a name="line1295"/>  <font CLASS=comment>1295:</font> 		<font CLASS=comment>// Eliminate off-diagonal elems in col j of a, doing identical ops to b</font>
<a name="line1296"/>  <font CLASS=comment>1296:</font> 		<font CLASS=keyword>for</font> (i<font CLASS=symbols>=</font><font CLASS=integer>0</font>; i&lt;<font CLASS=integer>3</font>; i<font CLASS=symbols>++</font>)
<a name="line1297"/>  <font CLASS=comment>1297:</font> 			<font CLASS=keyword>if</font> (i<font CLASS=symbols>!=</font>j) {
<a name="line1298"/>  <font CLASS=comment>1298:</font> 				b.v[i] <font CLASS=symbols>-=</font> a.v[i].n[j]*b.v[j];
<a name="line1299"/>  <font CLASS=comment>1299:</font> 				a.v[i] <font CLASS=symbols>-=</font> a.v[i].n[j]*a.v[j];
<a name="line1300"/>  <font CLASS=comment>1300:</font> 			}
<a name="line1301"/>  <font CLASS=comment>1301:</font> 	}
<a name="line1302"/>  <font CLASS=comment>1302:</font> 	<font CLASS=keyword>return</font> b;
<a name="line1303"/>  <font CLASS=comment>1303:</font> }
<a name="line1304"/>  <font CLASS=comment>1304:</font> 
<a name="line1305"/>  <font CLASS=comment>1305:</font> <font CLASS=keyword>inline</font> mat3&amp; mat3::apply(V_FCT_PTR fct) 
<a name="line1306"/>  <font CLASS=comment>1306:</font> {
<a name="line1307"/>  <font CLASS=comment>1307:</font> 	v[VX].apply(fct);
<a name="line1308"/>  <font CLASS=comment>1308:</font> 	v[VY].apply(fct);
<a name="line1309"/>  <font CLASS=comment>1309:</font> 	v[VZ].apply(fct);
<a name="line1310"/>  <font CLASS=comment>1310:</font> 	<font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>;
<a name="line1311"/>  <font CLASS=comment>1311:</font> }
<a name="line1312"/>  <font CLASS=comment>1312:</font> 
<a name="line1313"/>  <font CLASS=comment>1313:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>void</font> mat3::set( <font CLASS=keyword>const</font> vec3&amp; v0, <font CLASS=keyword>const</font> vec3&amp; v1, <font CLASS=keyword>const</font> vec3&amp; v2 ) 
<a name="line1314"/>  <font CLASS=comment>1314:</font> {
<a name="line1315"/>  <font CLASS=comment>1315:</font> 	v[<font CLASS=integer>0</font>] <font CLASS=symbols>=</font> v0; v[<font CLASS=integer>1</font>] <font CLASS=symbols>=</font> v1; v[<font CLASS=integer>2</font>] = v2; 
<a name="line1316"/>  <font CLASS=comment>1316:</font> }
<a name="line1317"/>  <font CLASS=comment>1317:</font> 
<a name="line1318"/>  <font CLASS=comment>1318:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>double</font> mat3::det() <font CLASS=keyword>const</font>
<a name="line1319"/>  <font CLASS=comment>1319:</font> {
<a name="line1320"/>  <font CLASS=comment>1320:</font> 	mat3 a(*<font CLASS=keyword>this</font>);
<a name="line1321"/>  <font CLASS=comment>1321:</font> 
<a name="line1322"/>  <font CLASS=comment>1322:</font> 	<font CLASS=keyword>return</font> a[<font CLASS=integer>0</font>][<font CLASS=integer>0</font>] * (a[<font CLASS=integer>1</font>][<font CLASS=integer>1</font>] * a[<font CLASS=integer>2</font>][<font CLASS=integer>2</font>] <font CLASS=symbols>-</font> a[<font CLASS=integer>1</font>][<font CLASS=integer>2</font>] * a[<font CLASS=integer>2</font>][<font CLASS=integer>1</font>]) <font CLASS=symbols>+</font>
<a name="line1323"/>  <font CLASS=comment>1323:</font>            a[<font CLASS=integer>0</font>][<font CLASS=integer>1</font>] * (a[<font CLASS=integer>1</font>][<font CLASS=integer>2</font>] * a[<font CLASS=integer>2</font>][<font CLASS=integer>0</font>] <font CLASS=symbols>-</font> a[<font CLASS=integer>1</font>][<font CLASS=integer>0</font>] * a[<font CLASS=integer>2</font>][<font CLASS=integer>2</font>]) <font CLASS=symbols>+</font>
<a name="line1324"/>  <font CLASS=comment>1324:</font>            a[<font CLASS=integer>0</font>][<font CLASS=integer>2</font>] * (a[<font CLASS=integer>1</font>][<font CLASS=integer>0</font>] * a[<font CLASS=integer>2</font>][<font CLASS=integer>1</font>] <font CLASS=symbols>-</font> a[<font CLASS=integer>1</font>][<font CLASS=integer>1</font>] * a[<font CLASS=integer>2</font>][<font CLASS=integer>0</font>]);
<a name="line1325"/>  <font CLASS=comment>1325:</font> }
<a name="line1326"/>  <font CLASS=comment>1326:</font> 
<a name="line1327"/>  <font CLASS=comment>1327:</font> 
<a name="line1328"/>  <font CLASS=comment>1328:</font> <font CLASS=comment>// FRIENDS</font>
<a name="line1329"/>  <font CLASS=comment>1329:</font> 
<a name="line1330"/>  <font CLASS=comment>1330:</font> <font CLASS=keyword>inline</font> mat3 <font CLASS=keyword>operator</font> <font CLASS=symbols>-</font> (<font CLASS=keyword>const</font> mat3&amp; a)
<a name="line1331"/>  <font CLASS=comment>1331:</font> { 
<a name="line1332"/>  <font CLASS=comment>1332:</font> 	<font CLASS=keyword>return</font> mat3(-a.v[<font CLASS=integer>0</font>], -a.v[<font CLASS=integer>1</font>], -a.v[<font CLASS=integer>2</font>]);
<a name="line1333"/>  <font CLASS=comment>1333:</font> }
<a name="line1334"/>  <font CLASS=comment>1334:</font> 
<a name="line1335"/>  <font CLASS=comment>1335:</font> <font CLASS=keyword>inline</font> mat3 <font CLASS=keyword>operator</font> <font CLASS=symbols>+</font> (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> mat3&amp; b)
<a name="line1336"/>  <font CLASS=comment>1336:</font> {
<a name="line1337"/>  <font CLASS=comment>1337:</font> 	<font CLASS=keyword>return</font> mat3(a.v[<font CLASS=integer>0</font>] <font CLASS=symbols>+</font> b.v[<font CLASS=integer>0</font>], a.v[<font CLASS=integer>1</font>] <font CLASS=symbols>+</font> b.v[<font CLASS=integer>1</font>], a.v[<font CLASS=integer>2</font>] + b.v[<font CLASS=integer>2</font>]);
<a name="line1338"/>  <font CLASS=comment>1338:</font> }
<a name="line1339"/>  <font CLASS=comment>1339:</font> 
<a name="line1340"/>  <font CLASS=comment>1340:</font> <font CLASS=keyword>inline</font> mat3 <font CLASS=keyword>operator</font> <font CLASS=symbols>-</font> (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> mat3&amp; b)
<a name="line1341"/>  <font CLASS=comment>1341:</font> { 
<a name="line1342"/>  <font CLASS=comment>1342:</font> 	<font CLASS=keyword>return</font> mat3(a.v[<font CLASS=integer>0</font>] <font CLASS=symbols>-</font> b.v[<font CLASS=integer>0</font>], a.v[<font CLASS=integer>1</font>] <font CLASS=symbols>-</font> b.v[<font CLASS=integer>1</font>], a.v[<font CLASS=integer>2</font>] - b.v[<font CLASS=integer>2</font>]);
<a name="line1343"/>  <font CLASS=comment>1343:</font> }
<a name="line1344"/>  <font CLASS=comment>1344:</font> 
<a name="line1345"/>  <font CLASS=comment>1345:</font> <font CLASS=keyword>inline</font> mat3 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> mat3&amp; b) 
<a name="line1346"/>  <font CLASS=comment>1346:</font> {
<a name="line1347"/>  <font CLASS=comment>1347:</font> <font CLASS=preproc>#define</font> ROWCOL(i, j) \ 
<a name="line1348"/>  <font CLASS=comment>1348:</font> 	a.v[i].n[<font CLASS=integer>0</font>]*b.v[<font CLASS=integer>0</font>][j] <font CLASS=symbols>+</font> a.v[i].n[<font CLASS=integer>1</font>]*b.v[<font CLASS=integer>1</font>][j] <font CLASS=symbols>+</font> a.v[i].n[<font CLASS=integer>2</font>]*b.v[<font CLASS=integer>2</font>][j]
<a name="line1349"/>  <font CLASS=comment>1349:</font> 	<font CLASS=keyword>return</font> mat3(vec3(ROWCOL(<font CLASS=integer>0</font>,<font CLASS=integer>0</font>), ROWCOL(<font CLASS=integer>0</font>,<font CLASS=integer>1</font>), ROWCOL(<font CLASS=integer>0</font>,<font CLASS=integer>2</font>)),
<a name="line1350"/>  <font CLASS=comment>1350:</font> 				vec3(ROWCOL(<font CLASS=integer>1</font>,<font CLASS=integer>0</font>), ROWCOL(<font CLASS=integer>1</font>,<font CLASS=integer>1</font>), ROWCOL(<font CLASS=integer>1</font>,<font CLASS=integer>2</font>)),
<a name="line1351"/>  <font CLASS=comment>1351:</font> 				vec3(ROWCOL(<font CLASS=integer>2</font>,<font CLASS=integer>0</font>), ROWCOL(<font CLASS=integer>2</font>,<font CLASS=integer>1</font>), ROWCOL(<font CLASS=integer>2</font>,<font CLASS=integer>2</font>)));
<a name="line1352"/>  <font CLASS=comment>1352:</font> <font CLASS=preproc>#undef</font> ROWCOL <font CLASS=comment>// (i, j) </font>
<a name="line1353"/>  <font CLASS=comment>1353:</font> }
<a name="line1354"/>  <font CLASS=comment>1354:</font> 
<a name="line1355"/>  <font CLASS=comment>1355:</font> <font CLASS=keyword>inline</font> mat3 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d)
<a name="line1356"/>  <font CLASS=comment>1356:</font> { 
<a name="line1357"/>  <font CLASS=comment>1357:</font> 	<font CLASS=keyword>return</font> mat3(a.v[<font CLASS=integer>0</font>] * d, a.v[<font CLASS=integer>1</font>] * d, a.v[<font CLASS=integer>2</font>] * d);
<a name="line1358"/>  <font CLASS=comment>1358:</font> }
<a name="line1359"/>  <font CLASS=comment>1359:</font> 
<a name="line1360"/>  <font CLASS=comment>1360:</font> <font CLASS=keyword>inline</font> mat3 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d, <font CLASS=keyword>const</font> mat3&amp; a)
<a name="line1361"/>  <font CLASS=comment>1361:</font> { 
<a name="line1362"/>  <font CLASS=comment>1362:</font> 	<font CLASS=keyword>return</font> a*d;
<a name="line1363"/>  <font CLASS=comment>1363:</font> }
<a name="line1364"/>  <font CLASS=comment>1364:</font> 
<a name="line1365"/>  <font CLASS=comment>1365:</font> <font CLASS=keyword>inline</font> mat3 <font CLASS=keyword>operator</font> / (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d)
<a name="line1366"/>  <font CLASS=comment>1366:</font> { 
<a name="line1367"/>  <font CLASS=comment>1367:</font> 	<font CLASS=keyword>return</font> mat3(a.v[<font CLASS=integer>0</font>] / d, a.v[<font CLASS=integer>1</font>] / d, a.v[<font CLASS=integer>2</font>] / d); 
<a name="line1368"/>  <font CLASS=comment>1368:</font> }
<a name="line1369"/>  <font CLASS=comment>1369:</font> 
<a name="line1370"/>  <font CLASS=comment>1370:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>int</font> <font CLASS=keyword>operator</font> <font CLASS=symbols>==</font> (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> mat3&amp; b)
<a name="line1371"/>  <font CLASS=comment>1371:</font> { 
<a name="line1372"/>  <font CLASS=comment>1372:</font> 	<font CLASS=keyword>return</font> (a.v[<font CLASS=integer>0</font>] <font CLASS=symbols>==</font> b.v[<font CLASS=integer>0</font>]) &amp;&amp; (a.v[<font CLASS=integer>1</font>] <font CLASS=symbols>==</font> b.v[<font CLASS=integer>1</font>]) &amp;&amp; (a.v[<font CLASS=integer>2</font>] <font CLASS=symbols>==</font> b.v[<font CLASS=integer>2</font>]); 
<a name="line1373"/>  <font CLASS=comment>1373:</font> }
<a name="line1374"/>  <font CLASS=comment>1374:</font> 
<a name="line1375"/>  <font CLASS=comment>1375:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>int</font> <font CLASS=keyword>operator</font> <font CLASS=symbols>!=</font> (<font CLASS=keyword>const</font> mat3&amp; a, <font CLASS=keyword>const</font> mat3&amp; b)
<a name="line1376"/>  <font CLASS=comment>1376:</font> { 
<a name="line1377"/>  <font CLASS=comment>1377:</font> 	<font CLASS=keyword>return</font> <font CLASS=symbols>!</font>(a <font CLASS=symbols>==</font> b);
<a name="line1378"/>  <font CLASS=comment>1378:</font> }
<a name="line1379"/>  <font CLASS=comment>1379:</font> 
<a name="line1380"/>  <font CLASS=comment>1380:</font> <font CLASS=preproc>#ifdef</font> ALGEBRA3IOSTREAMS 
<a name="line1381"/>  <font CLASS=comment>1381:</font> <font CLASS=keyword>inline</font> ostream&amp; <font CLASS=keyword>operator</font> &lt;&lt; (ostream&amp; s, <font CLASS=keyword>const</font> mat3&amp; m)
<a name="line1382"/>  <font CLASS=comment>1382:</font> {
<a name="line1383"/>  <font CLASS=comment>1383:</font> 	<font CLASS=keyword>return</font> s &lt;&lt; m.v[VX] &lt;&lt; <font CLASS=sinquot>'\n'</font> &lt;&lt; m.v[VY] &lt;&lt; <font CLASS=sinquot>'\n'</font> &lt;&lt; m.v[VZ]; 
<a name="line1384"/>  <font CLASS=comment>1384:</font> }
<a name="line1385"/>  <font CLASS=comment>1385:</font> 
<a name="line1386"/>  <font CLASS=comment>1386:</font> <font CLASS=keyword>inline</font> istream&amp; <font CLASS=keyword>operator</font> &gt;&gt; (istream&amp; s, mat3&amp; m)
<a name="line1387"/>  <font CLASS=comment>1387:</font> {
<a name="line1388"/>  <font CLASS=comment>1388:</font> 	mat3    m_tmp;
<a name="line1389"/>  <font CLASS=comment>1389:</font> 
<a name="line1390"/>  <font CLASS=comment>1390:</font> 	s &gt;&gt; m_tmp[VX] &gt;&gt; m_tmp[VY] &gt;&gt; m_tmp[VZ];
<a name="line1391"/>  <font CLASS=comment>1391:</font> 	<font CLASS=keyword>if</font> (s)
<a name="line1392"/>  <font CLASS=comment>1392:</font> 		m <font CLASS=symbols>=</font> m_tmp;
<a name="line1393"/>  <font CLASS=comment>1393:</font> 	<font CLASS=keyword>return</font> s;
<a name="line1394"/>  <font CLASS=comment>1394:</font> }
<a name="line1395"/>  <font CLASS=comment>1395:</font> <font CLASS=preproc>#endif</font> <font CLASS=comment>// ALGEBRA3IOSTREAMS </font>
<a name="line1396"/>  <font CLASS=comment>1396:</font> 
<a name="line1397"/>  <font CLASS=comment>1397:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>void</font> swap(mat3&amp; a, mat3&amp; b)
<a name="line1398"/>  <font CLASS=comment>1398:</font> { 
<a name="line1399"/>  <font CLASS=comment>1399:</font> 	mat3 tmp(a); a <font CLASS=symbols>=</font> b; b <font CLASS=symbols>=</font> tmp; 
<a name="line1400"/>  <font CLASS=comment>1400:</font> }
<a name="line1401"/>  <font CLASS=comment>1401:</font> 
<a name="line1402"/>  <font CLASS=comment>1402:</font> 
<a name="line1403"/>  <font CLASS=comment>1403:</font> <font CLASS=comment>/****************************************************************
<a name="line1404"/>  <font CLASS=comment>1404:</font> *																*
<a name="line1405"/>  <font CLASS=comment>1405:</font> *		    mat4 member functions								*
<a name="line1406"/>  <font CLASS=comment>1406:</font> *																*
<a name="line1407"/>  <font CLASS=comment>1407:</font> ****************************************************************/</font>
<a name="line1408"/>  <font CLASS=comment>1408:</font> 
<a name="line1409"/>  <font CLASS=comment>1409:</font> <font CLASS=comment>// CONSTRUCTORS</font>
<a name="line1410"/>  <font CLASS=comment>1410:</font> 
<a name="line1411"/>  <font CLASS=comment>1411:</font> <font CLASS=keyword>inline</font> mat4::mat4() {}
<a name="line1412"/>  <font CLASS=comment>1412:</font> 
<a name="line1413"/>  <font CLASS=comment>1413:</font> <font CLASS=keyword>inline</font> mat4::mat4(<font CLASS=keyword>const</font> vec4&amp; v0, <font CLASS=keyword>const</font> vec4&amp; v1, <font CLASS=keyword>const</font> vec4&amp; v2, <font CLASS=keyword>const</font> vec4&amp; v3)
<a name="line1414"/>  <font CLASS=comment>1414:</font> { 
<a name="line1415"/>  <font CLASS=comment>1415:</font> 	v[<font CLASS=integer>0</font>] <font CLASS=symbols>=</font> v0; v[<font CLASS=integer>1</font>] <font CLASS=symbols>=</font> v1; v[<font CLASS=integer>2</font>] = v2; v[<font CLASS=integer>3</font>] = v3; 
<a name="line1416"/>  <font CLASS=comment>1416:</font> }
<a name="line1417"/>  <font CLASS=comment>1417:</font> 
<a name="line1418"/>  <font CLASS=comment>1418:</font> <font CLASS=keyword>inline</font> mat4::mat4(<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d)
<a name="line1419"/>  <font CLASS=comment>1419:</font> { 
<a name="line1420"/>  <font CLASS=comment>1420:</font> 	v[<font CLASS=integer>0</font>] <font CLASS=symbols>=</font> v[<font CLASS=integer>1</font>] <font CLASS=symbols>=</font> v[<font CLASS=integer>2</font>] = v[<font CLASS=integer>3</font>] = vec4(d);
<a name="line1421"/>  <font CLASS=comment>1421:</font> }
<a name="line1422"/>  <font CLASS=comment>1422:</font> 
<a name="line1423"/>  <font CLASS=comment>1423:</font> <font CLASS=keyword>inline</font> mat4::mat4(<font CLASS=keyword>const</font> mat4&amp; m)
<a name="line1424"/>  <font CLASS=comment>1424:</font> { 
<a name="line1425"/>  <font CLASS=comment>1425:</font> 	v[<font CLASS=integer>0</font>] <font CLASS=symbols>=</font> m.v[<font CLASS=integer>0</font>]; v[<font CLASS=integer>1</font>] <font CLASS=symbols>=</font> m.v[<font CLASS=integer>1</font>]; v[<font CLASS=integer>2</font>] = m.v[<font CLASS=integer>2</font>]; v[<font CLASS=integer>3</font>] <font CLASS=symbols>=</font> m.v[<font CLASS=integer>3</font>];
<a name="line1426"/>  <font CLASS=comment>1426:</font> }
<a name="line1427"/>  <font CLASS=comment>1427:</font> 
<a name="line1428"/>  <font CLASS=comment>1428:</font> 
<a name="line1429"/>  <font CLASS=comment>1429:</font> <font CLASS=comment>// ASSIGNMENT OPERATORS</font>
<a name="line1430"/>  <font CLASS=comment>1430:</font> 
<a name="line1431"/>  <font CLASS=comment>1431:</font> <font CLASS=keyword>inline</font> mat4&amp; mat4::<font CLASS=keyword>operator</font> <font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> mat4&amp; m )
<a name="line1432"/>  <font CLASS=comment>1432:</font> { 
<a name="line1433"/>  <font CLASS=comment>1433:</font> 	v[<font CLASS=integer>0</font>] <font CLASS=symbols>=</font> m.v[<font CLASS=integer>0</font>]; v[<font CLASS=integer>1</font>] <font CLASS=symbols>=</font> m.v[<font CLASS=integer>1</font>]; v[<font CLASS=integer>2</font>] = m.v[<font CLASS=integer>2</font>]; v[<font CLASS=integer>3</font>] <font CLASS=symbols>=</font> m.v[<font CLASS=integer>3</font>];
<a name="line1434"/>  <font CLASS=comment>1434:</font> 	<font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>;
<a name="line1435"/>  <font CLASS=comment>1435:</font> }
<a name="line1436"/>  <font CLASS=comment>1436:</font> 
<a name="line1437"/>  <font CLASS=comment>1437:</font> <font CLASS=keyword>inline</font> mat4&amp; mat4::<font CLASS=keyword>operator</font> <font CLASS=symbols>+=</font> ( <font CLASS=keyword>const</font> mat4&amp; m )
<a name="line1438"/>  <font CLASS=comment>1438:</font> { 
<a name="line1439"/>  <font CLASS=comment>1439:</font> 	v[<font CLASS=integer>0</font>] <font CLASS=symbols>+=</font> m.v[<font CLASS=integer>0</font>]; v[<font CLASS=integer>1</font>] <font CLASS=symbols>+=</font> m.v[<font CLASS=integer>1</font>]; v[<font CLASS=integer>2</font>] += m.v[<font CLASS=integer>2</font>]; v[<font CLASS=integer>3</font>] <font CLASS=symbols>+=</font> m.v[<font CLASS=integer>3</font>];
<a name="line1440"/>  <font CLASS=comment>1440:</font> 	<font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>; 
<a name="line1441"/>  <font CLASS=comment>1441:</font> }
<a name="line1442"/>  <font CLASS=comment>1442:</font> 
<a name="line1443"/>  <font CLASS=comment>1443:</font> <font CLASS=keyword>inline</font> mat4&amp; mat4::<font CLASS=keyword>operator</font> <font CLASS=symbols>-=</font> ( <font CLASS=keyword>const</font> mat4&amp; m )
<a name="line1444"/>  <font CLASS=comment>1444:</font> { 
<a name="line1445"/>  <font CLASS=comment>1445:</font> 	v[<font CLASS=integer>0</font>] <font CLASS=symbols>-=</font> m.v[<font CLASS=integer>0</font>]; v[<font CLASS=integer>1</font>] <font CLASS=symbols>-=</font> m.v[<font CLASS=integer>1</font>]; v[<font CLASS=integer>2</font>] -= m.v[<font CLASS=integer>2</font>]; v[<font CLASS=integer>3</font>] <font CLASS=symbols>-=</font> m.v[<font CLASS=integer>3</font>];
<a name="line1446"/>  <font CLASS=comment>1446:</font> 	<font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>;
<a name="line1447"/>  <font CLASS=comment>1447:</font> }
<a name="line1448"/>  <font CLASS=comment>1448:</font> 
<a name="line1449"/>  <font CLASS=comment>1449:</font> <font CLASS=keyword>inline</font> mat4&amp; mat4::<font CLASS=keyword>operator</font> *<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d )
<a name="line1450"/>  <font CLASS=comment>1450:</font> {
<a name="line1451"/>  <font CLASS=comment>1451:</font> 	v[<font CLASS=integer>0</font>] *<font CLASS=symbols>=</font> d; v[<font CLASS=integer>1</font>] *<font CLASS=symbols>=</font> d; v[<font CLASS=integer>2</font>] *= d; v[<font CLASS=integer>3</font>] *= d; <font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>;
<a name="line1452"/>  <font CLASS=comment>1452:</font> }
<a name="line1453"/>  <font CLASS=comment>1453:</font> 
<a name="line1454"/>  <font CLASS=comment>1454:</font> <font CLASS=keyword>inline</font> mat4&amp; mat4::<font CLASS=keyword>operator</font> /<font CLASS=symbols>=</font> ( <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d )
<a name="line1455"/>  <font CLASS=comment>1455:</font> { 
<a name="line1456"/>  <font CLASS=comment>1456:</font> 	v[<font CLASS=integer>0</font>] /<font CLASS=symbols>=</font> d; v[<font CLASS=integer>1</font>] /<font CLASS=symbols>=</font> d; v[<font CLASS=integer>2</font>] /= d; v[<font CLASS=integer>3</font>] /= d; <font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>;
<a name="line1457"/>  <font CLASS=comment>1457:</font> }
<a name="line1458"/>  <font CLASS=comment>1458:</font> 
<a name="line1459"/>  <font CLASS=comment>1459:</font> <font CLASS=keyword>inline</font> vec4&amp; mat4::<font CLASS=keyword>operator</font> [] ( <font CLASS=keytype>int</font> i)
<a name="line1460"/>  <font CLASS=comment>1460:</font> {
<a name="line1461"/>  <font CLASS=comment>1461:</font> 	assert(<font CLASS=symbols>!</font> (i &lt; VX <font CLASS=symbols>||</font> i &gt; VW));
<a name="line1462"/>  <font CLASS=comment>1462:</font> 	<font CLASS=keyword>return</font> v[i];
<a name="line1463"/>  <font CLASS=comment>1463:</font> }
<a name="line1464"/>  <font CLASS=comment>1464:</font> 
<a name="line1465"/>  <font CLASS=comment>1465:</font> <font CLASS=keyword>inline</font> <font CLASS=keyword>const</font> vec4&amp; mat4::<font CLASS=keyword>operator</font> [] ( <font CLASS=keytype>int</font> i) <font CLASS=keyword>const</font> 
<a name="line1466"/>  <font CLASS=comment>1466:</font> {
<a name="line1467"/>  <font CLASS=comment>1467:</font> 	assert(<font CLASS=symbols>!</font> (i &lt; VX <font CLASS=symbols>||</font> i &gt; VW));
<a name="line1468"/>  <font CLASS=comment>1468:</font> 	<font CLASS=keyword>return</font> v[i];
<a name="line1469"/>  <font CLASS=comment>1469:</font> }
<a name="line1470"/>  <font CLASS=comment>1470:</font> 
<a name="line1471"/>  <font CLASS=comment>1471:</font> <font CLASS=comment>// SPECIAL FUNCTIONS;</font>
<a name="line1472"/>  <font CLASS=comment>1472:</font> 
<a name="line1473"/>  <font CLASS=comment>1473:</font> <font CLASS=keyword>inline</font> mat4 mat4::transpose() <font CLASS=keyword>const</font>
<a name="line1474"/>  <font CLASS=comment>1474:</font> {
<a name="line1475"/>  <font CLASS=comment>1475:</font> 	<font CLASS=keyword>return</font> mat4(vec4(v[<font CLASS=integer>0</font>][<font CLASS=integer>0</font>], v[<font CLASS=integer>1</font>][<font CLASS=integer>0</font>], v[<font CLASS=integer>2</font>][<font CLASS=integer>0</font>], v[<font CLASS=integer>3</font>][<font CLASS=integer>0</font>]),
<a name="line1476"/>  <font CLASS=comment>1476:</font> 				vec4(v[<font CLASS=integer>0</font>][<font CLASS=integer>1</font>], v[<font CLASS=integer>1</font>][<font CLASS=integer>1</font>], v[<font CLASS=integer>2</font>][<font CLASS=integer>1</font>], v[<font CLASS=integer>3</font>][<font CLASS=integer>1</font>]),
<a name="line1477"/>  <font CLASS=comment>1477:</font> 				vec4(v[<font CLASS=integer>0</font>][<font CLASS=integer>2</font>], v[<font CLASS=integer>1</font>][<font CLASS=integer>2</font>], v[<font CLASS=integer>2</font>][<font CLASS=integer>2</font>], v[<font CLASS=integer>3</font>][<font CLASS=integer>2</font>]),
<a name="line1478"/>  <font CLASS=comment>1478:</font> 				vec4(v[<font CLASS=integer>0</font>][<font CLASS=integer>3</font>], v[<font CLASS=integer>1</font>][<font CLASS=integer>3</font>], v[<font CLASS=integer>2</font>][<font CLASS=integer>3</font>], v[<font CLASS=integer>3</font>][<font CLASS=integer>3</font>]));
<a name="line1479"/>  <font CLASS=comment>1479:</font> }
<a name="line1480"/>  <font CLASS=comment>1480:</font> 
<a name="line1481"/>  <font CLASS=comment>1481:</font> <font CLASS=keyword>inline</font> mat4 mat4::inverse()	<font CLASS=keyword>const</font>    <font CLASS=comment>// Gauss-Jordan elimination with partial pivoting</font>
<a name="line1482"/>  <font CLASS=comment>1482:</font> {
<a name="line1483"/>  <font CLASS=comment>1483:</font> 	mat4 a(*<font CLASS=keyword>this</font>),	    <font CLASS=comment>// As a evolves from original mat into identity</font>
<a name="line1484"/>  <font CLASS=comment>1484:</font> 		b(identity3D());   <font CLASS=comment>// b evolves from identity into inverse(a)</font>
<a name="line1485"/>  <font CLASS=comment>1485:</font> 	<font CLASS=keytype>int</font> i, j, i1;
<a name="line1486"/>  <font CLASS=comment>1486:</font> 
<a name="line1487"/>  <font CLASS=comment>1487:</font> 	<font CLASS=comment>// Loop over cols of a from left to right, eliminating above and below diag</font>
<a name="line1488"/>  <font CLASS=comment>1488:</font> 	<font CLASS=keyword>for</font> (j<font CLASS=symbols>=</font><font CLASS=integer>0</font>; j&lt;<font CLASS=integer>4</font>; j<font CLASS=symbols>++</font>) {   <font CLASS=comment>// Find largest pivot in column j among rows j..3</font>
<a name="line1489"/>  <font CLASS=comment>1489:</font> 		i1 <font CLASS=symbols>=</font> j;		    <font CLASS=comment>// Row with largest pivot candidate</font>
<a name="line1490"/>  <font CLASS=comment>1490:</font> 		<font CLASS=keyword>for</font> (i=j<font CLASS=symbols>+</font><font CLASS=integer>1</font>; i&lt;<font CLASS=integer>4</font>; i<font CLASS=symbols>++</font>)
<a name="line1491"/>  <font CLASS=comment>1491:</font> 			<font CLASS=keyword>if</font> (fabs(a.v[i].n[j]) &gt; fabs(a.v[i1].n[j]))
<a name="line1492"/>  <font CLASS=comment>1492:</font> 				i1 <font CLASS=symbols>=</font> i;
<a name="line1493"/>  <font CLASS=comment>1493:</font> 
<a name="line1494"/>  <font CLASS=comment>1494:</font> 		<font CLASS=comment>// Swap rows i1 and j in a and b to put pivot on diagonal</font>
<a name="line1495"/>  <font CLASS=comment>1495:</font> 		swap(a.v[i1], a.v[j]);
<a name="line1496"/>  <font CLASS=comment>1496:</font> 		swap(b.v[i1], b.v[j]);
<a name="line1497"/>  <font CLASS=comment>1497:</font> 
<a name="line1498"/>  <font CLASS=comment>1498:</font> 		<font CLASS=comment>// Scale row j to have a unit diagonal</font>
<a name="line1499"/>  <font CLASS=comment>1499:</font> 		<font CLASS=keyword>if</font> (a.v[j].n[j]<font CLASS=symbols>==</font><font CLASS=integer>0</font>.)
<a name="line1500"/>  <font CLASS=comment>1500:</font> 			ALGEBRA_ERROR(<font CLASS=dblquot>"mat4::inverse: singular matrix; can't invert\n"</font>);
<a name="line1501"/>  <font CLASS=comment>1501:</font> 		b.v[j] /<font CLASS=symbols>=</font> a.v[j].n[j];
<a name="line1502"/>  <font CLASS=comment>1502:</font> 		a.v[j] /<font CLASS=symbols>=</font> a.v[j].n[j];
<a name="line1503"/>  <font CLASS=comment>1503:</font> 
<a name="line1504"/>  <font CLASS=comment>1504:</font> 		<font CLASS=comment>// Eliminate off-diagonal elems in col j of a, doing identical ops to b</font>
<a name="line1505"/>  <font CLASS=comment>1505:</font> 		<font CLASS=keyword>for</font> (i<font CLASS=symbols>=</font><font CLASS=integer>0</font>; i&lt;<font CLASS=integer>4</font>; i<font CLASS=symbols>++</font>)
<a name="line1506"/>  <font CLASS=comment>1506:</font> 			<font CLASS=keyword>if</font> (i<font CLASS=symbols>!=</font>j) {
<a name="line1507"/>  <font CLASS=comment>1507:</font> 				b.v[i] <font CLASS=symbols>-=</font> a.v[i].n[j]*b.v[j];
<a name="line1508"/>  <font CLASS=comment>1508:</font> 				a.v[i] <font CLASS=symbols>-=</font> a.v[i].n[j]*a.v[j];
<a name="line1509"/>  <font CLASS=comment>1509:</font> 			}
<a name="line1510"/>  <font CLASS=comment>1510:</font> 	}
<a name="line1511"/>  <font CLASS=comment>1511:</font> 	<font CLASS=keyword>return</font> b;
<a name="line1512"/>  <font CLASS=comment>1512:</font> }
<a name="line1513"/>  <font CLASS=comment>1513:</font> 
<a name="line1514"/>  <font CLASS=comment>1514:</font> <font CLASS=keyword>inline</font> mat4&amp; mat4::apply(V_FCT_PTR fct)
<a name="line1515"/>  <font CLASS=comment>1515:</font> { 
<a name="line1516"/>  <font CLASS=comment>1516:</font> 	v[VX].apply(fct); v[VY].apply(fct); v[VZ].apply(fct); v[VW].apply(fct);
<a name="line1517"/>  <font CLASS=comment>1517:</font> 	<font CLASS=keyword>return</font> *<font CLASS=keyword>this</font>;
<a name="line1518"/>  <font CLASS=comment>1518:</font> }
<a name="line1519"/>  <font CLASS=comment>1519:</font> 
<a name="line1520"/>  <font CLASS=comment>1520:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>void</font> mat4::swap_rows( <font CLASS=keytype>int</font> i, <font CLASS=keytype>int</font> j )
<a name="line1521"/>  <font CLASS=comment>1521:</font> {
<a name="line1522"/>  <font CLASS=comment>1522:</font> 	vec4 t;
<a name="line1523"/>  <font CLASS=comment>1523:</font> 
<a name="line1524"/>  <font CLASS=comment>1524:</font> 	t <font CLASS=symbols>=</font> v[i];
<a name="line1525"/>  <font CLASS=comment>1525:</font> 	v[i] <font CLASS=symbols>=</font> v[j];
<a name="line1526"/>  <font CLASS=comment>1526:</font> 	v[j] <font CLASS=symbols>=</font> t;
<a name="line1527"/>  <font CLASS=comment>1527:</font> }
<a name="line1528"/>  <font CLASS=comment>1528:</font> 
<a name="line1529"/>  <font CLASS=comment>1529:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>void</font> mat4::swap_cols( <font CLASS=keytype>int</font> i, <font CLASS=keytype>int</font> j )
<a name="line1530"/>  <font CLASS=comment>1530:</font> {
<a name="line1531"/>  <font CLASS=comment>1531:</font> 	<font CLASS=keytype>float</font> t;
<a name="line1532"/>  <font CLASS=comment>1532:</font> 	<font CLASS=keytype>int</font> k;
<a name="line1533"/>  <font CLASS=comment>1533:</font> 
<a name="line1534"/>  <font CLASS=comment>1534:</font> 	<font CLASS=keyword>for</font>(k<font CLASS=symbols>=</font><font CLASS=integer>0</font>; k&lt;<font CLASS=integer>4</font>; k<font CLASS=symbols>++</font> ) {
<a name="line1535"/>  <font CLASS=comment>1535:</font> 		t       <font CLASS=symbols>=</font> v[k][i];
<a name="line1536"/>  <font CLASS=comment>1536:</font> 		v[k][i] <font CLASS=symbols>=</font> v[k][j];
<a name="line1537"/>  <font CLASS=comment>1537:</font> 		v[k][j] <font CLASS=symbols>=</font> t;
<a name="line1538"/>  <font CLASS=comment>1538:</font> 	}
<a name="line1539"/>  <font CLASS=comment>1539:</font> }
<a name="line1540"/>  <font CLASS=comment>1540:</font> 
<a name="line1541"/>  <font CLASS=comment>1541:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>double</font> mat4::det() <font CLASS=keyword>const</font>
<a name="line1542"/>  <font CLASS=comment>1542:</font> {
<a name="line1543"/>  <font CLASS=comment>1543:</font> 	mat4 a(*<font CLASS=keyword>this</font>);
<a name="line1544"/>  <font CLASS=comment>1544:</font> 
<a name="line1545"/>  <font CLASS=comment>1545:</font> 	<font CLASS=keyword>return</font> a[<font CLASS=integer>0</font>][<font CLASS=integer>0</font>] * (a[<font CLASS=integer>1</font>][<font CLASS=integer>1</font>] * (a[<font CLASS=integer>2</font>][<font CLASS=integer>2</font>] * a[<font CLASS=integer>3</font>][<font CLASS=integer>3</font>] <font CLASS=symbols>-</font> a[<font CLASS=integer>3</font>][<font CLASS=integer>2</font>] * a[<font CLASS=integer>2</font>][<font CLASS=integer>3</font>]) <font CLASS=symbols>-</font>
<a name="line1546"/>  <font CLASS=comment>1546:</font> 					  a[<font CLASS=integer>1</font>][<font CLASS=integer>2</font>] * (a[<font CLASS=integer>2</font>][<font CLASS=integer>1</font>] * a[<font CLASS=integer>3</font>][<font CLASS=integer>3</font>] <font CLASS=symbols>-</font> a[<font CLASS=integer>3</font>][<font CLASS=integer>1</font>] * a[<font CLASS=integer>2</font>][<font CLASS=integer>3</font>]) <font CLASS=symbols>+</font>
<a name="line1547"/>  <font CLASS=comment>1547:</font> 					  a[<font CLASS=integer>1</font>][<font CLASS=integer>3</font>] * (a[<font CLASS=integer>2</font>][<font CLASS=integer>1</font>] * a[<font CLASS=integer>3</font>][<font CLASS=integer>2</font>] <font CLASS=symbols>-</font> a[<font CLASS=integer>3</font>][<font CLASS=integer>1</font>] * a[<font CLASS=integer>2</font>][<font CLASS=integer>2</font>])) <font CLASS=symbols>-</font>
<a name="line1548"/>  <font CLASS=comment>1548:</font>            a[<font CLASS=integer>0</font>][<font CLASS=integer>1</font>] * (a[<font CLASS=integer>1</font>][<font CLASS=integer>0</font>] * (a[<font CLASS=integer>2</font>][<font CLASS=integer>2</font>] * a[<font CLASS=integer>3</font>][<font CLASS=integer>3</font>] <font CLASS=symbols>-</font> a[<font CLASS=integer>3</font>][<font CLASS=integer>2</font>] * a[<font CLASS=integer>2</font>][<font CLASS=integer>3</font>]) <font CLASS=symbols>-</font>
<a name="line1549"/>  <font CLASS=comment>1549:</font> 					  a[<font CLASS=integer>1</font>][<font CLASS=integer>2</font>] * (a[<font CLASS=integer>2</font>][<font CLASS=integer>0</font>] * a[<font CLASS=integer>3</font>][<font CLASS=integer>3</font>] <font CLASS=symbols>-</font> a[<font CLASS=integer>3</font>][<font CLASS=integer>0</font>] * a[<font CLASS=integer>2</font>][<font CLASS=integer>3</font>]) <font CLASS=symbols>+</font>
<a name="line1550"/>  <font CLASS=comment>1550:</font> 					  a[<font CLASS=integer>1</font>][<font CLASS=integer>3</font>] * (a[<font CLASS=integer>2</font>][<font CLASS=integer>0</font>] * a[<font CLASS=integer>3</font>][<font CLASS=integer>2</font>] <font CLASS=symbols>-</font> a[<font CLASS=integer>3</font>][<font CLASS=integer>0</font>] * a[<font CLASS=integer>2</font>][<font CLASS=integer>2</font>])) <font CLASS=symbols>+</font>
<a name="line1551"/>  <font CLASS=comment>1551:</font>            a[<font CLASS=integer>0</font>][<font CLASS=integer>2</font>] * (a[<font CLASS=integer>1</font>][<font CLASS=integer>0</font>] * (a[<font CLASS=integer>2</font>][<font CLASS=integer>1</font>] * a[<font CLASS=integer>3</font>][<font CLASS=integer>3</font>] <font CLASS=symbols>-</font> a[<font CLASS=integer>3</font>][<font CLASS=integer>1</font>] * a[<font CLASS=integer>2</font>][<font CLASS=integer>3</font>]) <font CLASS=symbols>-</font>
<a name="line1552"/>  <font CLASS=comment>1552:</font> 					  a[<font CLASS=integer>1</font>][<font CLASS=integer>1</font>] * (a[<font CLASS=integer>2</font>][<font CLASS=integer>0</font>] * a[<font CLASS=integer>3</font>][<font CLASS=integer>3</font>] <font CLASS=symbols>-</font> a[<font CLASS=integer>3</font>][<font CLASS=integer>0</font>] * a[<font CLASS=integer>2</font>][<font CLASS=integer>3</font>]) <font CLASS=symbols>+</font>
<a name="line1553"/>  <font CLASS=comment>1553:</font> 					  a[<font CLASS=integer>1</font>][<font CLASS=integer>3</font>] * (a[<font CLASS=integer>2</font>][<font CLASS=integer>0</font>] * a[<font CLASS=integer>3</font>][<font CLASS=integer>1</font>] <font CLASS=symbols>-</font> a[<font CLASS=integer>3</font>][<font CLASS=integer>0</font>] * a[<font CLASS=integer>2</font>][<font CLASS=integer>1</font>])) <font CLASS=symbols>-</font>
<a name="line1554"/>  <font CLASS=comment>1554:</font>            a[<font CLASS=integer>0</font>][<font CLASS=integer>3</font>] * (a[<font CLASS=integer>1</font>][<font CLASS=integer>0</font>] * (a[<font CLASS=integer>2</font>][<font CLASS=integer>1</font>] * a[<font CLASS=integer>3</font>][<font CLASS=integer>2</font>] <font CLASS=symbols>-</font> a[<font CLASS=integer>3</font>][<font CLASS=integer>1</font>] * a[<font CLASS=integer>2</font>][<font CLASS=integer>2</font>]) <font CLASS=symbols>-</font>
<a name="line1555"/>  <font CLASS=comment>1555:</font> 					  a[<font CLASS=integer>1</font>][<font CLASS=integer>1</font>] * (a[<font CLASS=integer>2</font>][<font CLASS=integer>0</font>] * a[<font CLASS=integer>3</font>][<font CLASS=integer>2</font>] <font CLASS=symbols>-</font> a[<font CLASS=integer>3</font>][<font CLASS=integer>0</font>] * a[<font CLASS=integer>2</font>][<font CLASS=integer>2</font>]) <font CLASS=symbols>+</font>
<a name="line1556"/>  <font CLASS=comment>1556:</font> 					  a[<font CLASS=integer>1</font>][<font CLASS=integer>2</font>] * (a[<font CLASS=integer>2</font>][<font CLASS=integer>0</font>] * a[<font CLASS=integer>3</font>][<font CLASS=integer>1</font>] <font CLASS=symbols>-</font> a[<font CLASS=integer>3</font>][<font CLASS=integer>0</font>] * a[<font CLASS=integer>2</font>][<font CLASS=integer>1</font>]));
<a name="line1557"/>  <font CLASS=comment>1557:</font> }
<a name="line1558"/>  <font CLASS=comment>1558:</font> 
<a name="line1559"/>  <font CLASS=comment>1559:</font> 
<a name="line1560"/>  <font CLASS=comment>1560:</font> <font CLASS=comment>// FRIENDS</font>
<a name="line1561"/>  <font CLASS=comment>1561:</font> 
<a name="line1562"/>  <font CLASS=comment>1562:</font> <font CLASS=keyword>inline</font> mat4 <font CLASS=keyword>operator</font> <font CLASS=symbols>-</font> (<font CLASS=keyword>const</font> mat4&amp; a)
<a name="line1563"/>  <font CLASS=comment>1563:</font> { 
<a name="line1564"/>  <font CLASS=comment>1564:</font> 	<font CLASS=keyword>return</font> mat4(-a.v[<font CLASS=integer>0</font>], -a.v[<font CLASS=integer>1</font>], -a.v[<font CLASS=integer>2</font>], -a.v[<font CLASS=integer>3</font>]);
<a name="line1565"/>  <font CLASS=comment>1565:</font> }
<a name="line1566"/>  <font CLASS=comment>1566:</font> 
<a name="line1567"/>  <font CLASS=comment>1567:</font> <font CLASS=keyword>inline</font> mat4 <font CLASS=keyword>operator</font> <font CLASS=symbols>+</font> (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> mat4&amp; b)
<a name="line1568"/>  <font CLASS=comment>1568:</font> { 
<a name="line1569"/>  <font CLASS=comment>1569:</font> 	<font CLASS=keyword>return</font> mat4(a.v[<font CLASS=integer>0</font>] <font CLASS=symbols>+</font> b.v[<font CLASS=integer>0</font>], a.v[<font CLASS=integer>1</font>] <font CLASS=symbols>+</font> b.v[<font CLASS=integer>1</font>], a.v[<font CLASS=integer>2</font>] + b.v[<font CLASS=integer>2</font>], a.v[<font CLASS=integer>3</font>] <font CLASS=symbols>+</font> b.v[<font CLASS=integer>3</font>]);
<a name="line1570"/>  <font CLASS=comment>1570:</font> }
<a name="line1571"/>  <font CLASS=comment>1571:</font> 
<a name="line1572"/>  <font CLASS=comment>1572:</font> <font CLASS=keyword>inline</font> mat4 <font CLASS=keyword>operator</font> <font CLASS=symbols>-</font> (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> mat4&amp; b)
<a name="line1573"/>  <font CLASS=comment>1573:</font> { 
<a name="line1574"/>  <font CLASS=comment>1574:</font> 	<font CLASS=keyword>return</font> mat4(a.v[<font CLASS=integer>0</font>] <font CLASS=symbols>-</font> b.v[<font CLASS=integer>0</font>], a.v[<font CLASS=integer>1</font>] <font CLASS=symbols>-</font> b.v[<font CLASS=integer>1</font>], a.v[<font CLASS=integer>2</font>] - b.v[<font CLASS=integer>2</font>], a.v[<font CLASS=integer>3</font>] <font CLASS=symbols>-</font> b.v[<font CLASS=integer>3</font>]);
<a name="line1575"/>  <font CLASS=comment>1575:</font> }
<a name="line1576"/>  <font CLASS=comment>1576:</font> 
<a name="line1577"/>  <font CLASS=comment>1577:</font> <font CLASS=keyword>inline</font> mat4 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> mat4&amp; b)
<a name="line1578"/>  <font CLASS=comment>1578:</font> {
<a name="line1579"/>  <font CLASS=comment>1579:</font> <font CLASS=preproc>#define</font> ROWCOL(i, j) a.v[i].n[<font CLASS=integer>0</font>]*b.v[<font CLASS=integer>0</font>][j] <font CLASS=symbols>+</font> a.v[i].n[<font CLASS=integer>1</font>]*b.v[<font CLASS=integer>1</font>][j] <font CLASS=symbols>+</font> \ 
<a name="line1580"/>  <font CLASS=comment>1580:</font> 					 a.v[i].n[<font CLASS=integer>2</font>]*b.v[<font CLASS=integer>2</font>][j] <font CLASS=symbols>+</font> a.v[i].n[<font CLASS=integer>3</font>]*b.v[<font CLASS=integer>3</font>][j]
<a name="line1581"/>  <font CLASS=comment>1581:</font> 					 <font CLASS=keyword>return</font> mat4(
<a name="line1582"/>  <font CLASS=comment>1582:</font> 						 vec4(ROWCOL(<font CLASS=integer>0</font>,<font CLASS=integer>0</font>), ROWCOL(<font CLASS=integer>0</font>,<font CLASS=integer>1</font>), ROWCOL(<font CLASS=integer>0</font>,<font CLASS=integer>2</font>), ROWCOL(<font CLASS=integer>0</font>,<font CLASS=integer>3</font>)),
<a name="line1583"/>  <font CLASS=comment>1583:</font> 						 vec4(ROWCOL(<font CLASS=integer>1</font>,<font CLASS=integer>0</font>), ROWCOL(<font CLASS=integer>1</font>,<font CLASS=integer>1</font>), ROWCOL(<font CLASS=integer>1</font>,<font CLASS=integer>2</font>), ROWCOL(<font CLASS=integer>1</font>,<font CLASS=integer>3</font>)),
<a name="line1584"/>  <font CLASS=comment>1584:</font> 						 vec4(ROWCOL(<font CLASS=integer>2</font>,<font CLASS=integer>0</font>), ROWCOL(<font CLASS=integer>2</font>,<font CLASS=integer>1</font>), ROWCOL(<font CLASS=integer>2</font>,<font CLASS=integer>2</font>), ROWCOL(<font CLASS=integer>2</font>,<font CLASS=integer>3</font>)),
<a name="line1585"/>  <font CLASS=comment>1585:</font> 						 vec4(ROWCOL(<font CLASS=integer>3</font>,<font CLASS=integer>0</font>), ROWCOL(<font CLASS=integer>3</font>,<font CLASS=integer>1</font>), ROWCOL(<font CLASS=integer>3</font>,<font CLASS=integer>2</font>), ROWCOL(<font CLASS=integer>3</font>,<font CLASS=integer>3</font>))
<a name="line1586"/>  <font CLASS=comment>1586:</font> 						 );
<a name="line1587"/>  <font CLASS=comment>1587:</font> <font CLASS=preproc>#undef</font> ROWCOL 
<a name="line1588"/>  <font CLASS=comment>1588:</font> }
<a name="line1589"/>  <font CLASS=comment>1589:</font> 
<a name="line1590"/>  <font CLASS=comment>1590:</font> <font CLASS=keyword>inline</font> mat4 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d)
<a name="line1591"/>  <font CLASS=comment>1591:</font> { 
<a name="line1592"/>  <font CLASS=comment>1592:</font> 	<font CLASS=keyword>return</font> mat4(a.v[<font CLASS=integer>0</font>] * d, a.v[<font CLASS=integer>1</font>] * d, a.v[<font CLASS=integer>2</font>] * d, a.v[<font CLASS=integer>3</font>] * d); 
<a name="line1593"/>  <font CLASS=comment>1593:</font> }
<a name="line1594"/>  <font CLASS=comment>1594:</font> 
<a name="line1595"/>  <font CLASS=comment>1595:</font> <font CLASS=keyword>inline</font> mat4 <font CLASS=keyword>operator</font> * (<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d, <font CLASS=keyword>const</font> mat4&amp; a)
<a name="line1596"/>  <font CLASS=comment>1596:</font> { 
<a name="line1597"/>  <font CLASS=comment>1597:</font> 	<font CLASS=keyword>return</font> a*d; 
<a name="line1598"/>  <font CLASS=comment>1598:</font> }
<a name="line1599"/>  <font CLASS=comment>1599:</font> 
<a name="line1600"/>  <font CLASS=comment>1600:</font> <font CLASS=keyword>inline</font> mat4 <font CLASS=keyword>operator</font> / (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d)
<a name="line1601"/>  <font CLASS=comment>1601:</font> { 
<a name="line1602"/>  <font CLASS=comment>1602:</font> 	<font CLASS=keyword>return</font> mat4(a.v[<font CLASS=integer>0</font>] / d, a.v[<font CLASS=integer>1</font>] / d, a.v[<font CLASS=integer>2</font>] / d, a.v[<font CLASS=integer>3</font>] / d); 
<a name="line1603"/>  <font CLASS=comment>1603:</font> }
<a name="line1604"/>  <font CLASS=comment>1604:</font> 
<a name="line1605"/>  <font CLASS=comment>1605:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>int</font> <font CLASS=keyword>operator</font> <font CLASS=symbols>==</font> (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> mat4&amp; b)
<a name="line1606"/>  <font CLASS=comment>1606:</font> { 
<a name="line1607"/>  <font CLASS=comment>1607:</font> 	<font CLASS=keyword>return</font> ((a.v[<font CLASS=integer>0</font>] <font CLASS=symbols>==</font> b.v[<font CLASS=integer>0</font>]) &amp;&amp; (a.v[<font CLASS=integer>1</font>] <font CLASS=symbols>==</font> b.v[<font CLASS=integer>1</font>]) &amp;&amp; (a.v[<font CLASS=integer>2</font>] <font CLASS=symbols>==</font> b.v[<font CLASS=integer>2</font>]) &amp;&amp; (a.v[<font CLASS=integer>3</font>] == b.v[<font CLASS=integer>3</font>]));
<a name="line1608"/>  <font CLASS=comment>1608:</font> }
<a name="line1609"/>  <font CLASS=comment>1609:</font> 
<a name="line1610"/>  <font CLASS=comment>1610:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>int</font> <font CLASS=keyword>operator</font> <font CLASS=symbols>!=</font> (<font CLASS=keyword>const</font> mat4&amp; a, <font CLASS=keyword>const</font> mat4&amp; b)
<a name="line1611"/>  <font CLASS=comment>1611:</font> { 
<a name="line1612"/>  <font CLASS=comment>1612:</font> 	<font CLASS=keyword>return</font> <font CLASS=symbols>!</font>(a <font CLASS=symbols>==</font> b);
<a name="line1613"/>  <font CLASS=comment>1613:</font> }
<a name="line1614"/>  <font CLASS=comment>1614:</font> 
<a name="line1615"/>  <font CLASS=comment>1615:</font> <font CLASS=preproc>#ifdef</font> ALGEBRA3IOSTREAMS 
<a name="line1616"/>  <font CLASS=comment>1616:</font> <font CLASS=keyword>inline</font> ostream&amp; <font CLASS=keyword>operator</font> &lt;&lt; (ostream&amp; s, <font CLASS=keyword>const</font> mat4&amp; m)
<a name="line1617"/>  <font CLASS=comment>1617:</font> {
<a name="line1618"/>  <font CLASS=comment>1618:</font> 	<font CLASS=keyword>return</font> s &lt;&lt; m.v[VX] &lt;&lt; <font CLASS=sinquot>'\n'</font> &lt;&lt; m.v[VY] &lt;&lt; <font CLASS=sinquot>'\n'</font> &lt;&lt; m.v[VZ] &lt;&lt; <font CLASS=sinquot>'\n'</font> &lt;&lt; m.v[VW]; 
<a name="line1619"/>  <font CLASS=comment>1619:</font> }
<a name="line1620"/>  <font CLASS=comment>1620:</font> 
<a name="line1621"/>  <font CLASS=comment>1621:</font> <font CLASS=keyword>inline</font> istream&amp; <font CLASS=keyword>operator</font> &gt;&gt; (istream&amp; s, mat4&amp; m)
<a name="line1622"/>  <font CLASS=comment>1622:</font> {
<a name="line1623"/>  <font CLASS=comment>1623:</font> 	mat4    m_tmp;
<a name="line1624"/>  <font CLASS=comment>1624:</font> 
<a name="line1625"/>  <font CLASS=comment>1625:</font> 	s &gt;&gt; m_tmp[VX] &gt;&gt; m_tmp[VY] &gt;&gt; m_tmp[VZ] &gt;&gt; m_tmp[VW];
<a name="line1626"/>  <font CLASS=comment>1626:</font> 	<font CLASS=keyword>if</font> (s)
<a name="line1627"/>  <font CLASS=comment>1627:</font> 		m <font CLASS=symbols>=</font> m_tmp;
<a name="line1628"/>  <font CLASS=comment>1628:</font> 	<font CLASS=keyword>return</font> s;
<a name="line1629"/>  <font CLASS=comment>1629:</font> }
<a name="line1630"/>  <font CLASS=comment>1630:</font> <font CLASS=preproc>#endif</font> <font CLASS=comment>// ALGEBRA3IOSTREAMS </font>
<a name="line1631"/>  <font CLASS=comment>1631:</font> 
<a name="line1632"/>  <font CLASS=comment>1632:</font> <font CLASS=keyword>inline</font> <font CLASS=keytype>void</font> swap(mat4&amp; a, mat4&amp; b)
<a name="line1633"/>  <font CLASS=comment>1633:</font> { 
<a name="line1634"/>  <font CLASS=comment>1634:</font> 	mat4 tmp(a); a <font CLASS=symbols>=</font> b; b <font CLASS=symbols>=</font> tmp;
<a name="line1635"/>  <font CLASS=comment>1635:</font> }
<a name="line1636"/>  <font CLASS=comment>1636:</font> 
<a name="line1637"/>  <font CLASS=comment>1637:</font> 
<a name="line1638"/>  <font CLASS=comment>1638:</font> <font CLASS=comment>/****************************************************************
<a name="line1639"/>  <font CLASS=comment>1639:</font> *																*
<a name="line1640"/>  <font CLASS=comment>1640:</font> *	       2D functions and 3D functions						*
<a name="line1641"/>  <font CLASS=comment>1641:</font> *																*
<a name="line1642"/>  <font CLASS=comment>1642:</font> ****************************************************************/</font>
<a name="line1643"/>  <font CLASS=comment>1643:</font> 
<a name="line1644"/>  <font CLASS=comment>1644:</font> <font CLASS=keyword>inline</font> mat3 identity2D()
<a name="line1645"/>  <font CLASS=comment>1645:</font> {  
<a name="line1646"/>  <font CLASS=comment>1646:</font> 	<font CLASS=keyword>return</font> mat3(vec3(<font CLASS=floatpt>1.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>),
<a name="line1647"/>  <font CLASS=comment>1647:</font> 				vec3(<font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>1.0</font>, <font CLASS=floatpt>0.0</font>),
<a name="line1648"/>  <font CLASS=comment>1648:</font> 				vec3(<font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>1.0</font>));
<a name="line1649"/>  <font CLASS=comment>1649:</font> }
<a name="line1650"/>  <font CLASS=comment>1650:</font> 
<a name="line1651"/>  <font CLASS=comment>1651:</font> <font CLASS=keyword>inline</font> mat3 translation2D(<font CLASS=keyword>const</font> vec2&amp; v)
<a name="line1652"/>  <font CLASS=comment>1652:</font> {  
<a name="line1653"/>  <font CLASS=comment>1653:</font> 	<font CLASS=keyword>return</font> mat3(vec3(<font CLASS=floatpt>1.0</font>, <font CLASS=floatpt>0.0</font>, v[VX]),
<a name="line1654"/>  <font CLASS=comment>1654:</font> 				vec3(<font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>1.0</font>, v[VY]),
<a name="line1655"/>  <font CLASS=comment>1655:</font> 				vec3(<font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>1.0</font>));
<a name="line1656"/>  <font CLASS=comment>1656:</font> }
<a name="line1657"/>  <font CLASS=comment>1657:</font> 
<a name="line1658"/>  <font CLASS=comment>1658:</font> <font CLASS=keyword>inline</font> mat3 rotation2Ddeg(<font CLASS=keyword>const</font> vec2&amp; Center, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> angleDeg)
<a name="line1659"/>  <font CLASS=comment>1659:</font> {
<a name="line1660"/>  <font CLASS=comment>1660:</font> 	<font CLASS=keytype>double</font>  angleRad <font CLASS=symbols>=</font> angleDeg * M_PI / <font CLASS=floatpt>180.0</font>,
<a name="line1661"/>  <font CLASS=comment>1661:</font> 			c <font CLASS=symbols>=</font> cos(angleRad),
<a name="line1662"/>  <font CLASS=comment>1662:</font> 			s <font CLASS=symbols>=</font> sin(angleRad);
<a name="line1663"/>  <font CLASS=comment>1663:</font> 
<a name="line1664"/>  <font CLASS=comment>1664:</font> 	<font CLASS=keyword>return</font> mat3(vec3(c, -s, Center[VX] * (<font CLASS=floatpt>1.0</font>-c) <font CLASS=symbols>+</font> Center[VY] * s),
<a name="line1665"/>  <font CLASS=comment>1665:</font> 				vec3(s, c, Center[VY] * (<font CLASS=floatpt>1.0</font>-c) <font CLASS=symbols>-</font> Center[VX] * s),
<a name="line1666"/>  <font CLASS=comment>1666:</font> 				vec3(<font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>1.0</font>));
<a name="line1667"/>  <font CLASS=comment>1667:</font> }
<a name="line1668"/>  <font CLASS=comment>1668:</font> 
<a name="line1669"/>  <font CLASS=comment>1669:</font> <font CLASS=keyword>inline</font> mat3 rotation3Drad(<font CLASS=keyword>const</font> vec3&amp; axis, <font CLASS=keyword>const</font> <font CLASS=keytype>float</font> angleRad)
<a name="line1670"/>  <font CLASS=comment>1670:</font> {
<a name="line1671"/>  <font CLASS=comment>1671:</font> 	<font CLASS=keytype>float</font> c <font CLASS=symbols>=</font> cos(angleRad), s <font CLASS=symbols>=</font> sin(angleRad), t = <font CLASS=floatpt>1.0</font>f - c;
<a name="line1672"/>  <font CLASS=comment>1672:</font> 	vec3 Axis <font CLASS=symbols>=</font> axis;
<a name="line1673"/>  <font CLASS=comment>1673:</font> 	Axis.normalize();
<a name="line1674"/>  <font CLASS=comment>1674:</font> 	<font CLASS=keyword>return</font> mat3(vec3(t * Axis[VX] * Axis[VX] <font CLASS=symbols>+</font> c,
<a name="line1675"/>  <font CLASS=comment>1675:</font> 					 t * Axis[VX] * Axis[VY] <font CLASS=symbols>-</font> s * Axis[VZ],
<a name="line1676"/>  <font CLASS=comment>1676:</font> 					 t * Axis[VX] * Axis[VZ] <font CLASS=symbols>+</font> s * Axis[VY]),
<a name="line1677"/>  <font CLASS=comment>1677:</font> 					 vec3(t * Axis[VX] * Axis[VY] <font CLASS=symbols>+</font> s * Axis[VZ],
<a name="line1678"/>  <font CLASS=comment>1678:</font> 					 t * Axis[VY] * Axis[VY] <font CLASS=symbols>+</font> c,
<a name="line1679"/>  <font CLASS=comment>1679:</font> 					 t * Axis[VY] * Axis[VZ] <font CLASS=symbols>-</font> s * Axis[VX]),
<a name="line1680"/>  <font CLASS=comment>1680:</font> 					 vec3(t * Axis[VX] * Axis[VZ] <font CLASS=symbols>-</font> s * Axis[VY],
<a name="line1681"/>  <font CLASS=comment>1681:</font> 					 t * Axis[VY] * Axis[VZ] <font CLASS=symbols>+</font> s * Axis[VX],
<a name="line1682"/>  <font CLASS=comment>1682:</font> 					 t * Axis[VZ] * Axis[VZ] <font CLASS=symbols>+</font> c)
<a name="line1683"/>  <font CLASS=comment>1683:</font> 					 );
<a name="line1684"/>  <font CLASS=comment>1684:</font> }
<a name="line1685"/>  <font CLASS=comment>1685:</font> 
<a name="line1686"/>  <font CLASS=comment>1686:</font> <font CLASS=keyword>inline</font> mat3 scaling2D(<font CLASS=keyword>const</font> vec2&amp; scaleVector)
<a name="line1687"/>  <font CLASS=comment>1687:</font> {   
<a name="line1688"/>  <font CLASS=comment>1688:</font> 	<font CLASS=keyword>return</font> mat3(vec3(scaleVector[VX], <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>),
<a name="line1689"/>  <font CLASS=comment>1689:</font> 				vec3(<font CLASS=floatpt>0.0</font>, scaleVector[VY], <font CLASS=floatpt>0.0</font>),
<a name="line1690"/>  <font CLASS=comment>1690:</font> 				vec3(<font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>1.0</font>));
<a name="line1691"/>  <font CLASS=comment>1691:</font> }
<a name="line1692"/>  <font CLASS=comment>1692:</font> 
<a name="line1693"/>  <font CLASS=comment>1693:</font> <font CLASS=keyword>inline</font> mat4 identity3D()
<a name="line1694"/>  <font CLASS=comment>1694:</font> {  
<a name="line1695"/>  <font CLASS=comment>1695:</font> 	<font CLASS=keyword>return</font> mat4(vec4(<font CLASS=floatpt>1.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>),
<a name="line1696"/>  <font CLASS=comment>1696:</font> 				vec4(<font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>1.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>),
<a name="line1697"/>  <font CLASS=comment>1697:</font> 				vec4(<font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>1.0</font>, <font CLASS=floatpt>0.0</font>),
<a name="line1698"/>  <font CLASS=comment>1698:</font> 				vec4(<font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>1.0</font>)); 
<a name="line1699"/>  <font CLASS=comment>1699:</font> }
<a name="line1700"/>  <font CLASS=comment>1700:</font> 
<a name="line1701"/>  <font CLASS=comment>1701:</font> <font CLASS=keyword>inline</font> mat4 translation3D(<font CLASS=keyword>const</font> vec3&amp; v)
<a name="line1702"/>  <font CLASS=comment>1702:</font> {  
<a name="line1703"/>  <font CLASS=comment>1703:</font> 	<font CLASS=keyword>return</font> mat4(vec4(<font CLASS=floatpt>1.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, v[VX]),
<a name="line1704"/>  <font CLASS=comment>1704:</font> 				vec4(<font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>1.0</font>, <font CLASS=floatpt>0.0</font>, v[VY]),
<a name="line1705"/>  <font CLASS=comment>1705:</font> 				vec4(<font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>1.0</font>, v[VZ]),
<a name="line1706"/>  <font CLASS=comment>1706:</font> 				vec4(<font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>1.0</font>));
<a name="line1707"/>  <font CLASS=comment>1707:</font> }
<a name="line1708"/>  <font CLASS=comment>1708:</font> 
<a name="line1709"/>  <font CLASS=comment>1709:</font> <font CLASS=keyword>inline</font> mat4 rotation3Ddeg(vec3 Axis, <font CLASS=keyword>const</font> <font CLASS=keytype>double</font> angleDeg) 
<a name="line1710"/>  <font CLASS=comment>1710:</font> {
<a name="line1711"/>  <font CLASS=comment>1711:</font> 	<font CLASS=keytype>double</font>  angleRad <font CLASS=symbols>=</font> angleDeg * M_PI / <font CLASS=floatpt>180.0</font>,
<a name="line1712"/>  <font CLASS=comment>1712:</font> 			c <font CLASS=symbols>=</font> cos(angleRad),
<a name="line1713"/>  <font CLASS=comment>1713:</font> 			s <font CLASS=symbols>=</font> sin(angleRad),
<a name="line1714"/>  <font CLASS=comment>1714:</font> 			t <font CLASS=symbols>=</font> <font CLASS=floatpt>1.0</font> <font CLASS=symbols>-</font> c;
<a name="line1715"/>  <font CLASS=comment>1715:</font> 
<a name="line1716"/>  <font CLASS=comment>1716:</font> 	Axis.normalize();
<a name="line1717"/>  <font CLASS=comment>1717:</font> 	<font CLASS=keyword>return</font> mat4(vec4(t * Axis[VX] * Axis[VX] <font CLASS=symbols>+</font> c,
<a name="line1718"/>  <font CLASS=comment>1718:</font> 					 t * Axis[VX] * Axis[VY] <font CLASS=symbols>-</font> s * Axis[VZ],
<a name="line1719"/>  <font CLASS=comment>1719:</font> 					 t * Axis[VX] * Axis[VZ] <font CLASS=symbols>+</font> s * Axis[VY],
<a name="line1720"/>  <font CLASS=comment>1720:</font> 					 <font CLASS=floatpt>0.0</font>),
<a name="line1721"/>  <font CLASS=comment>1721:</font> 				vec4(t * Axis[VX] * Axis[VY] <font CLASS=symbols>+</font> s * Axis[VZ],
<a name="line1722"/>  <font CLASS=comment>1722:</font> 					 t * Axis[VY] * Axis[VY] <font CLASS=symbols>+</font> c,
<a name="line1723"/>  <font CLASS=comment>1723:</font> 					 t * Axis[VY] * Axis[VZ] <font CLASS=symbols>-</font> s * Axis[VX],
<a name="line1724"/>  <font CLASS=comment>1724:</font> 					 <font CLASS=floatpt>0.0</font>),
<a name="line1725"/>  <font CLASS=comment>1725:</font> 				vec4(t * Axis[VX] * Axis[VZ] <font CLASS=symbols>-</font> s * Axis[VY],
<a name="line1726"/>  <font CLASS=comment>1726:</font> 					 t * Axis[VY] * Axis[VZ] <font CLASS=symbols>+</font> s * Axis[VX],
<a name="line1727"/>  <font CLASS=comment>1727:</font> 					 t * Axis[VZ] * Axis[VZ] <font CLASS=symbols>+</font> c,
<a name="line1728"/>  <font CLASS=comment>1728:</font> 					 <font CLASS=floatpt>0.0</font>),
<a name="line1729"/>  <font CLASS=comment>1729:</font> 				vec4(<font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>1.0</font>));
<a name="line1730"/>  <font CLASS=comment>1730:</font> }
<a name="line1731"/>  <font CLASS=comment>1731:</font> 
<a name="line1732"/>  <font CLASS=comment>1732:</font> <font CLASS=keyword>inline</font> mat4 scaling3D(<font CLASS=keyword>const</font> vec3&amp; scaleVector)
<a name="line1733"/>  <font CLASS=comment>1733:</font> {  
<a name="line1734"/>  <font CLASS=comment>1734:</font> 	<font CLASS=keyword>return</font> mat4(vec4(scaleVector[VX], <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>),
<a name="line1735"/>  <font CLASS=comment>1735:</font> 				vec4(<font CLASS=floatpt>0.0</font>, scaleVector[VY], <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>),
<a name="line1736"/>  <font CLASS=comment>1736:</font> 				vec4(<font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, scaleVector[VZ], <font CLASS=floatpt>0.0</font>),
<a name="line1737"/>  <font CLASS=comment>1737:</font> 				vec4(<font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>1.0</font>));
<a name="line1738"/>  <font CLASS=comment>1738:</font> }
<a name="line1739"/>  <font CLASS=comment>1739:</font> 
<a name="line1740"/>  <font CLASS=comment>1740:</font> <font CLASS=keyword>inline</font> mat4 perspective3D(<font CLASS=keyword>const</font> <font CLASS=keytype>double</font> d)
<a name="line1741"/>  <font CLASS=comment>1741:</font> {
<a name="line1742"/>  <font CLASS=comment>1742:</font> 	<font CLASS=keyword>return</font> mat4(vec4(<font CLASS=floatpt>1.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>),
<a name="line1743"/>  <font CLASS=comment>1743:</font> 				vec4(<font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>1.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>),
<a name="line1744"/>  <font CLASS=comment>1744:</font> 				vec4(<font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>1.0</font>, <font CLASS=floatpt>0.0</font>),
<a name="line1745"/>  <font CLASS=comment>1745:</font> 				vec4(<font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>0.0</font>, <font CLASS=floatpt>1.0</font>/d, <font CLASS=floatpt>0.0</font>));
<a name="line1746"/>  <font CLASS=comment>1746:</font> }
<a name="line1747"/>  <font CLASS=comment>1747:</font> 
<a name="line1748"/>  <font CLASS=comment>1748:</font> 
<a name="line1749"/>  <font CLASS=comment>1749:</font> <font CLASS=preproc>#endif</font> <font CLASS=comment>// ALGEBRA3H </font>
<a name="line1750"/>  <font CLASS=comment>1750:</font> 


</pre>

</div>
